(globalThis.TURBOPACK=globalThis.TURBOPACK||[]).push(["object"==typeof document?document.currentScript:void 0,{875358:e=>{"use strict";var{g:t,__dirname:r}=e;{e.s({stripeClient:()=>t});let t=e=>({id:"stripe-client",$InferServerPlugin:{},pathMethods:{"/subscription/restore":"POST"}})}},88267:e=>{"use strict";var{g:t,__dirname:r}=e;e.s({BetterFetchError:()=>p,ValidationError:()=>$,applySchemaPlugin:()=>W,betterFetch:()=>B,bodyParser:()=>N,createFetch:()=>j,createRetryStrategy:()=>m,createSchema:()=>x,detectContentType:()=>U,detectResponseType:()=>v,getBody:()=>_,getFetch:()=>T,getHeaders:()=>P,getMethod:()=>C,getTimeout:()=>L,getURL:()=>I,initializePlugins:()=>f,isFunction:()=>E,isJSONParsable:()=>w,isJSONSerializable:()=>R,isPayloadMethod:()=>S,isRouteMethod:()=>O,jsonParse:()=>A,methods:()=>D,parseStandardSchema:()=>k});var i=Object.defineProperty,n=Object.defineProperties,o=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,u=(e,t,r)=>t in e?i(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,c=(e,t)=>{for(var r in t||(t={}))a.call(t,r)&&u(e,r,t[r]);if(s)for(var r of s(t))l.call(t,r)&&u(e,r,t[r]);return e},d=(e,t)=>n(e,o(t)),p=class extends Error{constructor(e,t,r){super(t||e.toString(),{cause:r}),this.status=e,this.statusText=t,this.error=r}},f=async(e,t)=>{var r,i,n,o,s,a;let l=t||{},u={onRequest:[null==t?void 0:t.onRequest],onResponse:[null==t?void 0:t.onResponse],onSuccess:[null==t?void 0:t.onSuccess],onError:[null==t?void 0:t.onError],onRetry:[null==t?void 0:t.onRetry]};if(!t||!(null==t?void 0:t.plugins))return{url:e,options:l,hooks:u};for(let c of(null==t?void 0:t.plugins)||[]){if(c.init){let i=await (null==(r=c.init)?void 0:r.call(c,e.toString(),t));l=i.options||l,e=i.url}u.onRequest.push(null==(i=c.hooks)?void 0:i.onRequest),u.onResponse.push(null==(n=c.hooks)?void 0:n.onResponse),u.onSuccess.push(null==(o=c.hooks)?void 0:o.onSuccess),u.onError.push(null==(s=c.hooks)?void 0:s.onError),u.onRetry.push(null==(a=c.hooks)?void 0:a.onRetry)}return{url:e,options:l,hooks:u}},h=class{constructor(e){this.options=e}shouldAttemptRetry(e,t){return this.options.shouldRetry?Promise.resolve(e<this.options.attempts&&this.options.shouldRetry(t)):Promise.resolve(e<this.options.attempts)}getDelay(){return this.options.delay}},g=class{constructor(e){this.options=e}shouldAttemptRetry(e,t){return this.options.shouldRetry?Promise.resolve(e<this.options.attempts&&this.options.shouldRetry(t)):Promise.resolve(e<this.options.attempts)}getDelay(e){return Math.min(this.options.maxDelay,this.options.baseDelay*2**e)}};function m(e){if("number"==typeof e)return new h({type:"linear",attempts:e,delay:1e3});switch(e.type){case"linear":return new h(e);case"exponential":return new g(e);default:throw Error("Invalid retry strategy")}}var b=async e=>{let t={},r=async e=>"function"==typeof e?await e():e;if(null==e?void 0:e.auth){if("Bearer"===e.auth.type){let i=await r(e.auth.token);if(!i)return t;t.authorization=`Bearer ${i}`}else if("Basic"===e.auth.type){let i=r(e.auth.username),n=r(e.auth.password);if(!i||!n)return t;t.authorization=`Basic ${btoa(`${i}:${n}`)}`}else if("Custom"===e.auth.type){let i=r(e.auth.value);if(!i)return t;t.authorization=`${r(e.auth.prefix)} ${i}`}}return t},y=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function v(e){let t=e.headers.get("content-type"),r=new Set(["image/svg","application/xml","application/xhtml","application/html"]);if(!t)return"json";let i=t.split(";").shift()||"";return y.test(i)?"json":r.has(i)||i.startsWith("text/")?"text":"blob"}function w(e){try{return JSON.parse(e),!0}catch(e){return!1}}function R(e){if(void 0===e)return!1;let t=typeof e;return"string"===t||"number"===t||"boolean"===t||null===t||"object"===t&&(!!Array.isArray(e)||!e.buffer&&(e.constructor&&"Object"===e.constructor.name||"function"==typeof e.toJSON))}function A(e){try{return JSON.parse(e)}catch(t){return e}}function E(e){return"function"==typeof e}function T(e){if(null==e?void 0:e.customFetchImpl)return e.customFetchImpl;if("undefined"!=typeof globalThis&&E(globalThis.fetch))return globalThis.fetch;if("undefined"!=typeof window&&E(window.fetch))return window.fetch;throw Error("No fetch implementation found")}function S(e){return!!e&&["POST","PUT","PATCH","DELETE"].includes(e.toUpperCase())}function O(e){return!!e&&["GET","POST","PUT","PATCH","DELETE"].includes(e.toUpperCase())}async function P(e){let t=new Headers(null==e?void 0:e.headers);for(let[r,i]of Object.entries(await b(e)||{}))t.set(r,i);if(!t.has("content-type")){let r=U(null==e?void 0:e.body);r&&t.set("content-type",r)}return t}function I(e,t){let r;if(e.startsWith("@")){let t=e.toString().split("@")[1].split("/")[0];D.includes(t)&&(e=e.replace(`@${t}/`,"/"))}try{if(e.startsWith("http"))r=e;else{let i=null==t?void 0:t.baseURL;!i||(null==i?void 0:i.endsWith("/"))||(i+="/"),r=e.startsWith("/")?new URL(e.substring(1),i):new URL(e,null==t?void 0:t.baseURL)}}catch(r){if(r instanceof TypeError){if(!(null==t?void 0:t.baseURL))throw TypeError(`Invalid URL ${e}. Are you passing in a relative url but not setting the baseURL?`);throw TypeError(`Invalid URL ${e}. Please validate that you are passing the correct input.`)}throw r}if(null==t?void 0:t.params)if(Array.isArray(null==t?void 0:t.params)){let e=(null==t?void 0:t.params)?Array.isArray(t.params)?`/${t.params.join("/")}`:`/${Object.values(t.params).join("/")}`:"";r=r.toString().split("/:")[0],r=`${r.toString()}${e}`}else for(let[e,i]of Object.entries(null==t?void 0:t.params))r=r.toString().replace(`:${e}`,String(i));let i=new URL(r),n=null==t?void 0:t.query;if(n)for(let[e,t]of Object.entries(n))i.searchParams.append(e,String(t));return i}function U(e){return R(e)?"application/json":null}function _(e){if(!(null==e?void 0:e.body))return null;let t=new Headers(null==e?void 0:e.headers);if(R(e.body)&&!t.has("content-type")){for(let[t,r]of Object.entries(null==e?void 0:e.body))r instanceof Date&&(e.body[t]=r.toISOString());return JSON.stringify(e.body)}return e.body}function C(e,t){var r;if(null==t?void 0:t.method)return t.method.toUpperCase();if(e.startsWith("@")){let i=null==(r=e.split("@")[1])?void 0:r.split("/")[0];return D.includes(i)?i.toUpperCase():(null==t?void 0:t.body)?"POST":"GET"}return(null==t?void 0:t.body)?"POST":"GET"}function L(e,t){let r;return!(null==e?void 0:e.signal)&&(null==e?void 0:e.timeout)&&(r=setTimeout(()=>null==t?void 0:t.abort(),null==e?void 0:e.timeout)),{abortTimeout:r,clearTimeout:()=>{r&&clearTimeout(r)}}}function N(e,t){return"json"===t?JSON.parse(e):e}var $=class e extends Error{constructor(t,r){super(r||JSON.stringify(t,null,2)),this.issues=t,Object.setPrototypeOf(this,e.prototype)}};async function k(e,t){let r=await e["~standard"].validate(t);if(r.issues)throw new $(r.issues);return r.value}var D=["get","post","put","patch","delete"],x=(e,t)=>({schema:e,config:t}),W=e=>({id:"apply-schema",name:"Apply Schema",version:"1.0.0",async init(t,r){var i,n,o,s;let a=(null==(n=null==(i=e.plugins)?void 0:i.find(e=>{var r;return null!=(r=e.schema)&&!!r.config&&(t.startsWith(e.schema.config.baseURL||"")||t.startsWith(e.schema.config.prefix||""))}))?void 0:n.schema)||e.schema;if(a){let e=t;(null==(o=a.config)?void 0:o.prefix)&&e.startsWith(a.config.prefix)&&(e=e.replace(a.config.prefix,""),a.config.baseURL&&(t=t.replace(a.config.prefix,a.config.baseURL))),(null==(s=a.config)?void 0:s.baseURL)&&e.startsWith(a.config.baseURL)&&(e=e.replace(a.config.baseURL,""));let i=a.schema[e];if(i){let e=d(c({},r),{method:i.method,output:i.output});return(null==r?void 0:r.disableValidation)||(e=d(c({},e),{body:i.input?await k(i.input,null==r?void 0:r.body):null==r?void 0:r.body,params:i.params?await k(i.params,null==r?void 0:r.params):null==r?void 0:r.params,query:i.query?await k(i.query,null==r?void 0:r.query):null==r?void 0:r.query})),{url:t,options:e}}}return{url:t,options:r}}}),j=e=>async function(t,r){let i=d(c(c({},e),r),{plugins:[...(null==e?void 0:e.plugins)||[],W(e||{})]});if(null==e?void 0:e.catchAllError)try{return await B(t,i)}catch(e){return{data:null,error:{status:500,statusText:"Fetch Error",message:"Fetch related error. Captured by catchAllError option. See error property for more details.",error:e}}}return await B(t,i)},B=async(e,t)=>{var r,i,n,o,s,a,l,u;let{hooks:h,url:g,options:b}=await f(e,t),y=T(b),R=new AbortController,E=null!=(r=b.signal)?r:R.signal,S=function(e,t){let{baseURL:r,params:i,query:n}=t||{query:{},params:{},baseURL:""},o=e.startsWith("http")?e.split("/").slice(0,3).join("/"):r||"";if(e.startsWith("@")){let t=e.toString().split("@")[1].split("/")[0];D.includes(t)&&(e=e.replace(`@${t}/`,"/"))}o.endsWith("/")||(o+="/");let[s,a]=e.replace(o,"").split("?"),l=new URLSearchParams(a);for(let[e,t]of Object.entries(n||{}))null!=t&&l.set(e,String(t));if(i)if(Array.isArray(i))for(let[e,t]of s.split("/").filter(e=>e.startsWith(":")).entries()){let r=i[e];s=s.replace(t,r)}else for(let[e,t]of Object.entries(i))s=s.replace(`:${e}`,String(t));(s=s.split("/").map(encodeURIComponent).join("/")).startsWith("/")&&(s=s.slice(1));let u=l.toString();return(u=u.length>0?`?${u}`.replace(/\+/g,"%20"):"",o.startsWith("http"))?new URL(`${s}${u}`,o):`${o}${s}${u}`}(g,b),O=_(b),I=await P(b),U=C(g,b),N=d(c({},b),{url:S,headers:I,body:O,method:U,signal:E});for(let e of h.onRequest)if(e){let t=await e(N);t instanceof Object&&(N=t)}("pipeTo"in N&&"function"==typeof N.pipeTo||"function"==typeof(null==(i=null==t?void 0:t.body)?void 0:i.pipe))&&!("duplex"in N)&&(N.duplex="half");let{clearTimeout:$}=L(b,R),x=await y(N.url,N);$();let W={response:x,request:N};for(let e of h.onResponse)if(e){let r=await e(d(c({},W),{response:(null==(n=null==t?void 0:t.hookOptions)?void 0:n.cloneResponse)?x.clone():x}));r instanceof Response?x=r:r instanceof Object&&(x=r.response)}if(x.ok){if("HEAD"===N.method)return{data:"",error:null};let e=v(x),r={data:"",response:x,request:N};if("json"===e||"text"===e){let e=await x.text(),t=null!=(o=N.jsonParser)?o:A;r.data=await t(e)}else r.data=await x[e]();for(let e of((null==N?void 0:N.output)&&N.output&&!N.disableValidation&&(r.data=await k(N.output,r.data)),h.onSuccess))e&&await e(d(c({},r),{response:(null==(s=null==t?void 0:t.hookOptions)?void 0:s.cloneResponse)?x.clone():x}));return(null==t?void 0:t.throw)?r.data:{data:r.data,error:null}}let j=null!=(a=null==t?void 0:t.jsonParser)?a:A,M=await x.text(),z=w(M),K=z?await j(M):null,q={response:x,responseText:M,request:N,error:d(c({},K),{status:x.status,statusText:x.statusText})};for(let e of h.onError)e&&await e(d(c({},q),{response:(null==(l=null==t?void 0:t.hookOptions)?void 0:l.cloneResponse)?x.clone():x}));if(null==t?void 0:t.retry){let r=m(t.retry),i=null!=(u=t.retryAttempt)?u:0;if(await r.shouldAttemptRetry(i,x)){for(let e of h.onRetry)e&&await e(W);let n=r.getDelay(i);return await new Promise(e=>setTimeout(e,n)),await B(e,d(c({},t),{retryAttempt:i+1}))}}if(null==t?void 0:t.throw)throw new p(x.status,x.statusText,z?K:M);return{data:null,error:d(c({},K),{status:x.status,statusText:x.statusText})}}},482786:e=>{"use strict";var{g:t,__dirname:r}=e;{e.s({a:()=>s,b:()=>a,e:()=>n,i:()=>l});var i=e.i(922271);let t=Object.create(null),r=e=>globalThis.process?.env||globalThis.Deno?.env.toObject()||globalThis.__env__||(e?t:globalThis),n=new Proxy(t,{get:(e,i)=>r()[i]??t[i],has:(e,i)=>i in r()||i in t,set:(e,t,i)=>(r(!0)[t]=i,!0),deleteProperty(e,t){if(!t)return!1;let i=r(!0);return delete i[t],!0},ownKeys:()=>Object.keys(r(!0))}),o=void 0!==i.default&&i.default.env&&"production"||"",s="production"===o,a="dev"===o||"development"===o,l="test"===o||function(e){return!!e&&"false"!==e}(n.TEST)}},925892:e=>{"use strict";var{g:t,__dirname:r}=e;{e.s({B:()=>t,M:()=>r});class t extends Error{constructor(e,t){super(e),this.name="BetterAuthError",this.message=e,this.cause=t,this.stack=""}}class r extends t{constructor(e){super(`The package "${e}" is required. Make sure it is installed.`,e)}}}},996176:e=>{"use strict";var{g:t,__dirname:r}=e;e.s({a:()=>s,b:()=>u,c:()=>l,g:()=>a});var i=e.i(482786),n=e.i(925892);function o(e,t="/api/auth"){return!function(e){try{let t=new URL(e);return"/"!==t.pathname}catch(t){throw new n.B(`Invalid base URL: ${e}. Please provide a valid base URL.`)}}(e)?(t=t.startsWith("/")?t:`/${t}`,`${e.replace(/\/+$/,"")}${t}`):e}function s(e,t,r){if(e)return o(e,t);let s=i.e.BETTER_AUTH_URL||i.e.NEXT_PUBLIC_BETTER_AUTH_URL||i.e.PUBLIC_BETTER_AUTH_URL||i.e.NUXT_PUBLIC_BETTER_AUTH_URL||i.e.NUXT_PUBLIC_AUTH_URL||("/"!==i.e.BASE_URL?i.e.BASE_URL:void 0);if(s)return o(s,t);let l=r?.headers.get("x-forwarded-host"),u=r?.headers.get("x-forwarded-proto");if(l&&u)return o(`${u}://${l}`,t);if(r){let e=a(r.url);if(!e)throw new n.B("Could not get origin from request. Please provide a valid base URL.");return o(e,t)}if("undefined"!=typeof window&&window.location)return o(window.location.origin,t)}function a(e){try{return new URL(e).origin}catch(e){return null}}function l(e){try{return new URL(e).protocol}catch(e){return null}}function u(e){try{return new URL(e).host}catch(t){return e}}},303200:e=>{"use strict";var{g:t,__dirname:r}=e;{e.s({atom:()=>n,epoch:()=>i}),e.i(922271);let t=[],r=0,i=0,n=e=>{let n=[],o={get:()=>(o.lc||o.listen(()=>{})(),o.value),lc:0,listen:e=>(o.lc=n.push(e),()=>{for(let i=r+4;i<t.length;)t[i]===e?t.splice(i,4):i+=4;let i=n.indexOf(e);~i&&(n.splice(i,1),--o.lc||o.off())}),notify(e,s){i++;let a=!t.length;for(let r of n)t.push(r,o.value,e,s);if(a){for(r=0;r<t.length;r+=4)t[r](t[r+1],t[r+2],t[r+3]);t.length=0}},off(){},set(e){let t=o.value;t!==e&&(o.value=e,o.notify(t))},subscribe(e){let t=o.listen(e);return e(o.value),t},value:e};return o}}},418827:e=>{"use strict";var{g:t,__dirname:r}=e;{e.s({STORE_UNMOUNT_DELAY:()=>s,on:()=>t,onMount:()=>a,onNotify:()=>o,onSet:()=>n,onStart:()=>r,onStop:()=>i}),e.i(922271);let t=(e,t,r,i)=>(e.events=e.events||{},e.events[r+10]||(e.events[r+10]=i(t=>{e.events[r].reduceRight((e,t)=>(t(e),e),{shared:{},...t})})),e.events[r]=e.events[r]||[],e.events[r].push(t),()=>{let i=e.events[r],n=i.indexOf(t);i.splice(n,1),i.length||(delete e.events[r],e.events[r+10](),delete e.events[r+10])}),r=(e,r)=>t(e,r,0,t=>{let r=e.listen;return e.listen=i=>(e.lc||e.starting||(e.starting=!0,t(),delete e.starting),r(i)),()=>{e.listen=r}}),i=(e,r)=>t(e,r,1,t=>{let r=e.off;return e.off=()=>{t(),r()},()=>{e.off=r}}),n=(e,r)=>t(e,r,2,t=>{let r=e.set,i=e.setKey;return e.setKey&&(e.setKey=(r,n)=>{let o;if(t({abort:()=>{o=!0},changed:r,newValue:{...e.value,[r]:n}}),!o)return i(r,n)}),e.set=e=>{let i;if(t({abort:()=>{i=!0},newValue:e}),!i)return r(e)},()=>{e.set=r,e.setKey=i}}),o=(e,r)=>t(e,r,3,t=>{let r=e.notify;return e.notify=(e,i)=>{let n;if(t({abort:()=>{n=!0},changed:i,oldValue:e}),!n)return r(e,i)},()=>{e.notify=r}}),s=1e3,a=(e,r)=>t(e,t=>{let i=r(t);i&&e.events[6].push(i)},5,t=>{let r=e.listen;e.listen=(...i)=>(e.lc||e.active||(e.active=!0,t()),r(...i));let i=e.off;return e.events[6]=[],e.off=()=>{i(),setTimeout(()=>{if(e.active&&!e.lc){for(let t of(e.active=!1,e.events[6]))t();e.events[6]=[]}},s)},()=>{e.listen=r,e.off=i}})}},515347:e=>{"use strict";var{g:t,__dirname:r}=e;{e.s({u:()=>t});var i=e.i(303200),n=e.i(418827);let t=(e,t,r,o)=>{let s=(0,i.atom)({data:null,error:null,isPending:!0,isRefetching:!1,refetch:()=>a()}),a=()=>{let e="function"==typeof o?o({data:s.get().data,error:s.get().error,isPending:s.get().isPending}):o;return r(t,{...e,async onSuccess(t){"undefined"!=typeof window&&s.set({data:t.data,error:null,isPending:!1,isRefetching:!1,refetch:s.value.refetch}),await e?.onSuccess?.(t)},async onError(t){let{request:r}=t,i="number"==typeof r.retry?r.retry:r.retry?.attempts,n=r.retryAttempt||0;i&&n<i||(s.set({error:t.error,data:null,isPending:!1,isRefetching:!1,refetch:s.value.refetch}),await e?.onError?.(t))},async onRequest(t){let r=s.get();s.set({isPending:null===r.data,data:r.data,error:null,isRefetching:!0,refetch:s.value.refetch}),await e?.onRequest?.(t)}})};e=Array.isArray(e)?e:[e];let l=!1;for(let t of e)t.subscribe(()=>{l?a():(0,n.onMount)(s,()=>(a(),l=!0,()=>{s.off(),t.off()}))});return s}}},483159:e=>{"use strict";var{g:t,__dirname:r}=e;{e.s({p:()=>i});let t={proto:/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,constructor:/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,protoShort:/"__proto__"\s*:/,constructorShort:/"constructor"\s*:/},r=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/,n={true:!0,false:!1,null:null,undefined:void 0,nan:Number.NaN,infinity:Number.POSITIVE_INFINITY,"-infinity":Number.NEGATIVE_INFINITY},o=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:\.(\d{1,7}))?(?:Z|([+-])(\d{2}):(\d{2}))$/;function i(e,s={strict:!0}){return function(e,i={}){let{strict:s=!1,warnings:a=!1,reviver:l,parseDates:u=!0}=i;if("string"!=typeof e)return e;let c=e.trim();if('"'===c[0]&&c.endsWith('"')&&!c.slice(1,-1).includes('"'))return c.slice(1,-1);let d=c.toLowerCase();if(d.length<=9&&d in n)return n[d];if(!r.test(c)){if(s)throw SyntaxError("[better-json] Invalid JSON");return e}if(Object.entries(t).some(([e,t])=>{let r=t.test(c);return r&&a&&console.warn(`[better-json] Detected potential prototype pollution attempt using ${e} pattern`),r})&&s)throw Error("[better-json] Potential prototype pollution attempt detected");try{return JSON.parse(c,(e,t)=>{if("__proto__"===e||"constructor"===e&&t&&"object"==typeof t&&"prototype"in t){a&&console.warn(`[better-json] Dropping "${e}" key to prevent prototype pollution`);return}if(u&&"string"==typeof t){let e=function(e){let t=o.exec(e);if(!t)return null;let[,r,i,n,s,a,l,u,c,d,p]=t,f=new Date(Date.UTC(parseInt(r,10),parseInt(i,10)-1,parseInt(n,10),parseInt(s,10),parseInt(a,10),parseInt(l,10),u?parseInt(u.padEnd(3,"0"),10):0));if(c){let e=(60*parseInt(d,10)+parseInt(p,10))*("+"===c?-1:1);f.setUTCMinutes(f.getUTCMinutes()+e)}return f instanceof Date&&!isNaN(f.getTime())?f:null}(t);if(e)return e}return l?l(e,t):t})}catch(t){if(s)throw t;return e}}(e,s)}}},917198:e=>{"use strict";var{g:t,__dirname:r}=e;{e.s({c:()=>l,g:()=>r});var i=e.i(88267),n=e.i(996176),o=e.i(303200),s=e.i(515347),a=e.i(483159);let t={id:"redirect",name:"Redirect",hooks:{onSuccess(e){if(e.data?.url&&e.data?.redirect&&"undefined"!=typeof window&&window.location&&window.location)try{window.location.href=e.data.url}catch{}}}},r=e=>{let r="credentials"in Request.prototype,l=(0,n.a)(e?.baseURL,e?.basePath),u=e?.plugins?.flatMap(e=>e.fetchPlugins).filter(e=>void 0!==e)||[],c=(0,i.createFetch)({baseURL:l,...r?{credentials:"include"}:{},method:"GET",jsonParser:e=>e?(0,a.p)(e,{strict:!1}):null,customFetchImpl:async(e,t)=>{try{return await fetch(e,t)}catch(e){return Response.error()}},...e?.fetchOptions,plugins:e?.disableDefaultFetchPlugins?[...e?.fetchOptions?.plugins||[],...u]:[t,...e?.fetchOptions?.plugins||[],...u]}),{$sessionSignal:d,session:p}=function(e){let t=(0,o.atom)(!1);return{session:(0,s.u)(t,"/get-session",e,{method:"GET"}),$sessionSignal:t}}(c),f=e?.plugins||[],h={},g={$sessionSignal:d,session:p},m={"/sign-out":"POST","/revoke-sessions":"POST","/revoke-other-sessions":"POST","/delete-user":"POST"},b=[{signal:"$sessionSignal",matcher:e=>"/sign-out"===e||"/update-user"===e||e.startsWith("/sign-in")||e.startsWith("/sign-up")||"/delete-user"===e||"/verify-email"===e}];for(let e of f)e.getAtoms&&Object.assign(g,e.getAtoms?.(c)),e.pathMethods&&Object.assign(m,e.pathMethods),e.atomListeners&&b.push(...e.atomListeners);let y={notify:e=>{g[e].set(!g[e].get())},listen:(e,t)=>{g[e].subscribe(t)},atoms:g};for(let t of f)t.getActions&&Object.assign(h,t.getActions?.(c,y,e));return{pluginsActions:h,pluginsAtoms:g,pluginPathMethods:m,atomListeners:b,$fetch:c,$store:y}};function l(e,t,r,i,n){return function o(s=[]){return new Proxy(function(){},{get(t,r){let i=[...s,r],n=e;for(let e of i)if(n&&"object"==typeof n&&e in n)n=n[e];else{n=void 0;break}return"function"==typeof n?n:o(i)},apply:async(e,o,a)=>{let l="/"+s.map(e=>e.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)).join("/"),u=a[0]||{},c=a[1]||{},{query:d,fetchOptions:p,...f}=u,h={...c,...p},g=function(e,t,r){let i=t[e],{fetchOptions:n,query:o,...s}=r||{};return i||(n?.method?n.method:s&&Object.keys(s).length>0?"POST":"GET")}(l,r,u);return await t(l,{...h,body:"GET"===g?void 0:{...f,...h?.body||{}},query:d||h?.query,method:g,async onSuccess(e){await h?.onSuccess?.(e);let t=n?.find(e=>e.matcher(l));if(!t)return;let r=i[t.signal];if(!r)return;let o=r.get();setTimeout(()=>{r.set(!o)},10)}})}})}()}}},69214:e=>{"use strict";var{g:t,__dirname:r}=e;function i(e,t,r){let i=new Set(t).add(void 0);return e.listen((e,t,n)=>{i.has(n)&&r(e,t,n)})}function n(e,t,r){let n=i(e,t,r);return r(e.value),n}e.s({listenKeys:()=>i,subscribeKeys:()=>n})},21167:e=>{"use strict";var{g:t,__dirname:r}=e;e.s({capitalizeFirstLetter:()=>a,createAuthClient:()=>l,useStore:()=>s});var i=e.i(917198),n=e.i(69214),o=e.i(838653);function s(e,t={}){let r=(0,o.useRef)(e.get()),{keys:i,deps:a=[e,i]}=t,l=(0,o.useCallback)(t=>{let o=e=>{r.current!==e&&(r.current=e,t())};return(o(e.value),i?.length)?(0,n.listenKeys)(e,i,o):e.listen(o)},a),u=()=>r.current;return(0,o.useSyncExternalStore)(l,u,u)}function a(e){return e.charAt(0).toUpperCase()+e.slice(1)}function l(e){let{pluginPathMethods:t,pluginsActions:r,pluginsAtoms:n,$fetch:o,$store:l,atomListeners:u}=(0,i.g)(e),c={};for(let[e,t]of Object.entries(n))c[`use${a(e)}`]=()=>s(t);let d={...r,...c,$fetch:o,$store:l};return(0,i.c)(d,o,t,n,u)}e.i(88267),e.i(996176),e.i(482786),e.i(925892),e.i(515347),e.i(483159)},357100:e=>{"use strict";var{g:t,__dirname:r}=e;e.s({createAccessControl:()=>o,role:()=>n});var i=e.i(925892);function n(e){return{authorize(t,r="AND"){let n=!1;for(let[o,s]of Object.entries(t)){let t=e[o];if(!t)return{success:!1,error:`You are not allowed to access resource: ${o}`};if(Array.isArray(s))n=s.every(e=>t.includes(e));else if("object"==typeof s)n="OR"===s.connector?s.actions.some(e=>t.includes(e)):s.actions.every(e=>t.includes(e));else throw new i.B("Invalid access control request");if(n&&"OR"===r)return{success:n};if(!n&&"AND"===r)return{success:!1,error:`unauthorized to access resource "${o}"`}}return n?{success:n}:{success:!1,error:"Not authorized"}},statements:e}}function o(e){return{newRole:e=>n(e),statements:e}}},942674:e=>{"use strict";var{g:t,__dirname:r}=e;{e.s({adminAc:()=>n,defaultAc:()=>r,defaultRoles:()=>a,defaultStatements:()=>t,memberAc:()=>s,ownerAc:()=>o});var i=e.i(357100);e.i(925892);let t={organization:["update","delete"],member:["create","update","delete"],invitation:["create","cancel"],team:["create","update","delete"]},r=(0,i.createAccessControl)(t),n=r.newRole({organization:["update"],invitation:["create","cancel"],member:["create","update","delete"],team:["create","update","delete"]}),o=r.newRole({organization:["update","delete"],member:["create","update","delete"],invitation:["create","cancel"],team:["create","update","delete"]}),s=r.newRole({organization:[],member:[],invitation:[],team:[]}),a={admin:n,owner:o,member:s}}},732469:e=>{"use strict";var{g:t,__dirname:r}=e;{e.s({h:()=>t});var i=e.i(942674);let t=e=>{if(!e.permissions&&!e.permission)return!1;let t=e.role.split(","),r=e.options.roles||i.defaultRoles;for(let i of t){let t=r[i],n=t?.authorize(e.permissions??e.permission);if(n?.success)return!0}return!1}}},860612:e=>{"use strict";var{g:t,__dirname:r}=e;function i(e){let t=new Uint8Array(e),r="";for(let e of t)r+=String.fromCharCode(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}e.s({bufferToBase64URLString:()=>i})},279812:e=>{"use strict";var{g:t,__dirname:r}=e;function i(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),r=(4-t.length%4)%4,i=atob(t.padEnd(t.length+r,"=")),n=new ArrayBuffer(i.length),o=new Uint8Array(n);for(let e=0;e<i.length;e++)o[e]=i.charCodeAt(e);return n}e.s({base64URLStringToBuffer:()=>i})},280356:e=>{"use strict";var{g:t,__dirname:r}=e;{function i(){return t.stubThis(globalThis?.PublicKeyCredential!==void 0&&"function"==typeof globalThis.PublicKeyCredential)}e.s({_browserSupportsWebAuthnInternals:()=>t,browserSupportsWebAuthn:()=>i});let t={stubThis:e=>e}}},544415:e=>{"use strict";var{g:t,__dirname:r}=e;e.s({toPublicKeyCredentialDescriptor:()=>n});var i=e.i(279812);function n(e){let{id:t}=e;return{...e,id:(0,i.base64URLStringToBuffer)(t),transports:e.transports}}},334534:e=>{"use strict";var{g:t,__dirname:r}=e;function i(e){return"localhost"===e||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}e.s({isValidDomain:()=>i})},759849:e=>{"use strict";var{g:t,__dirname:r}=e;{e.s({WebAuthnError:()=>t});class t extends Error{constructor({message:e,code:t,cause:r,name:i}){super(e,{cause:r}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=i??r.name,this.code=t}}}},490990:e=>{"use strict";var{g:t,__dirname:r}=e;e.s({identifyRegistrationError:()=>o});var i=e.i(334534),n=e.i(759849);function o({error:e,options:t}){let{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if("AbortError"===e.name){if(t.signal instanceof AbortSignal)return new n.WebAuthnError({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if("ConstraintError"===e.name){if(r.authenticatorSelection?.requireResidentKey===!0)return new n.WebAuthnError({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});else if("conditional"===t.mediation&&r.authenticatorSelection?.userVerification==="required")return new n.WebAuthnError({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});else if(r.authenticatorSelection?.userVerification==="required")return new n.WebAuthnError({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else if("InvalidStateError"===e.name)return new n.WebAuthnError({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});else if("NotAllowedError"===e.name)return new n.WebAuthnError({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});else if("NotSupportedError"===e.name)return new n.WebAuthnError(0===r.pubKeyCredParams.filter(e=>"public-key"===e.type).length?{message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}:{message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});else if("SecurityError"===e.name){let t=globalThis.location.hostname;if(!(0,i.isValidDomain)(t))return new n.WebAuthnError({message:`${globalThis.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e});if(r.rp.id!==t)return new n.WebAuthnError({message:`The RP ID "${r.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else if("TypeError"===e.name){if(r.user.id.byteLength<1||r.user.id.byteLength>64)return new n.WebAuthnError({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if("UnknownError"===e.name)return new n.WebAuthnError({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e});return e}},347695:e=>{"use strict";var{g:t,__dirname:r}=e;{e.s({WebAuthnAbortService:()=>t});let t=new class{constructor(){Object.defineProperty(this,"controller",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}createNewAbortSignal(){if(this.controller){let e=Error("Cancelling existing WebAuthn API call for new one");e.name="AbortError",this.controller.abort(e)}let e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){let e=Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}}},291764:e=>{"use strict";var{g:t,__dirname:r}=e;{e.s({toAuthenticatorAttachment:()=>i});let t=["cross-platform","platform"];function i(e){if(e&&!(0>t.indexOf(e)))return e}}},193262:e=>{"use strict";var{g:t,__dirname:r}=e;e.s({startRegistration:()=>c});var i=e.i(860612),n=e.i(279812),o=e.i(280356),s=e.i(544415),a=e.i(490990),l=e.i(347695),u=e.i(291764);async function c(e){let t,r,c,p,f;!e.optionsJSON&&e.challenge&&(console.warn("startRegistration() was not called correctly. It will try to continue with the provided options, but this call should be refactored to use the expected call structure instead. See https://simplewebauthn.dev/docs/packages/browser#typeerror-cannot-read-properties-of-undefined-reading-challenge for more information."),e={optionsJSON:e});let{optionsJSON:h,useAutoRegister:g=!1}=e;if(!(0,o.browserSupportsWebAuthn)())throw Error("WebAuthn is not supported in this browser");let m={...h,challenge:(0,n.base64URLStringToBuffer)(h.challenge),user:{...h.user,id:(0,n.base64URLStringToBuffer)(h.user.id)},excludeCredentials:h.excludeCredentials?.map(s.toPublicKeyCredentialDescriptor)},b={};g&&(b.mediation="conditional"),b.publicKey=m,b.signal=l.WebAuthnAbortService.createNewAbortSignal();try{t=await navigator.credentials.create(b)}catch(e){throw(0,a.identifyRegistrationError)({error:e,options:b})}if(!t)throw Error("Registration was not completed");let{id:y,rawId:v,response:w,type:R}=t;if("function"==typeof w.getTransports&&(c=w.getTransports()),"function"==typeof w.getPublicKeyAlgorithm)try{p=w.getPublicKeyAlgorithm()}catch(e){d("getPublicKeyAlgorithm()",e)}if("function"==typeof w.getPublicKey)try{let e=w.getPublicKey();null!==e&&(f=(0,i.bufferToBase64URLString)(e))}catch(e){d("getPublicKey()",e)}if("function"==typeof w.getAuthenticatorData)try{r=(0,i.bufferToBase64URLString)(w.getAuthenticatorData())}catch(e){d("getAuthenticatorData()",e)}return{id:y,rawId:(0,i.bufferToBase64URLString)(v),response:{attestationObject:(0,i.bufferToBase64URLString)(w.attestationObject),clientDataJSON:(0,i.bufferToBase64URLString)(w.clientDataJSON),transports:c,publicKeyAlgorithm:p,publicKey:f,authenticatorData:r},type:R,clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(0,u.toAuthenticatorAttachment)(t.authenticatorAttachment)}}function d(e,t){console.warn(`The browser extension that intercepted this WebAuthn API call incorrectly implemented ${e}. You should report this error to them.
`,t)}},697486:e=>{"use strict";var{g:t,__dirname:r}=e;{e.s({_browserSupportsWebAuthnAutofillInternals:()=>t,browserSupportsWebAuthnAutofill:()=>n});var i=e.i(280356);function n(){if(!(0,i.browserSupportsWebAuthn)())return t.stubThis(new Promise(e=>e(!1)));let e=globalThis.PublicKeyCredential;return e?.isConditionalMediationAvailable===void 0?t.stubThis(new Promise(e=>e(!1))):t.stubThis(e.isConditionalMediationAvailable())}let t={stubThis:e=>e}}},142349:e=>{"use strict";var{g:t,__dirname:r}=e;e.s({identifyAuthenticationError:()=>o});var i=e.i(334534),n=e.i(759849);function o({error:e,options:t}){let{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if("AbortError"===e.name){if(t.signal instanceof AbortSignal)return new n.WebAuthnError({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if("NotAllowedError"===e.name)return new n.WebAuthnError({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});else if("SecurityError"===e.name){let t=globalThis.location.hostname;if(!(0,i.isValidDomain)(t))return new n.WebAuthnError({message:`${globalThis.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e});if(r.rpId!==t)return new n.WebAuthnError({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else if("UnknownError"===e.name)return new n.WebAuthnError({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e});return e}},425721:e=>{"use strict";var{g:t,__dirname:r}=e;e.s({startAuthentication:()=>d});var i=e.i(860612),n=e.i(279812),o=e.i(280356),s=e.i(697486),a=e.i(544415),l=e.i(142349),u=e.i(347695),c=e.i(291764);async function d(e){let t,r,d;!e.optionsJSON&&e.challenge&&(console.warn("startAuthentication() was not called correctly. It will try to continue with the provided options, but this call should be refactored to use the expected call structure instead. See https://simplewebauthn.dev/docs/packages/browser#typeerror-cannot-read-properties-of-undefined-reading-challenge for more information."),e={optionsJSON:e});let{optionsJSON:p,useBrowserAutofill:f=!1,verifyBrowserAutofillInput:h=!0}=e;if(!(0,o.browserSupportsWebAuthn)())throw Error("WebAuthn is not supported in this browser");p.allowCredentials?.length!==0&&(t=p.allowCredentials?.map(a.toPublicKeyCredentialDescriptor));let g={...p,challenge:(0,n.base64URLStringToBuffer)(p.challenge),allowCredentials:t},m={};if(f){if(!await (0,s.browserSupportsWebAuthnAutofill)())throw Error("Browser does not support WebAuthn autofill");if(document.querySelectorAll("input[autocomplete$='webauthn']").length<1&&h)throw Error('No <input> with "webauthn" as the only or last value in its `autocomplete` attribute was detected');m.mediation="conditional",g.allowCredentials=[]}m.publicKey=g,m.signal=u.WebAuthnAbortService.createNewAbortSignal();try{r=await navigator.credentials.get(m)}catch(e){throw(0,l.identifyAuthenticationError)({error:e,options:m})}if(!r)throw Error("Authentication was not completed");let{id:b,rawId:y,response:v,type:w}=r;return v.userHandle&&(d=(0,i.bufferToBase64URLString)(v.userHandle)),{id:b,rawId:(0,i.bufferToBase64URLString)(y),response:{authenticatorData:(0,i.bufferToBase64URLString)(v.authenticatorData),clientDataJSON:(0,i.bufferToBase64URLString)(v.clientDataJSON),signature:(0,i.bufferToBase64URLString)(v.signature),userHandle:d},type:w,clientExtensionResults:r.getClientExtensionResults(),authenticatorAttachment:(0,c.toAuthenticatorAttachment)(r.authenticatorAttachment)}}},822520:e=>{"use strict";var{g:t,__dirname:r}=e;e.s({platformAuthenticatorIsAvailable:()=>n});var i=e.i(280356);function n(){return(0,i.browserSupportsWebAuthn)()?PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable():new Promise(e=>e(!1))}},387713:e=>{"use strict";var{g:t,__dirname:r}=e;e.s({})},802560:e=>{"use strict";var{g:t,__dirname:r}=e;e.s({}),e.i(193262),e.i(425721),e.i(280356),e.i(822520),e.i(697486),e.i(279812),e.i(860612),e.i(347695),e.i(759849),e.i(387713)},912928:e=>{"use strict";var{g:t,__dirname:r}=e;e.s({}),e.i(193262),e.i(425721),e.i(280356),e.i(822520),e.i(697486),e.i(279812),e.i(860612),e.i(347695),e.i(759849),e.i(387713),e.i(802560)},648342:e=>{"use strict";var{g:t,__dirname:r}=e;{e.s({t:()=>t});let t=e=>({id:"two-factor",$InferServerPlugin:{},atomListeners:[{matcher:e=>e.startsWith("/two-factor/"),signal:"$sessionSignal"}],pathMethods:{"/two-factor/disable":"POST","/two-factor/enable":"POST","/two-factor/send-otp":"POST","/two-factor/generate-backup-codes":"POST"},fetchPlugins:[{id:"two-factor",name:"two-factor",hooks:{async onSuccess(t){t.data?.twoFactorRedirect&&e?.onTwoFactorRedirect&&await e.onTwoFactorRedirect()}}}]})}},231942:e=>{"use strict";var{g:t,__dirname:r}=e;{e.s({adminAc:()=>n,defaultAc:()=>r,defaultRoles:()=>s,defaultStatements:()=>t,userAc:()=>o});var i=e.i(357100);e.i(925892);let t={user:["create","list","set-role","ban","impersonate","delete","set-password"],session:["list","revoke","delete"]},r=(0,i.createAccessControl)(t),n=r.newRole({user:["create","list","set-role","ban","impersonate","delete","set-password"],session:["list","revoke","delete"]}),o=r.newRole({user:[],session:[]}),s={admin:n,user:o}}},619047:e=>{"use strict";var{g:t,__dirname:r}=e;{e.s({h:()=>t});var i=e.i(231942);let t=e=>{if(e.userId&&e.options?.adminUserIds?.includes(e.userId))return!0;if(!e.permissions&&!e.permission)return!1;let t=(e.role||e.options?.defaultRole||"user").split(","),r=e.options?.roles||i.defaultRoles;for(let i of t){let t=r[i],n=t?.authorize(e.permission??e.permissions);if(n?.success)return!0}return!1}}},818118:e=>{"use strict";var{g:t,__dirname:r}=e;{e.s({InferServerPlugin:()=>P,adminClient:()=>y,anonymousClient:()=>m,apiKeyClient:()=>_,customSessionClient:()=>O,emailOTPClient:()=>A,genericOAuthClient:()=>v,getPasskeyActions:()=>p,inferAdditionalFields:()=>b,jwtClient:()=>w,magicLinkClient:()=>h,multiSessionClient:()=>R,oidcClient:()=>U,oneTapClient:()=>T,oneTimeTokenClient:()=>C,organizationClient:()=>t,passkeyClient:()=>f,phoneNumberClient:()=>g,ssoClient:()=>I,usernameClient:()=>r});var i=e.i(303200);e.i(88267),e.i(482786);var n=e.i(515347),o=e.i(942674),s=e.i(732469);e.i(912928);var a=e.i(193262),l=e.i(759849),u=e.i(425721);e.i(648342);var c=e.i(231942),d=e.i(619047);e.i(357100),e.i(925892);let t=e=>{let t=(0,i.atom)(!1),r=(0,i.atom)(!1),a=(0,i.atom)(!1),l={admin:o.adminAc,member:o.memberAc,owner:o.ownerAc,...e?.roles};return{id:"organization",$InferServerPlugin:{},getActions:t=>({$Infer:{ActiveOrganization:{},Organization:{},Invitation:{},Member:{},Team:{}},organization:{checkRolePermission:t=>(0,s.h)({role:t.role,options:{ac:e?.ac,roles:l},permissions:t.permissions??t.permission})}}),getAtoms:e=>{let i=(0,n.u)(t,"/organization/list",e,{method:"GET"}),o=(0,n.u)([r],"/organization/get-full-organization",e,()=>({method:"GET"})),s=(0,n.u)([a],"/organization/get-active-member",e,{method:"GET"});return{$listOrg:t,$activeOrgSignal:r,$activeMemberSignal:a,activeOrganization:o,listOrganizations:i,activeMember:s}},pathMethods:{"/organization/get-full-organization":"GET"},atomListeners:[{matcher:e=>"/organization/create"===e||"/organization/delete"===e||"/organization/update"===e,signal:"$listOrg"},{matcher:e=>e.startsWith("/organization"),signal:"$activeOrgSignal"},{matcher:e=>e.startsWith("/organization/set-active"),signal:"$sessionSignal"},{matcher:e=>e.includes("/organization/update-member-role"),signal:"$activeMemberSignal"}]}},r=()=>({id:"username",$InferServerPlugin:{}}),p=(e,{$listPasskeys:t})=>({signIn:{passkey:async(t,r)=>{let i=await e("/passkey/generate-authenticate-options",{method:"POST",body:{email:t?.email}});if(!i.data)return i;try{let n=await (0,u.startAuthentication)({optionsJSON:i.data,useBrowserAutofill:t?.autoFill}),o=await e("/passkey/verify-authentication",{body:{response:n},...t?.fetchOptions,...r,method:"POST"});if(!o.data)return o}catch(e){return{data:null,error:{message:"auth cancelled",status:400,statusText:"BAD_REQUEST"}}}}},passkey:{addPasskey:async(r,i)=>{let n=await e("/passkey/generate-register-options",{method:"GET",query:{...r?.authenticatorAttachment&&{authenticatorAttachment:r.authenticatorAttachment}}});if(!n.data)return n;try{let o=await (0,a.startRegistration)({optionsJSON:n.data,useAutoRegister:r?.useAutoRegister}),s=await e("/passkey/verify-registration",{...r?.fetchOptions,...i,body:{response:o,name:r?.name},method:"POST"});if(!s.data)return s;t.set(Math.random())}catch(e){if(e instanceof l.WebAuthnError){if("ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED"===e.code)return{data:null,error:{message:"previously registered",status:400,statusText:"BAD_REQUEST"}};if("ERROR_CEREMONY_ABORTED"===e.code)return{data:null,error:{message:"registration cancelled",status:400,statusText:"BAD_REQUEST"}};return{data:null,error:{message:e.message,status:400,statusText:"BAD_REQUEST"}}}return{data:null,error:{message:e instanceof Error?e.message:"unknown error",status:500,statusText:"INTERNAL_SERVER_ERROR"}}}}},$Infer:{}}),f=()=>{let e=(0,i.atom)();return{id:"passkey",$InferServerPlugin:{},getActions:t=>p(t,{$listPasskeys:e}),getAtoms:t=>({listPasskeys:(0,n.u)(e,"/passkey/list-user-passkeys",t,{method:"GET"}),$listPasskeys:e}),pathMethods:{"/passkey/register":"POST","/passkey/authenticate":"POST"},atomListeners:[{matcher:e=>"/passkey/verify-registration"===e||"/passkey/delete-passkey"===e||"/passkey/update-passkey"===e,signal:"_listPasskeys"}]}},h=()=>({id:"magic-link",$InferServerPlugin:{}}),g=()=>({id:"phoneNumber",$InferServerPlugin:{},atomListeners:[{matcher:e=>"/phone-number/update"===e||"/phone-number/verify"===e,signal:"$sessionSignal"}]}),m=()=>({id:"anonymous",$InferServerPlugin:{},pathMethods:{"/sign-in/anonymous":"POST"}}),b=e=>({id:"additional-fields-client",$InferServerPlugin:{}}),y=e=>{let t={admin:c.adminAc,user:c.userAc,...e?.roles};return{id:"admin-client",$InferServerPlugin:{},getActions:r=>({admin:{checkRolePermission:r=>(0,d.h)({role:r.role,options:{ac:e?.ac,roles:t},permissions:r.permissions??r.permission})}}),pathMethods:{"/admin/list-users":"GET","/admin/stop-impersonating":"POST"}}},v=()=>({id:"generic-oauth-client",$InferServerPlugin:{}}),w=()=>({id:"better-auth-client",$InferServerPlugin:{}}),R=()=>({id:"multi-session",$InferServerPlugin:{},atomListeners:[{matcher:e=>"/multi-session/set-active"===e,signal:"$sessionSignal"}]}),A=()=>({id:"email-otp",$InferServerPlugin:{}}),E=!1,T=e=>({id:"one-tap",getActions:(t,r)=>({oneTap:async(r,i)=>{if(E)return void console.warn("A Google One Tap request is already in progress. Please wait.");E=!0;try{if("undefined"==typeof window||!window.document)return void console.warn("Google One Tap is only available in browser environments");let{autoSelect:n,cancelOnTapOutside:o,context:s}=r??{},a=s??e.context??"signin";await S(),await new Promise((s,l)=>{let u=!1,c=e.promptOptions?.baseDelay??1e3,d=e.promptOptions?.maxAttempts??5;window.google?.accounts.id.initialize({client_id:e.clientId,callback:async e=>{u=!0;try{await t("/one-tap/callback",{method:"POST",body:{idToken:e.credential},...r?.fetchOptions,...i}),(!r?.fetchOptions&&!i||r?.callbackURL)&&(window.location.href=r?.callbackURL??"/"),s()}catch(e){console.error("Error during One Tap callback:",e),l(e)}},auto_select:n,cancel_on_tap_outside:o,context:a,...e.additionalOptions});let p=e=>{u||window.google?.accounts.id.prompt(t=>{if(!u){if(t.isDismissedMoment&&t.isDismissedMoment())if(e<d){let t=Math.pow(2,e)*c;setTimeout(()=>p(e+1),t)}else r?.onPromptNotification?.(t);else if(t.isSkippedMoment&&t.isSkippedMoment())if(e<d){let t=Math.pow(2,e)*c;setTimeout(()=>p(e+1),t)}else r?.onPromptNotification?.(t)}})};p(0)})}catch(e){throw console.error("Error during Google One Tap flow:",e),e}finally{E=!1}}}),getAtoms:e=>({})}),S=()=>new Promise(e=>{if(window.googleScriptInitialized)return void e();let t=document.createElement("script");t.src="https://accounts.google.com/gsi/client",t.async=!0,t.defer=!0,t.onload=()=>{window.googleScriptInitialized=!0,e()},document.head.appendChild(t)}),O=()=>P(),P=()=>({id:"infer-server-plugin",$InferServerPlugin:{}}),I=()=>({id:"sso-client",$InferServerPlugin:{}}),U=()=>({id:"oidc-client",$InferServerPlugin:{}}),_=()=>({id:"api-key",$InferServerPlugin:{},pathMethods:{"/api-key/create":"POST","/api-key/delete":"POST","/api-key/delete-all-expired-api-keys":"POST"}}),C=()=>({id:"one-time-token",$InferServerPlugin:{}})}},368319:e=>{"use strict";var{g:t,__dirname:r}=e;e.s({}),e.i(88267),e.i(482786),e.i(515347),e.i(942674),e.i(732469),e.i(912928),e.i(648342),e.i(231942),e.i(619047),e.i(357100),e.i(925892),e.i(818118)},395372:e=>{"use strict";var{g:t,__dirname:r}=e;{e.s({authClient:()=>t,signIn:()=>r,signOut:()=>a,signUp:()=>s,useSession:()=>l});var i=e.i(875358),n=e.i(21167);e.i(368319);var o=e.i(818118);let t=(0,n.createAuthClient)({baseURL:window.location.origin,plugins:[(0,i.stripeClient)({subscription:!0}),(0,o.adminClient)(),(0,o.apiKeyClient)(),(0,o.magicLinkClient)()]}),{signIn:r,signUp:s,signOut:a,useSession:l}=t}}}]);

//# sourceMappingURL=fe0f898516b09be9.js.map