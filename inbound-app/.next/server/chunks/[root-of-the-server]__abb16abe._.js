module.exports={929549:function(e){var{g:t,__dirname:s,m:o,e:n}=e;o.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},983943:function(e){var{g:t,__dirname:s,m:o,e:n}=e;o.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},86103:function(e){var{g:t,__dirname:s,m:o,e:n}=e;o.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},945935:function(e){var{g:t,__dirname:s,m:o,e:n}=e;o.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},348629:function(e){var{g:t,__dirname:s,m:o,e:n}=e;o.exports=e.x("@opentelemetry/api",()=>require("@opentelemetry/api"))},76569:function(e){var{g:t,__dirname:s,m:o,e:n}=e;o.exports=e.x("node:events",()=>require("node:events"))},804713:function(e){var{g:t,__dirname:s,m:o,e:n}=e;o.exports=e.x("util",()=>require("util"))},87485:function(e){var{g:t,__dirname:s,m:o,e:n}=e;o.exports=e.x("child_process",()=>require("child_process"))},420467:function(e){var{g:t,__dirname:s,m:o,e:n}=e;o.exports=e.x("events",()=>require("events"))},936121:function(e){var{g:t,__dirname:s,m:o,e:n}=e;o.exports=e.x("node:util",()=>require("node:util"))},681635:function(e){var{g:t,__dirname:s,m:o,e:n}=e;o.exports=e.x("node:http",()=>require("node:http"))},866098:function(e){var{g:t,__dirname:s,m:o,e:n}=e;o.exports=e.x("node:https",()=>require("node:https"))},580767:function(e){var{g:t,__dirname:s,m:o,e:n}=e;o.exports=e.x("node:buffer",()=>require("node:buffer"))},329295:function(e){var{g:t,__dirname:s,m:o,e:n}=e;o.exports=e.x("crypto",()=>require("crypto"))},62445:function(e){var{g:t,__dirname:s,m:o,e:n}=e;o.exports=e.x("http",()=>require("http"))},348388:function(e){var{g:t,__dirname:s,m:o,e:n}=e;o.exports=e.x("https",()=>require("https"))},591032:function(e){var{g:t,__dirname:s,m:o,e:n}=e;o.exports=e.x("node:crypto",()=>require("node:crypto"))},909834:e=>{"use strict";var{g:t,__dirname:s}=e;e.s({DELIVERY_STATUS:()=>n.DELIVERY_STATUS,DELIVERY_TYPES:()=>n.DELIVERY_TYPES,DOMAIN_STATUS:()=>n.DOMAIN_STATUS,EMAIL_STATUS:()=>n.EMAIL_STATUS,ENDPOINT_TYPES:()=>n.ENDPOINT_TYPES,PROVIDER_CONFIDENCE:()=>n.PROVIDER_CONFIDENCE,SENT_EMAIL_STATUS:()=>n.SENT_EMAIL_STATUS,SES_VERIFICATION_STATUS:()=>n.SES_VERIFICATION_STATUS,VIP_PAYMENT_STATUS:()=>n.VIP_PAYMENT_STATUS,WEBHOOK_FORMATS:()=>n.WEBHOOK_FORMATS,WEBHOOK_STATUS:()=>n.WEBHOOK_STATUS,account:()=>o.account,apikey:()=>o.apikey,blockedEmails:()=>n.blockedEmails,domainDnsRecords:()=>n.domainDnsRecords,emailAddresses:()=>n.emailAddresses,emailDomains:()=>n.emailDomains,emailGroups:()=>n.emailGroups,endpointDeliveries:()=>n.endpointDeliveries,endpoints:()=>n.endpoints,parsedEmails:()=>n.parsedEmails,receivedEmails:()=>n.receivedEmails,sentEmails:()=>n.sentEmails,sesEvents:()=>n.sesEvents,session:()=>o.session,structuredEmails:()=>n.structuredEmails,subscriptions:()=>n.subscriptions,user:()=>o.user,userAccounts:()=>n.userAccounts,userOnboarding:()=>n.userOnboarding,verification:()=>o.verification,vipAllowedSenders:()=>n.vipAllowedSenders,vipConfigs:()=>n.vipConfigs,vipEmailAttempts:()=>n.vipEmailAttempts,vipPaymentSessions:()=>n.vipPaymentSessions,webhookDeliveries:()=>n.webhookDeliveries,webhooks:()=>n.webhooks});var o=e.i(594120),n=e.i(55379)},436754:e=>{"use strict";var{g:t,__dirname:s}=e;e.s({DELIVERY_STATUS:()=>o.DELIVERY_STATUS,DELIVERY_TYPES:()=>o.DELIVERY_TYPES,DOMAIN_STATUS:()=>o.DOMAIN_STATUS,EMAIL_STATUS:()=>o.EMAIL_STATUS,ENDPOINT_TYPES:()=>o.ENDPOINT_TYPES,PROVIDER_CONFIDENCE:()=>o.PROVIDER_CONFIDENCE,SENT_EMAIL_STATUS:()=>o.SENT_EMAIL_STATUS,SES_VERIFICATION_STATUS:()=>o.SES_VERIFICATION_STATUS,VIP_PAYMENT_STATUS:()=>o.VIP_PAYMENT_STATUS,WEBHOOK_FORMATS:()=>o.WEBHOOK_FORMATS,WEBHOOK_STATUS:()=>o.WEBHOOK_STATUS,account:()=>o.account,apikey:()=>o.apikey,blockedEmails:()=>o.blockedEmails,domainDnsRecords:()=>o.domainDnsRecords,emailAddresses:()=>o.emailAddresses,emailDomains:()=>o.emailDomains,emailGroups:()=>o.emailGroups,endpointDeliveries:()=>o.endpointDeliveries,endpoints:()=>o.endpoints,parsedEmails:()=>o.parsedEmails,receivedEmails:()=>o.receivedEmails,sentEmails:()=>o.sentEmails,sesEvents:()=>o.sesEvents,session:()=>o.session,structuredEmails:()=>o.structuredEmails,subscriptions:()=>o.subscriptions,user:()=>o.user,userAccounts:()=>o.userAccounts,userOnboarding:()=>o.userOnboarding,verification:()=>o.verification,vipAllowedSenders:()=>o.vipAllowedSenders,vipConfigs:()=>o.vipConfigs,vipEmailAttempts:()=>o.vipEmailAttempts,vipPaymentSessions:()=>o.vipPaymentSessions,webhookDeliveries:()=>o.webhookDeliveries,webhooks:()=>o.webhooks}),e.i(468686);var o=e.i(909834)},20740:e=>{"use strict";var{g:t,__dirname:s}=e;{e.s({WEBHOOK_FORMAT_CONFIGS:()=>t,generateRealPayload:()=>i,generateTestPayload:()=>n,getWebhookFormatConfig:()=>o});let t={inbound:{name:"Inbound Webhook",description:"Standard Inbound email webhook format with full email data",testPayload:e=>({event:"webhook_test",timestamp:e.timestamp,messageId:e.messageId,source:e.from,destination:e.to,subject:e.subject,body:{text:e.textBody||"This is a test email from the Inbound Email service to verify webhook functionality.",html:e.htmlBody||"<p>This is a test email from the <strong>Inbound Email service</strong> to verify webhook functionality.</p>"},attachments:e.attachments||[],headers:e.headers||{},test:!0}),realPayload:e=>({event:"email_received",timestamp:e.timestamp,messageId:e.messageId,source:e.from,destination:e.to,subject:e.subject,body:{text:e.textBody,html:e.htmlBody},attachments:e.attachments||[],headers:e.headers||{}})},discord:{name:"Discord Webhook",description:"Discord-compatible webhook format with rich embeds",testPayload:e=>({content:`üìß **Test Email Received**`,embeds:[{title:e.subject||"Test Email - Inbound Email Service",description:e.textBody||"This is a test email from the Inbound Email service to verify webhook functionality.",color:65280,timestamp:e.timestamp,footer:{text:"Inbound Email Service - Test",icon_url:"https://inbound.new/favicon.ico"},fields:[{name:"From",value:e.from||"test@example.com",inline:!0},{name:"To",value:e.to.join(", ")||e.recipient,inline:!0},{name:"Message ID",value:`\`${e.messageId}\``,inline:!1}]}]}),realPayload:e=>({content:`üìß **New Email Received**`,embeds:[{title:e.subject||"No Subject",description:e.textBody?e.textBody.length>2e3?e.textBody.substring(0,2e3)+"...":e.textBody:"No content",color:39423,timestamp:e.timestamp,footer:{text:"Inbound Email Service",icon_url:"https://inbound.new/favicon.ico"},fields:[{name:"From",value:e.from,inline:!0},{name:"To",value:e.to.join(", "),inline:!0},...e.attachments&&e.attachments.length>0?[{name:"Attachments",value:e.attachments.map(e=>e.filename||"Unknown").join(", "),inline:!1}]:[],{name:"Message ID",value:`\`${e.messageId}\``,inline:!1}]}]})},slack:{name:"Slack Webhook",description:"Slack-compatible webhook format with attachments",testPayload:e=>({text:`üìß *Test Email Received*`,username:"Inbound Email",icon_url:"https://inbound.new/favicon.ico",attachments:[{fallback:`Test email: ${e.subject}`,color:"good",title:e.subject||"Test Email - Inbound Email Service",text:e.textBody||"This is a test email from the Inbound Email service to verify webhook functionality.",fields:[{title:"From",value:e.from||"test@example.com",short:!0},{title:"To",value:e.to.join(", ")||e.recipient,short:!0},{title:"Message ID",value:e.messageId,short:!1}],footer:"Inbound Email Service - Test",ts:Math.floor(new Date(e.timestamp).getTime()/1e3)}]}),realPayload:e=>({text:`üìß *New Email Received*`,username:"Inbound Email",icon_url:"https://inbound.new/favicon.ico",attachments:[{fallback:`New email: ${e.subject}`,color:"#0099ff",title:e.subject||"No Subject",text:e.textBody?e.textBody.length>1e3?e.textBody.substring(0,1e3)+"...":e.textBody:"No content",fields:[{title:"From",value:e.from,short:!0},{title:"To",value:e.to.join(", "),short:!0},...e.attachments&&e.attachments.length>0?[{title:"Attachments",value:e.attachments.map(e=>e.filename||"Unknown").join(", "),short:!1}]:[],{title:"Message ID",value:e.messageId,short:!1}],footer:"Inbound Email Service",ts:Math.floor(new Date(e.timestamp).getTime()/1e3)}]})}};function o(e){return t[e]}function n(e,s){let o=t[e],n={...{messageId:`test-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,from:"test@example.com",to:["test@yourdomain.com"],subject:"Test Email - Inbound Email Service",textBody:"This is a test email from the Inbound Email service to verify webhook functionality.",htmlBody:"<p>This is a test email from the <strong>Inbound Email service</strong> to verify webhook functionality.</p>",attachments:[],headers:{From:"test@example.com",To:"test@yourdomain.com",Subject:"Test Email - Inbound Email Service",Date:new Date().toISOString()},timestamp:new Date().toISOString(),recipient:"test@yourdomain.com"},...s};return o.testPayload(n)}function i(e,s){return t[e].realPayload(s)}}},385016:function(e){var{g:t,__dirname:s,m:o,e:n}=e},19845:e=>{"use strict";var{g:t,__dirname:s}=e;e.s({POST:()=>m});var o=e.i(125427),n=e.i(402168),i=e.i(998322),r=e.i(557440);e.i(468686);var a=e.i(55379),d=e.i(176825),l=e.i(20740);async function m(e,{params:t}){try{let{id:e}=await t;console.log(`üß™ POST /api/v1/endpoints/${e}/test - Testing endpoint`);let s=await n.auth.api.getSession({headers:await (0,i.headers)()});if(!s?.user?.id)return console.warn(`‚ùå POST /api/v1/endpoints/${e}/test - Unauthorized request`),o.NextResponse.json({error:"Unauthorized"},{status:401});let m=await r.db.select().from(a.endpoints).where((0,d.and)((0,d.eq)(a.endpoints.id,e),(0,d.eq)(a.endpoints.userId,s.user.id))).limit(1);if(!m[0])return o.NextResponse.json({error:"Endpoint not found or access denied"},{status:404});if(!m[0].isActive)return o.NextResponse.json({success:!1,message:"Endpoint is disabled",responseTime:0},{status:400});let c=JSON.parse(m[0].config),u=Date.now(),p={success:!1,message:"Test not implemented for this endpoint type",responseTime:0};switch(m[0].type){case"webhook":try{console.log(`üîó Testing webhook: ${c.url}`);let t=m[0].webhookFormat||"inbound";console.log(`üìã Using webhook format: ${t}`);let s=(0,l.generateTestPayload)(t,{messageId:`test-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,from:"test@example.com",to:["test@yourdomain.com"],subject:"Test Email - Inbound Email Service",recipient:"test@yourdomain.com"});"inbound"===t&&"object"==typeof s&&(s.endpoint={id:m[0].id,name:m[0].name});let o={};if(c.headers)try{o="string"==typeof c.headers?JSON.parse(c.headers):c.headers}catch(t){console.warn(`‚ö†Ô∏è Invalid custom headers for endpoint ${e}:`,t),o={}}let n={"Content-Type":"application/json","User-Agent":"InboundEmail-Test/1.0","X-Test-Request":"true","X-Endpoint-ID":m[0].id,...o};console.log(`üì§ Test payload:`,JSON.stringify(s,null,2)),console.log(`üìã Request headers:`,JSON.stringify(n,null,2));let i=await fetch(c.url,{method:"POST",headers:n,body:JSON.stringify(s),signal:AbortSignal.timeout(1e3*(c.timeout||30))}),r=Date.now()-u,a="";try{a=await i.text()}catch{a="Unable to read response body"}p={success:i.ok,message:i.ok?`Webhook responded successfully (${i.status})`:`Webhook returned error (${i.status})`,responseTime:r,statusCode:i.status,responseBody:a.substring(0,500)},console.log(`${i.ok?"‚úÖ":"‚ùå"} Webhook test ${i.ok?"passed":"failed"}: ${i.status} in ${r}ms`),console.log(`üìÑ Response body:`,a)}catch(s){let e=Date.now()-u,t="Unknown error";s instanceof Error&&(t="AbortError"===s.name?`Request timeout after ${c.timeout||30}s`:s.message),p={success:!1,message:`Webhook test failed: ${t}`,responseTime:e,error:t},console.error(`‚ùå Webhook test failed:`,t)}break;case"email":try{let e=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,t=e.test(c.forwardTo),s=!0;c.fromAddress&&(s=e.test(c.fromAddress)),p={success:t&&s,message:t&&s?`Email configuration is valid (forwards to: ${c.forwardTo})`:t?`Invalid from address: ${c.fromAddress}`:`Invalid forward-to email address: ${c.forwardTo}`,responseTime:Date.now()-u,config:{forwardTo:c.forwardTo,fromAddress:c.fromAddress||"auto-detected",includeAttachments:c.includeAttachments??!0,subjectPrefix:c.subjectPrefix||"none"}},console.log(`${p.success?"‚úÖ":"‚ùå"} Email endpoint test ${p.success?"passed":"failed"}`)}catch(e){p={success:!1,message:`Email configuration test failed: ${e instanceof Error?e.message:"Unknown error"}`,responseTime:Date.now()-u}}break;case"email_group":try{let e=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,t=c.emails||[],s=t.filter(t=>e.test(t)),o=t.filter(t=>!e.test(t)),n=!0;c.fromAddress&&(n=e.test(c.fromAddress));let i=0===o.length&&t.length>0&&n;p={success:i,message:i?`Email group configuration is valid (${s.length} recipients)`:o.length>0?`Invalid email addresses: ${o.join(", ")}`:0===t.length?"Email group must have at least one email address":`Invalid from address: ${c.fromAddress}`,responseTime:Date.now()-u,config:{totalEmails:t.length,validEmails:s.length,invalidEmails:o.length,fromAddress:c.fromAddress||"auto-detected",includeAttachments:c.includeAttachments??!0,subjectPrefix:c.subjectPrefix||"none"}},console.log(`${p.success?"‚úÖ":"‚ùå"} Email group test ${p.success?"passed":"failed"}`)}catch(e){p={success:!1,message:`Email group configuration test failed: ${e instanceof Error?e.message:"Unknown error"}`,responseTime:Date.now()-u}}break;default:p={success:!1,message:`Unknown endpoint type: ${m[0].type}`,responseTime:Date.now()-u}}return console.log(`${p.success?"‚úÖ":"‚ùå"} Test ${p.success?"passed":"failed"} for endpoint ${e} (${m[0].type})`),o.NextResponse.json(p)}catch(e){return console.error(`‚ùå POST /api/v1/endpoints/test - Error:`,e),o.NextResponse.json({success:!1,error:"Failed to test endpoint",details:e instanceof Error?e.message:"Unknown error",responseTime:0},{status:500})}}},979295:e=>{"use strict";var{g:t,__dirname:s}=e;{e.s({patchFetch:()=>a,routeModule:()=>t,serverHooks:()=>l,workAsyncStorage:()=>s,workUnitAsyncStorage:()=>d});var o=e.i(854885),n=e.i(814689),i=e.i(25402),r=e.i(19845);let t=new o.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/v1/endpoints/[id]/test/route",pathname:"/api/v1/endpoints/[id]/test",filename:"route",bundlePath:""},resolvedPagePath:"[project]/app/api/v1/endpoints/[id]/test/route.ts",nextConfigOutput:"",userland:r}),{workAsyncStorage:s,workUnitAsyncStorage:d,serverHooks:l}=t;function a(){return(0,i.patchFetch)({workAsyncStorage:s,workUnitAsyncStorage:d})}}},993477:e=>{var{g:t,__dirname:s}=e;e.v(t=>Promise.all(["server/chunks/[root-of-the-server]__836c501b._.js","server/chunks/node_modules_10ae7a2d._.js"].map(t=>e.l(t))).then(()=>t(611487)))}};

//# sourceMappingURL=%5Broot-of-the-server%5D__abb16abe._.js.map