{"version":3,"sources":["turbopack:///[project]/node_modules/next/src/server/route-modules/app-page/vendored/rsc/react-server-dom-turbopack-server-edge.ts","turbopack:///[project]/node_modules/autumn-js/dist/sdk/index.mjs","turbopack:///[project]/node_modules/@aws-sdk/client-ses/dist-es/commands/SendRawEmailCommand.js","turbopack:///[project]/app/api/v2/emails/[id]/reply/route.ts","turbopack:///[project]/node_modules/next/dist/src/build/templates/app-route.ts"],"sourcesContent":["module.exports = require('../../module.compiled').vendored[\n  'react-rsc'\n].ReactServerDOMTurbopackServerEdge\n","var __defProp = Object.defineProperty;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __publicField = (obj, key, value) => __defNormalProp(obj, typeof key !== \"symbol\" ? key + \"\" : key, value);\n\n// src/sdk/error.ts\nvar AutumnError = class extends Error {\n  constructor(response) {\n    super(response.message);\n    __publicField(this, \"message\");\n    __publicField(this, \"code\");\n    this.message = response.message;\n    this.code = response.code;\n  }\n  toString() {\n    return `${this.message} (code: ${this.code})`;\n  }\n  toJSON() {\n    return {\n      message: this.message,\n      code: this.code\n    };\n  }\n};\n\n// src/sdk/utils.ts\nvar staticWrapper = (callback, instance, args) => {\n  if (!instance) {\n    instance = new Autumn();\n  }\n  return callback({ instance, ...args });\n};\n\n// src/sdk/customers/cusMethods.ts\nvar customerMethods = (instance) => {\n  return {\n    get: (id, params) => staticWrapper(getCustomer, instance, { id, params }),\n    create: (params) => staticWrapper(createCustomer, instance, { params }),\n    update: (id, params) => staticWrapper(updateCustomer, instance, { id, params }),\n    delete: (id) => staticWrapper(deleteCustomer, instance, { id }),\n    billingPortal: (id, params) => staticWrapper(billingPortal, instance, { id, params })\n  };\n};\nvar getExpandStr = (expand) => {\n  if (!expand) {\n    return \"\";\n  }\n  return `expand=${expand.join(\",\")}`;\n};\nvar getCustomer = async ({\n  instance,\n  id,\n  params\n}) => {\n  if (!id) {\n    return {\n      data: null,\n      error: new AutumnError({\n        message: \"Customer ID is required\",\n        code: \"CUSTOMER_ID_REQUIRED\"\n      })\n    };\n  }\n  return instance.get(`/customers/${id}?${getExpandStr(params?.expand)}`);\n};\nvar createCustomer = async ({\n  instance,\n  params\n}) => {\n  return instance.post(`/customers?${getExpandStr(params?.expand)}`, params);\n};\nvar updateCustomer = async ({\n  instance,\n  id,\n  params\n}) => {\n  return instance.post(`/customers/${id}`, params);\n};\nvar deleteCustomer = async ({\n  instance,\n  id\n}) => {\n  return instance.delete(`/customers/${id}`);\n};\nvar billingPortal = async ({\n  instance,\n  id,\n  params\n}) => {\n  return instance.post(`/customers/${id}/billing_portal`, params);\n};\n\n// src/sdk/customers/entities/entMethods.ts\nvar entityMethods = (instance) => {\n  return {\n    get: (customer_id, entity_id, params) => staticWrapper(getEntity, instance, {\n      customer_id,\n      entity_id,\n      params\n    }),\n    create: (customer_id, params) => staticWrapper(createEntity, instance, { customer_id, params }),\n    delete: (customer_id, entity_id) => staticWrapper(deleteEntity, instance, { customer_id, entity_id })\n  };\n};\nvar getExpandStr2 = (expand) => {\n  if (!expand) {\n    return \"\";\n  }\n  return `expand=${expand.join(\",\")}`;\n};\nvar getEntity = async ({\n  instance,\n  customer_id,\n  entity_id,\n  params\n}) => {\n  return instance.get(\n    `/customers/${customer_id}/entities/${entity_id}?${getExpandStr2(\n      params?.expand\n    )}`\n  );\n};\nvar createEntity = async ({\n  instance,\n  customer_id,\n  params\n}) => {\n  return instance.post(`/customers/${customer_id}/entities`, params);\n};\nvar deleteEntity = async ({\n  instance,\n  customer_id,\n  entity_id\n}) => {\n  return instance.delete(`/customers/${customer_id}/entities/${entity_id}`);\n};\n\n// src/sdk/general/genMethods.ts\nvar handleAttach = async ({\n  instance,\n  params\n}) => {\n  return instance.post(\"/attach\", params);\n};\nvar handleCancel = async ({\n  instance,\n  params\n}) => {\n  return instance.post(\"/cancel\", params);\n};\nvar handleEntitled = async ({\n  instance,\n  params\n}) => {\n  return instance.post(\"/entitled\", params);\n};\nvar handleEvent = async ({\n  instance,\n  params\n}) => {\n  return instance.post(\"/events\", params);\n};\nvar handleTrack = async ({\n  instance,\n  params\n}) => {\n  return instance.post(\"/track\", params);\n};\nvar handleUsage = async ({\n  instance,\n  params\n}) => {\n  return instance.post(\"/usage\", params);\n};\nvar handleCheck = async ({\n  instance,\n  params\n}) => {\n  return instance.post(\"/check\", params);\n};\n\n// src/sdk/products/prodMethods.ts\nvar productMethods = (instance) => {\n  return {\n    get: (id) => staticWrapper(getProduct, instance, { id }),\n    create: (params) => staticWrapper(createProduct, instance, { params }),\n    list: (params) => staticWrapper(listProducts, instance, { params })\n  };\n};\nvar listProducts = async ({\n  instance,\n  params\n}) => {\n  let path = \"/products\";\n  if (params) {\n    const queryParams = new URLSearchParams();\n    for (const [key, value] of Object.entries(params)) {\n      if (value !== void 0) {\n        queryParams.append(key, String(value));\n      }\n    }\n    const queryString = queryParams.toString();\n    if (queryString) {\n      path += `?${queryString}`;\n    }\n  }\n  return instance.get(path);\n};\nvar getProduct = async ({\n  instance,\n  id\n}) => {\n  return instance.get(`/products/${id}`);\n};\nvar createProduct = async ({\n  instance,\n  params\n}) => {\n  return instance.post(\"/products\", params);\n};\n\n// src/sdk/response.ts\nvar toContainerResult = async (response) => {\n  if (response.status < 200 || response.status >= 300) {\n    let error;\n    try {\n      error = await response.json();\n    } catch (error2) {\n      return {\n        data: null,\n        error: new AutumnError({\n          message: \"Failed to parse JSON response from Autumn\",\n          code: \"internal_error\"\n        }),\n        statusCode: response.status\n      };\n    }\n    return {\n      data: null,\n      error: new AutumnError({\n        message: error.message,\n        code: error.code\n      }),\n      statusCode: response.status\n    };\n  }\n  try {\n    let data = await response.json();\n    return {\n      data,\n      error: null,\n      statusCode: response?.status\n    };\n  } catch (error) {\n    return {\n      data: null,\n      error: new AutumnError({\n        message: \"Failed to parse Autumn API response\",\n        code: \"internal_error\"\n      }),\n      statusCode: response?.status\n    };\n  }\n};\n\n// src/sdk/client.ts\nvar LATEST_API_VERSION = \"1.2\";\nvar Autumn = class {\n  constructor(options) {\n    __publicField(this, \"secretKey\");\n    __publicField(this, \"publishableKey\");\n    __publicField(this, \"level\");\n    __publicField(this, \"headers\");\n    __publicField(this, \"url\");\n    __publicField(this, \"customers\", customerMethods(this));\n    __publicField(this, \"products\", productMethods(this));\n    __publicField(this, \"entities\", entityMethods(this));\n    try {\n      this.secretKey = options?.secretKey || process.env.AUTUMN_SECRET_KEY;\n      this.publishableKey = options?.publishableKey || process.env.AUTUMN_PUBLISHABLE_KEY;\n    } catch (error) {\n    }\n    if (!this.secretKey && !this.publishableKey) {\n      throw new Error(\"Autumn secret key or publishable key is required\");\n    }\n    this.headers = {\n      Authorization: `Bearer ${this.secretKey || this.publishableKey}`,\n      \"Content-Type\": \"application/json\"\n    };\n    let version = options?.version || LATEST_API_VERSION;\n    this.headers[\"x-api-version\"] = version;\n    this.url = options?.url || \"https://api.useautumn.com/v1\";\n    this.level = this.secretKey ? \"secret\" : \"publishable\";\n  }\n  getLevel() {\n    return this.level;\n  }\n  async get(path) {\n    const response = await fetch(`${this.url}${path}`, {\n      headers: this.headers\n    });\n    return toContainerResult(response);\n  }\n  async post(path, body) {\n    const response = await fetch(`${this.url}${path}`, {\n      method: \"POST\",\n      headers: this.headers,\n      body: JSON.stringify(body)\n    });\n    return toContainerResult(response);\n  }\n  async delete(path) {\n    const response = await fetch(`${this.url}${path}`, {\n      method: \"DELETE\",\n      headers: this.headers\n    });\n    return toContainerResult(response);\n  }\n  async attach(params) {\n    return handleAttach({\n      instance: this,\n      params\n    });\n  }\n  async cancel(params) {\n    return handleCancel({\n      instance: this,\n      params\n    });\n  }\n  /**\n   * @deprecated This method is deprecated and will be removed in a future version.\n   * Please use the new check() method instead.\n   */\n  async entitled(params) {\n    return handleEntitled({\n      instance: this,\n      params\n    });\n  }\n  async check(params) {\n    return handleCheck({\n      instance: this,\n      params\n    });\n  }\n  /**\n   * @deprecated This method is deprecated and will be removed in a future version.\n   * Please use the new track() method instead.\n   */\n  async event(params) {\n    return handleEvent({\n      instance: this,\n      params\n    });\n  }\n  async track(params) {\n    return handleTrack({\n      instance: this,\n      params\n    });\n  }\n  async usage(params) {\n    return handleUsage({\n      instance: this,\n      params\n    });\n  }\n};\n__publicField(Autumn, \"customers\", customerMethods());\n__publicField(Autumn, \"products\", productMethods());\n__publicField(Autumn, \"entities\", entityMethods());\n__publicField(Autumn, \"attach\", (params) => staticWrapper(handleAttach, void 0, { params }));\n__publicField(Autumn, \"usage\", (params) => staticWrapper(handleUsage, void 0, { params }));\n__publicField(Autumn, \"cancel\", (params) => staticWrapper(handleCancel, void 0, { params }));\n/**\n * @deprecated This method is deprecated and will be removed in a future version.\n * Please use the new check() method instead.\n */\n__publicField(Autumn, \"entitled\", (params) => staticWrapper(handleEntitled, void 0, { params }));\n__publicField(Autumn, \"check\", (params) => staticWrapper(handleCheck, void 0, { params }));\n/**\n * @deprecated This method is deprecated and will be removed in a future version.\n * Please use the new track() method instead.\n */\n__publicField(Autumn, \"event\", (params) => staticWrapper(handleEvent, void 0, { params }));\n__publicField(Autumn, \"track\", (params) => staticWrapper(handleTrack, void 0, { params }));\n\n// src/sdk/general/genEnums.ts\nvar AppEnv = /* @__PURE__ */ ((AppEnv2) => {\n  AppEnv2[\"Sandbox\"] = \"sandbox\";\n  AppEnv2[\"Live\"] = \"live\";\n  return AppEnv2;\n})(AppEnv || {});\n\n// src/sdk/customers/cusEnums.ts\nvar ProductStatus = /* @__PURE__ */ ((ProductStatus2) => {\n  ProductStatus2[\"Active\"] = \"active\";\n  ProductStatus2[\"Expired\"] = \"expired\";\n  ProductStatus2[\"Trialing\"] = \"trialing\";\n  ProductStatus2[\"Scheduled\"] = \"scheduled\";\n  return ProductStatus2;\n})(ProductStatus || {});\n\n// src/sdk/products/prodEnums.ts\nvar Infinite = \"inf\";\nvar FreeTrialDuration = /* @__PURE__ */ ((FreeTrialDuration2) => {\n  FreeTrialDuration2[\"Day\"] = \"day\";\n  return FreeTrialDuration2;\n})(FreeTrialDuration || {});\nvar UsageModel = /* @__PURE__ */ ((UsageModel2) => {\n  UsageModel2[\"Prepaid\"] = \"prepaid\";\n  UsageModel2[\"PayPerUse\"] = \"pay_per_use\";\n  return UsageModel2;\n})(UsageModel || {});\nvar ProductItemInterval = /* @__PURE__ */ ((ProductItemInterval2) => {\n  ProductItemInterval2[\"Minute\"] = \"minute\";\n  ProductItemInterval2[\"Hour\"] = \"hour\";\n  ProductItemInterval2[\"Day\"] = \"day\";\n  ProductItemInterval2[\"Week\"] = \"week\";\n  ProductItemInterval2[\"Month\"] = \"month\";\n  ProductItemInterval2[\"Quarter\"] = \"quarter\";\n  ProductItemInterval2[\"SemiAnnual\"] = \"semi_annual\";\n  ProductItemInterval2[\"Year\"] = \"year\";\n  ProductItemInterval2[\"Multiple\"] = \"multiple\";\n  return ProductItemInterval2;\n})(ProductItemInterval || {});\n\n// src/sdk/components/componentMethods.ts\nvar fetchPricingTable = async ({\n  instance,\n  params\n}) => {\n  let path = \"/components/pricing_table\";\n  if (params) {\n    const queryParams = new URLSearchParams();\n    for (const [key, value] of Object.entries(params)) {\n      if (key === \"products\") {\n        continue;\n      }\n      if (value !== void 0) {\n        queryParams.append(key, String(value));\n      }\n    }\n    const queryString = queryParams.toString();\n    if (queryString) {\n      path += `?${queryString}`;\n    }\n  }\n  return await instance.get(path);\n};\n\nexport { AppEnv, Autumn, AutumnError, FreeTrialDuration, Infinite, ProductItemInterval, ProductStatus, UsageModel, fetchPricingTable, toContainerResult };\n","import { getEndpointPlugin } from \"@smithy/middleware-endpoint\";\nimport { getSerdePlugin } from \"@smithy/middleware-serde\";\nimport { Command as $Command } from \"@smithy/smithy-client\";\nimport { commonParams } from \"../endpoint/EndpointParameters\";\nimport { de_SendRawEmailCommand, se_SendRawEmailCommand } from \"../protocols/Aws_query\";\nexport { $Command };\nexport class SendRawEmailCommand extends $Command\n    .classBuilder()\n    .ep(commonParams)\n    .m(function (Command, cs, config, o) {\n    return [\n        getSerdePlugin(config, this.serialize, this.deserialize),\n        getEndpointPlugin(config, Command.getEndpointParameterInstructions()),\n    ];\n})\n    .s(\"SimpleEmailService\", \"SendRawEmail\", {})\n    .n(\"SESClient\", \"SendRawEmailCommand\")\n    .f(void 0, void 0)\n    .ser(se_SendRawEmailCommand)\n    .de(de_SendRawEmailCommand)\n    .build() {\n}\n","import { NextRequest, NextResponse } from 'next/server'\nimport { validateRequest } from '../../../helper/main'\nimport { SESClient, SendRawEmailCommand } from '@aws-sdk/client-ses'\nimport { db } from '@/lib/db'\nimport { sentEmails, emailDomains, structuredEmails, SENT_EMAIL_STATUS } from '@/lib/db/schema'\nimport { eq, and } from 'drizzle-orm'\nimport { Autumn as autumn } from 'autumn-js'\nimport { nanoid } from 'nanoid'\n\n/**\n * POST /api/v2/emails/[id]/reply\n * Reply to an inbound email\n * Supports both session-based auth and API key auth\n * Has tests? ❌\n * Has logging? ✅\n * Has types? ✅\n */\n\n// POST /api/v2/emails/[id]/reply types\nexport interface PostEmailReplyRequest {\n    from: string\n    to?: string | string[]  // Optional - will use original sender if not provided\n    subject?: string        // Optional - will add \"Re: \" to original subject if not provided\n    cc?: string | string[]\n    bcc?: string | string[]\n    reply_to?: string | string[]\n    html?: string\n    text?: string\n    headers?: Record<string, string>\n    attachments?: Array<{\n        content: string // Base64 encoded\n        filename: string\n        path?: string\n        content_type?: string\n    }>\n    include_original?: boolean  // Whether to include quoted original message (default: true)\n}\n\nexport interface PostEmailReplyResponse {\n    id: string\n}\n\n// Helper functions\nfunction extractEmailAddress(email: string): string {\n    const match = email.match(/<(.+)>/)\n    return match ? match[1] : email.trim()\n}\n\nfunction extractDomain(email: string): string {\n    const address = extractEmailAddress(email)\n    const parts = address.split('@')\n    return parts.length === 2 ? parts[1] : ''\n}\n\nfunction toArray(value: string | string[] | undefined): string[] {\n    if (!value) return []\n    return Array.isArray(value) ? value : [value]\n}\n\n// Format date for email headers\nfunction formatEmailDate(date: Date): string {\n    const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat']\n    const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']\n    \n    const day = days[date.getUTCDay()]\n    const dayNum = date.getUTCDate()\n    const month = months[date.getUTCMonth()]\n    const year = date.getUTCFullYear()\n    const hours = date.getUTCHours().toString().padStart(2, '0')\n    const minutes = date.getUTCMinutes().toString().padStart(2, '0')\n    const seconds = date.getUTCSeconds().toString().padStart(2, '0')\n    \n    return `${day}, ${dayNum} ${month} ${year} ${hours}:${minutes}:${seconds} +0000`\n}\n\n// Quote the original message for reply\nfunction quoteMessage(originalEmail: any, includeOriginal: boolean = true): string {\n    if (!includeOriginal) return ''\n    \n    // Parse the from data\n    let fromData = null\n    if (originalEmail.fromData) {\n        try {\n            fromData = JSON.parse(originalEmail.fromData)\n        } catch (e) {\n            console.error('Failed to parse fromData:', e)\n        }\n    }\n    \n    const fromText = fromData?.text || 'Unknown Sender'\n    const dateStr = originalEmail.date ? formatEmailDate(new Date(originalEmail.date)) : 'Unknown Date'\n    \n    // Create the quote header in standard email format\n    const quoteHeader = `\\n\\nOn ${dateStr}, ${fromText} wrote:\\n`\n    \n    // Quote the original message with > prefix\n    const originalText = originalEmail.textBody || ''\n    \n    // Split into lines and process each line properly\n    const lines = originalText.split('\\n')\n    const quotedLines = lines.map((line: string) => {\n        // If line is empty or only whitespace, keep it empty (no > prefix)\n        if (line.trim() === '') {\n            return ''\n        }\n        \n        // If line already starts with '>', add another level of quoting\n        if (line.startsWith('>')) {\n            return `>${line}`\n        }\n        \n        // Otherwise, add single level quote\n        return `> ${line}`\n    })\n    \n    return quoteHeader + quotedLines.join('\\n')\n}\n\n// Build raw email message\nfunction buildRawEmailMessage(params: {\n    from: string\n    to: string[]\n    cc?: string[]\n    bcc?: string[]\n    replyTo?: string[]\n    subject: string\n    textBody?: string\n    htmlBody?: string\n    messageId: string\n    inReplyTo?: string\n    references?: string[]\n    date: Date\n    customHeaders?: Record<string, string>\n}): string {\n    const boundary = `----=_Part_${nanoid()}`\n    \n    // Check if Message-ID is provided in custom headers\n    const hasCustomMessageId = params.customHeaders && \n        Object.keys(params.customHeaders).some(key => key.toLowerCase() === 'message-id')\n    \n    // Build headers\n    let headers = [\n        `From: ${params.from}`,\n        `To: ${params.to.join(', ')}`,\n        params.cc && params.cc.length > 0 ? `Cc: ${params.cc.join(', ')}` : null,\n        params.replyTo && params.replyTo.length > 0 ? `Reply-To: ${params.replyTo.join(', ')}` : null,\n        `Subject: ${params.subject}`,\n        // Only add Message-ID if not provided in custom headers\n        !hasCustomMessageId ? `Message-ID: <${params.messageId}@${extractDomain(params.from)}>` : null,\n        params.inReplyTo ? `In-Reply-To: ${params.inReplyTo}` : null,\n        params.references && params.references.length > 0 ? `References: ${params.references.join(' ')}` : null,\n        `Date: ${formatEmailDate(params.date)}`,\n        'MIME-Version: 1.0',\n    ].filter(Boolean)\n    \n    // Add custom headers\n    if (params.customHeaders) {\n        for (const [key, value] of Object.entries(params.customHeaders)) {\n            headers.push(`${key}: ${value}`)\n        }\n    }\n    \n    // Build body based on content type\n    let body = []\n    \n    if (params.textBody && params.htmlBody) {\n        // Multipart alternative\n        headers.push(`Content-Type: multipart/alternative; boundary=\"${boundary}\"`)\n        body.push('')  // Empty line between headers and body\n        \n        // Text part\n        body.push(`--${boundary}`)\n        body.push('Content-Type: text/plain; charset=UTF-8')\n        body.push('Content-Transfer-Encoding: quoted-printable')\n        body.push('')\n        body.push(params.textBody)\n        \n        // HTML part\n        body.push(`--${boundary}`)\n        body.push('Content-Type: text/html; charset=UTF-8')\n        body.push('Content-Transfer-Encoding: quoted-printable')\n        body.push('')\n        body.push(params.htmlBody)\n        \n        body.push(`--${boundary}--`)\n    } else if (params.textBody) {\n        // Plain text only\n        headers.push('Content-Type: text/plain; charset=UTF-8')\n        headers.push('Content-Transfer-Encoding: quoted-printable')\n        body.push('')  // Empty line between headers and body\n        body.push(params.textBody)\n    } else if (params.htmlBody) {\n        // HTML only\n        headers.push('Content-Type: text/html; charset=UTF-8')\n        headers.push('Content-Transfer-Encoding: quoted-printable')\n        body.push('')  // Empty line between headers and body\n        body.push(params.htmlBody)\n    }\n    \n    return headers.join('\\r\\n') + '\\r\\n' + body.join('\\r\\n')\n}\n\n// Initialize SES client\nconst awsRegion = process.env.AWS_REGION || 'us-east-2'\nconst awsAccessKeyId = process.env.AWS_ACCESS_KEY_ID\nconst awsSecretAccessKey = process.env.AWS_SECRET_ACCESS_KEY\n\nlet sesClient: SESClient | null = null\n\nif (awsAccessKeyId && awsSecretAccessKey) {\n    sesClient = new SESClient({\n        region: awsRegion,\n        credentials: {\n            accessKeyId: awsAccessKeyId,\n            secretAccessKey: awsSecretAccessKey,\n        }\n    })\n} else {\n    console.warn('⚠️ AWS credentials not configured. Email sending will not work.')\n}\n\nexport async function POST(\n    request: NextRequest,\n    { params }: { params: Promise<{ id: string }> }\n) {\n    console.log('📧 POST /api/v2/emails/[id]/reply - Starting request')\n    \n    try {\n        console.log('🔐 Validating request authentication')\n        const { userId, error } = await validateRequest(request)\n        if (!userId) {\n            console.log('❌ Authentication failed:', error)\n            return NextResponse.json(\n                { error: error },\n                { status: 401 }\n            )\n        }\n        console.log('✅ Authentication successful for userId:', userId)\n\n        const { id: emailId } = await params\n        console.log('📨 Replying to email ID:', emailId)\n\n        // Validate email ID\n        if (!emailId || typeof emailId !== 'string') {\n            console.log('⚠️ Invalid email ID provided:', emailId)\n            return NextResponse.json(\n                { error: 'Valid email ID is required' },\n                { status: 400 }\n            )\n        }\n\n        // Check for idempotency key\n        const idempotencyKey = request.headers.get('Idempotency-Key')\n        if (idempotencyKey) {\n            console.log('🔑 Idempotency key provided:', idempotencyKey)\n            \n            // Check if we've already processed this request\n            const existingEmail = await db\n                .select()\n                .from(sentEmails)\n                .where(\n                    and(\n                        eq(sentEmails.userId, userId),\n                        eq(sentEmails.idempotencyKey, idempotencyKey)\n                    )\n                )\n                .limit(1)\n            \n            if (existingEmail.length > 0) {\n                console.log('♻️ Idempotent request - returning existing email:', existingEmail[0].id)\n                return NextResponse.json({ id: existingEmail[0].id })\n            }\n        }\n\n        // Get the original email\n        console.log('🔍 Fetching original email')\n        const originalEmail = await db\n            .select()\n            .from(structuredEmails)\n            .where(\n                and(\n                    eq(structuredEmails.id, emailId),\n                    eq(structuredEmails.userId, userId)\n                )\n            )\n            .limit(1)\n\n        if (originalEmail.length === 0) {\n            console.log('📭 Original email not found')\n            return NextResponse.json(\n                { error: 'Email not found' },\n                { status: 404 }\n            )\n        }\n\n        const original = originalEmail[0]\n        console.log('✅ Found original email:', original.subject)\n\n        console.log('📝 Parsing request body')\n        const body: PostEmailReplyRequest = await request.json()\n        \n        // Parse original email data\n        let originalFromData = null\n        if (original.fromData) {\n            try {\n                originalFromData = JSON.parse(original.fromData)\n            } catch (e) {\n                console.error('Failed to parse original fromData:', e)\n            }\n        }\n\n        // Determine reply recipients\n        const originalSenderAddress = originalFromData?.addresses?.[0]?.address\n        if (!originalSenderAddress && !body.to) {\n            console.log('⚠️ Cannot determine recipient for reply')\n            return NextResponse.json(\n                { error: 'Cannot determine recipient email address' },\n                { status: 400 }\n            )\n        }\n\n        // Set default values\n        const toAddresses = body.to ? toArray(body.to) : [originalFromData?.text || originalSenderAddress]\n        const subject = body.subject || `Re: ${original.subject || 'No Subject'}`\n        const includeOriginal = body.include_original !== false  // Default to true\n\n        // Validate required fields\n        if (!body.from) {\n            console.log('⚠️ Missing required field: from')\n            return NextResponse.json(\n                { error: 'From address is required' },\n                { status: 400 }\n            )\n        }\n\n        // Validate email content\n        if (!body.html && !body.text) {\n            console.log('⚠️ No email content provided')\n            return NextResponse.json(\n                { error: 'Either html or text content must be provided' },\n                { status: 400 }\n            )\n        }\n\n        // Extract sender information\n        const fromAddress = extractEmailAddress(body.from)\n        const fromDomain = extractDomain(body.from)\n        \n        console.log('📧 Reply details:', { \n            from: body.from, \n            to: toAddresses,\n            subject,\n            originalMessageId: original.messageId\n        })\n\n        // Verify sender domain ownership\n        console.log('🔍 Verifying domain ownership for:', fromDomain)\n        const userDomain = await db\n            .select()\n            .from(emailDomains)\n            .where(\n                and(\n                    eq(emailDomains.userId, userId),\n                    eq(emailDomains.domain, fromDomain),\n                    eq(emailDomains.status, 'verified')\n                )\n            )\n            .limit(1)\n\n        if (userDomain.length === 0) {\n            console.log('❌ User does not own the sender domain:', fromDomain)\n            return NextResponse.json(\n                { error: `You don't have permission to send from domain: ${fromDomain}` },\n                { status: 403 }\n            )\n        }\n\n        console.log('✅ Domain ownership verified')\n\n        // Convert recipients to arrays\n        const ccAddresses = toArray(body.cc)\n        const bccAddresses = toArray(body.bcc)\n        const replyToAddresses = toArray(body.reply_to)\n\n        // Validate email addresses\n        const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/\n        const allRecipients = [...toAddresses, ...ccAddresses, ...bccAddresses]\n        \n        for (const email of allRecipients) {\n            const address = extractEmailAddress(email)\n            if (!emailRegex.test(address)) {\n                console.log('⚠️ Invalid email format:', email)\n                return NextResponse.json(\n                    { error: `Invalid email format: ${email}` },\n                    { status: 400 }\n                )\n            }\n        }\n\n        // Check Autumn for email sending limits\n        console.log('🔍 Checking email sending limits with Autumn')\n        const { data: emailCheck, error: emailCheckError } = await autumn.check({\n            customer_id: userId,\n            feature_id: \"emails_sent\"\n        })\n\n        if (emailCheckError) {\n            console.error('❌ Autumn email check error:', emailCheckError)\n            return NextResponse.json(\n                { error: 'Failed to check email sending limits' },\n                { status: 500 }\n            )\n        }\n\n        if (!emailCheck.allowed) {\n            console.log('❌ Email sending limit reached for user:', userId)\n            return NextResponse.json(\n                { error: 'Email sending limit reached. Please upgrade your plan to send more emails.' },\n                { status: 429 }\n            )\n        }\n\n        // Build threading headers\n        const inReplyTo = original.messageId ? `<${original.messageId}>` : undefined\n        let references: string[] = []\n        \n        // Parse existing references\n        if (original.references) {\n            try {\n                const parsedRefs = JSON.parse(original.references)\n                if (Array.isArray(parsedRefs)) {\n                    references = parsedRefs\n                }\n            } catch (e) {\n                console.error('Failed to parse references:', e)\n            }\n        }\n        \n        // Add the original message ID to references\n        if (original.messageId) {\n            references.push(`<${original.messageId}>`)\n        }\n\n        // Add quoted original message to text body\n        let finalTextBody = body.text || ''\n        if (includeOriginal && body.text) {\n            finalTextBody += quoteMessage(original, true)\n        }\n\n        // Add quoted original message to HTML body\n        let finalHtmlBody = body.html || ''\n        if (includeOriginal && body.html && original.htmlBody) {\n            // HTML quoting with proper email client styling\n            const fromText = originalFromData?.text || 'Unknown Sender'\n            const dateStr = original.date ? formatEmailDate(new Date(original.date)) : 'Unknown Date'\n            \n            finalHtmlBody += `\n                <br><br>\n                <div style=\"border-left: 2px solid #ccc; padding-left: 10px; margin-left: 10px; color: #666; font-size: 13px;\">\n                    <p style=\"margin: 0 0 10px 0; font-weight: normal;\">On ${dateStr}, ${fromText} wrote:</p>\n                    <div style=\"margin: 0;\">${original.htmlBody}</div>\n                </div>\n            `\n        }\n\n        // Create sent email record\n        const replyEmailId = nanoid()\n        \n        // Check if a custom Message-ID is provided (case-insensitive)\n        let messageId = `${replyEmailId}@${fromDomain}`\n        if (body.headers) {\n            // Find Message-ID header case-insensitively\n            const messageIdKey = Object.keys(body.headers).find(\n                key => key.toLowerCase() === 'message-id'\n            )\n            if (messageIdKey && body.headers[messageIdKey]) {\n                // Extract the Message-ID value (remove angle brackets if present)\n                messageId = body.headers[messageIdKey].replace(/^<|>$/g, '')\n            }\n        }\n        \n        console.log('💾 Creating sent email record:', replyEmailId)\n        \n        const sentEmailRecord = await db.insert(sentEmails).values({\n            id: replyEmailId,\n            from: body.from,\n            fromAddress,\n            fromDomain,\n            to: JSON.stringify(toAddresses),\n            cc: ccAddresses.length > 0 ? JSON.stringify(ccAddresses) : null,\n            bcc: bccAddresses.length > 0 ? JSON.stringify(bccAddresses) : null,\n            replyTo: replyToAddresses.length > 0 ? JSON.stringify(replyToAddresses) : null,\n            subject,\n            textBody: finalTextBody,\n            htmlBody: finalHtmlBody,\n            headers: JSON.stringify({\n                ...(body.headers || {}),\n                'In-Reply-To': inReplyTo,\n                'References': references.join(' ')\n            }),\n            attachments: body.attachments ? JSON.stringify(body.attachments) : null,\n            status: SENT_EMAIL_STATUS.PENDING,\n            messageId,\n            userId,\n            idempotencyKey,\n            createdAt: new Date(),\n            updatedAt: new Date()\n        }).returning()\n\n        // Check if SES is configured\n        if (!sesClient) {\n            console.log('❌ AWS SES not configured')\n            \n            // Update email status to failed\n            await db\n                .update(sentEmails)\n                .set({\n                    status: SENT_EMAIL_STATUS.FAILED,\n                    failureReason: 'AWS SES not configured',\n                    updatedAt: new Date()\n                })\n                .where(eq(sentEmails.id, replyEmailId))\n            \n            return NextResponse.json(\n                { error: 'Email service not configured. Please contact support.' },\n                { status: 500 }\n            )\n        }\n\n        try {\n            console.log('📤 Sending reply email via AWS SES')\n            \n            // Build raw email message with proper headers\n            const rawMessage = buildRawEmailMessage({\n                from: body.from,\n                to: toAddresses,\n                cc: ccAddresses,\n                bcc: bccAddresses,\n                replyTo: replyToAddresses,\n                subject,\n                textBody: finalTextBody,\n                htmlBody: finalHtmlBody,\n                messageId,\n                inReplyTo,\n                references,\n                date: new Date(),\n                customHeaders: body.headers\n            })\n            \n            // Send raw email to preserve headers\n            const sesCommand = new SendRawEmailCommand({\n                RawMessage: {\n                    Data: Buffer.from(rawMessage)\n                },\n                Source: fromAddress,\n                Destinations: [...toAddresses, ...ccAddresses, ...bccAddresses].map(extractEmailAddress)\n            })\n\n            const sesResponse = await sesClient.send(sesCommand)\n            const sesMessageId = sesResponse.MessageId\n\n            console.log('✅ Reply sent successfully via SES:', sesMessageId)\n\n            // Update email record with success\n            await db\n                .update(sentEmails)\n                .set({\n                    status: SENT_EMAIL_STATUS.SENT,\n                    providerResponse: JSON.stringify(sesResponse),\n                    sentAt: new Date(),\n                    updatedAt: new Date()\n                })\n                .where(eq(sentEmails.id, replyEmailId))\n\n            // Track email usage with Autumn (only if not unlimited)\n            if (!emailCheck.unlimited) {\n                console.log('📊 Tracking email usage with Autumn')\n                const { error: trackError } = await autumn.track({\n                    customer_id: userId,\n                    feature_id: \"emails_sent\",\n                    value: 1,\n                })\n\n                if (trackError) {\n                    console.error('❌ Failed to track email usage:', trackError)\n                    // Don't fail the request if tracking fails\n                }\n            }\n\n            console.log('✅ Reply processing complete')\n            return NextResponse.json({ id: replyEmailId }, { status: 200 })\n\n        } catch (sesError) {\n            console.error('❌ SES send error:', sesError)\n            \n            // Update email status to failed\n            await db\n                .update(sentEmails)\n                .set({\n                    status: SENT_EMAIL_STATUS.FAILED,\n                    failureReason: sesError instanceof Error ? sesError.message : 'Unknown SES error',\n                    providerResponse: JSON.stringify(sesError),\n                    updatedAt: new Date()\n                })\n                .where(eq(sentEmails.id, replyEmailId))\n            \n            return NextResponse.json(\n                { error: 'Failed to send reply. Please try again later.' },\n                { status: 500 }\n            )\n        }\n\n    } catch (error) {\n        console.error('💥 Unexpected error in POST /api/v2/emails/[id]/reply:', error)\n        return NextResponse.json(\n            { error: 'Internal server error' },\n            { status: 500 }\n        )\n    }\n} ","import {\n  AppRouteRouteModule,\n  type AppRouteRouteModuleOptions,\n} from '../../server/route-modules/app-route/module.compiled'\nimport { RouteKind } from '../../server/route-kind'\nimport { patchFetch as _patchFetch } from '../../server/lib/patch-fetch'\n\nimport * as userland from 'VAR_USERLAND'\n\n// These are injected by the loader afterwards. This is injected as a variable\n// instead of a replacement because this could also be `undefined` instead of\n// an empty string.\ndeclare const nextConfigOutput: AppRouteRouteModuleOptions['nextConfigOutput']\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\n// INJECT:nextConfigOutput\n\nconst routeModule = new AppRouteRouteModule({\n  definition: {\n    kind: RouteKind.APP_ROUTE,\n    page: 'VAR_DEFINITION_PAGE',\n    pathname: 'VAR_DEFINITION_PATHNAME',\n    filename: 'VAR_DEFINITION_FILENAME',\n    bundlePath: 'VAR_DEFINITION_BUNDLE_PATH',\n  },\n  resolvedPagePath: 'VAR_RESOLVED_PAGE_PATH',\n  nextConfigOutput,\n  userland,\n})\n\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule\n\nfunction patchFetch() {\n  return _patchFetch({\n    workAsyncStorage,\n    workUnitAsyncStorage,\n  })\n}\n\nexport {\n  routeModule,\n  workAsyncStorage,\n  workUnitAsyncStorage,\n  serverHooks,\n  patchFetch,\n}\n"],"names":["module","exports","require","vendored","ReactServerDOMTurbopackServerEdge","AppRouteRouteModule","RouteKind","patchFetch","_patchFetch","userland","routeModule","definition","kind","APP_ROUTE","page","pathname","filename","bundlePath","resolvedPagePath","nextConfigOutput","workAsyncStorage","workUnitAsyncStorage","serverHooks"],"mappings":"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","ignoreList":[0,1,2,4]}