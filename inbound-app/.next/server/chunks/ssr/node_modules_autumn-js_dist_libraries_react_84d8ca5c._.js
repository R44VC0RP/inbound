module.exports={756566:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({toSnakeCase:()=>d});var d=a=>Array.isArray(a)?a.map(d):null!==a&&"object"==typeof a?Object.fromEntries(Object.entries(a).map(([a,b])=>[a.replace(/([a-z])([A-Z])/g,"$1_$2").replace(/[-\s]+/g,"_").toLowerCase(),d(b)])):a},617836:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({attachMethod:()=>e,cancelMethod:()=>f,checkMethod:()=>g,openBillingPortalMethod:()=>i,trackMethod:()=>h});var d=a.i(756566);async function e(a){let{dialog:b,...c}=a,e=(0,d.toSnakeCase)(c);return await this.post("/api/autumn/attach",e)}async function f(a){let b=(0,d.toSnakeCase)(a);return await this.post("/api/autumn/cancel",b)}async function g(a){let{dialog:b,...c}=a,e=(0,d.toSnakeCase)(c);return await this.post("/api/autumn/check",e)}async function h(a){let b=(0,d.toSnakeCase)(a);return await this.post("/api/autumn/track",b)}async function i(a){let b=(0,d.toSnakeCase)(a||{});return await this.post("/api/autumn/billing_portal",b)}},207994:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({AutumnError:()=>d,toContainerResult:()=>e});var d=class extends Error{message;code;constructor(a){super(a.message),this.message=a.message,this.code=a.code}toString(){return`${this.message} (code: ${this.code})`}toJSON(){return{message:this.message,code:this.code}}},e=async a=>{if(a.status<200||a.status>=300){let b;try{b=await a.json()}catch(b){return{data:null,error:new d({message:"Failed to parse JSON response from Autumn",code:"internal_error"}),statusCode:a.status}}return{data:null,error:new d({message:b.message,code:b.code}),statusCode:a.status}}try{return{data:await a.json(),error:null,statusCode:a?.status}}catch(b){return{data:null,error:new d({message:"Failed to parse Autumn API response",code:"internal_error"}),statusCode:a?.status}}},f=(a,b,c)=>(b||(b=new D),a({instance:b,...c})),g=a=>({get:(b,c)=>f(i,a,{id:b,params:c}),create:b=>f(j,a,{params:b}),update:(b,c)=>f(k,a,{id:b,params:c}),delete:b=>f(l,a,{id:b}),billingPortal:(b,c)=>f(m,a,{id:b,params:c})}),h=a=>a?`expand=${a.join(",")}`:"",i=async({instance:a,id:b,params:c})=>b?a.get(`/customers/${b}?${h(c?.expand)}`):{data:null,error:new d({message:"Customer ID is required",code:"CUSTOMER_ID_REQUIRED"})},j=async({instance:a,params:b})=>a.post(`/customers?${h(b?.expand)}`,b),k=async({instance:a,id:b,params:c})=>a.post(`/customers/${b}`,c),l=async({instance:a,id:b})=>a.delete(`/customers/${b}`),m=async({instance:a,id:b,params:c})=>a.post(`/customers/${b}/billing_portal`,c),n=a=>({get:(b,c,d)=>f(p,a,{customer_id:b,entity_id:c,params:d}),create:(b,c)=>f(q,a,{customer_id:b,params:c}),delete:(b,c)=>f(r,a,{customer_id:b,entity_id:c})}),o=a=>a?`expand=${a.join(",")}`:"",p=async({instance:a,customer_id:b,entity_id:c,params:d})=>a.get(`/customers/${b}/entities/${c}?${o(d?.expand)}`),q=async({instance:a,customer_id:b,params:c})=>a.post(`/customers/${b}/entities`,c),r=async({instance:a,customer_id:b,entity_id:c})=>a.delete(`/customers/${b}/entities/${c}`),s=async({instance:a,params:b})=>a.post("/attach",b),t=async({instance:a,params:b})=>a.post("/cancel",b),u=async({instance:a,params:b})=>a.post("/entitled",b),v=async({instance:a,params:b})=>a.post("/events",b),w=async({instance:a,params:b})=>a.post("/track",b),x=async({instance:a,params:b})=>a.post("/usage",b),y=async({instance:a,params:b})=>a.post("/check",b),z=a=>({get:b=>f(B,a,{id:b}),create:b=>f(C,a,{params:b}),list:b=>f(A,a,{params:b})}),A=async({instance:a,params:b})=>{let c="/products";if(b){let a=new URLSearchParams;for(let[c,d]of Object.entries(b))void 0!==d&&a.append(c,String(d));let d=a.toString();d&&(c+=`?${d}`)}return a.get(c)},B=async({instance:a,id:b})=>a.get(`/products/${b}`),C=async({instance:a,params:b})=>a.post("/products",b),D=class{secretKey;publishableKey;level;headers;url;constructor(a){try{this.secretKey=a?.secretKey||process.env.AUTUMN_SECRET_KEY,this.publishableKey=a?.publishableKey||process.env.AUTUMN_PUBLISHABLE_KEY}catch(a){}if(!this.secretKey&&!this.publishableKey)throw Error("Autumn secret key or publishable key is required");this.headers={Authorization:`Bearer ${this.secretKey||this.publishableKey}`,"Content-Type":"application/json"};let b=a?.version||"1.2";this.headers["x-api-version"]=b,this.url=a?.url||"https://api.useautumn.com/v1",this.level=this.secretKey?"secret":"publishable"}getLevel(){return this.level}async get(a){return e(await fetch(`${this.url}${a}`,{headers:this.headers}))}async post(a,b){return e(await fetch(`${this.url}${a}`,{method:"POST",headers:this.headers,body:JSON.stringify(b)}))}async delete(a){return e(await fetch(`${this.url}${a}`,{method:"DELETE",headers:this.headers}))}static customers=g();static products=z();static entities=n();customers=g(this);products=z(this);entities=n(this);static attach=a=>f(s,void 0,{params:a});static usage=a=>f(x,void 0,{params:a});async attach(a){return s({instance:this,params:a})}static cancel=a=>f(t,void 0,{params:a});async cancel(a){return t({instance:this,params:a})}static entitled=a=>f(u,void 0,{params:a});async entitled(a){return u({instance:this,params:a})}static check=a=>f(y,void 0,{params:a});async check(a){return y({instance:this,params:a})}static event=a=>f(v,void 0,{params:a});async event(a){return v({instance:this,params:a})}static track=a=>f(w,void 0,{params:a});async track(a){return w({instance:this,params:a})}async usage(a){return x({instance:this,params:a})}}},728423:a=>{"use strict";var{g:b,__dirname:c}=a;async function d(){return await this.get("/api/autumn/components/pricing_table")}a.s({getPricingTableMethod:()=>d})},154343:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({createCustomerMethod:()=>d});var d=async({client:a,params:b})=>await a.post("/api/autumn/customers",b)},882496:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({createEntityMethod:()=>f,deleteEntityMethod:()=>h,getEntityMethod:()=>g});var d=a.i(756566),e=a=>a?`expand=${a.join(",")}`:"";async function f(a){let b=(0,d.toSnakeCase)(a);return await this.post("/api/autumn/entities",b)}async function g(a,b){(0,d.toSnakeCase)(b);let c=e(b?.expand);return await this.get(`/api/autumn/entities/${a}?${c}`)}async function h(a){return await this.delete(`/api/autumn/entities/${a}`)}},803846:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({AutumnClient:()=>i});var d=a.i(617836),e=a.i(207994),f=a.i(728423),g=a.i(154343),h=a.i(882496),i=class{backendUrl;getBearerToken;customerData;includeCredentials;constructor({backendUrl:a,getBearerToken:b,customerData:c,includeCredentials:d}){this.backendUrl=a,this.getBearerToken=b,this.customerData=c,this.includeCredentials=d}async getHeaders(){let a={"Content-Type":"application/json"};if(this.getBearerToken)try{let b=await this.getBearerToken();a.Authorization=`Bearer ${b}`}catch(a){console.error("Failed to call getToken() in AutumnProvider")}return a}async handleFetchResult(a){return await (0,e.toContainerResult)(a)}async post(a,b){let c=await fetch(`${this.backendUrl}${a}`,{method:"POST",body:JSON.stringify({...b,customer_data:this.customerData||void 0}),headers:await this.getHeaders(),credentials:this.includeCredentials?"include":void 0});return await this.handleFetchResult(c)}async get(a){let b=await fetch(`${this.backendUrl}${a}`,{method:"GET",headers:await this.getHeaders(),credentials:this.includeCredentials?"include":void 0});return await this.handleFetchResult(b)}async delete(a){let b=await fetch(`${this.backendUrl}${a}`,{method:"DELETE",headers:await this.getHeaders()});return await this.handleFetchResult(b)}async createCustomer(a){return await (0,g.createCustomerMethod)({client:this,params:a})}async getPricingTable(){return await f.getPricingTableMethod.bind(this)()}attach=d.attachMethod.bind(this);cancel=d.cancelMethod.bind(this);check=d.checkMethod.bind(this);track=d.trackMethod.bind(this);openBillingPortal=d.openBillingPortalMethod.bind(this);entities={create:h.createEntityMethod.bind(this),get:h.getEntityMethod.bind(this),delete:h.deleteEntityMethod.bind(this)}}},7007:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({AutumnContext:()=>f,useAutumnContext:()=>g});var d=a.i(803846),e=a.i(722851),f=(0,e.createContext)({customerProvider:null,pricingTableProvider:{pricingTableProducts:null,isLoading:!0,error:null,refetch:()=>Promise.resolve()},entityProvider:{entity:null,isLoading:!0,error:null,refetch:()=>Promise.resolve(),lastParams:null},client:new d.AutumnClient({backendUrl:"http://localhost:8000"}),paywallDialog:{props:null,setProps:()=>{},open:!1,setOpen:()=>{},setComponent:()=>{}},prodChangeDialog:{props:null,setProps:()=>{},open:!1,setOpen:()=>{},setComponent:()=>{}}}),g=()=>{let a=(0,e.useContext)(f);if(void 0===a)throw Error("useAutumnContext must be used within a AutumnContextProvider");return a}},805175:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({useAutumn:()=>e});var d=a.i(7007),e=()=>{let{client:a}=(0,d.useAutumnContext)(),{prodChangeDialog:b,paywallDialog:c,pricingTableProvider:e,customerProvider:f}=(0,d.useAutumnContext)(),{setProps:g,setOpen:h,setComponent:i}=b,{setProps:j,setOpen:k,setComponent:l}=c,m=async b=>{let c=async a=>{let{dialog:c,...d}=b;return await n(d)},{productId:d,entityId:e,entityData:f}=b,i=await a.check({productId:d,entityId:e,entityData:f,withPreview:"formatted"});if(i.error)return i;let j=i.data.preview;return j?(g({preview:j}),h(!0),i):await c()},n=async b=>{let{productId:c,entityId:d,options:g,successUrl:j,forceCheckout:k,metadata:l,dialog:n,callback:o,entityData:p}=b;if(n)return i(n),await m(b);let q=await a.attach({productId:c,entityId:d,successUrl:j,forceCheckout:k,metadata:l,options:g,dialog:n,callback:o,entityData:p});if(q.error)return q;let r=q.data;r?.checkout_url&&"undefined"!=typeof window&&window.open(r.checkout_url,"_blank");try{await o?.()}catch(a){return q}return await Promise.all([e.pricingTableProducts?e.refetch().catch(a=>{console.warn("Failed to refetch pricing table data"),console.warn(a)}):Promise.resolve(),f.refetchFirstTwo()]),h&&h(!1),q};return{attach:n,check:async b=>{let{dialog:c,withPreview:d}=b;c&&l(c);let e=await a.check({...b,withPreview:d||c?"formatted":void 0});if(e.error)return e;let f=e.data;return f&&f.preview&&c&&(j({preview:f.preview}),k(!0)),e},track:async b=>{let c=await a.track(b);return c.error,c},cancel:async({productId:b,entityId:c})=>{let d=await a.cancel({productId:b,entityId:c});return d.error,d},openBillingPortal:async b=>{let c=await a.openBillingPortal(b);if(c.error)return c;let d=c.data;return d?.url&&"undefined"!=typeof window&&window.open(d.url,"_blank"),c}}}},681220:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({useCustomer:()=>f});var d=a.i(7007),e=a.i(722851),f=a=>{let{customerProvider:b,client:c}=(0,d.useAutumnContext)(),{getState:f,refetch:g}=b,{customer:h,isLoading:i,error:j}=f(a);return(0,e.useEffect)(()=>{h||g({params:a})},[]),{customer:h,isLoading:i&&!h,error:j,refetch:async()=>{await g({params:a})},createEntity:c.entities.create}}},762711:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({compareParams:()=>d});var d=(a,b)=>{if(a===b)return!0;if(null===a||null===b||"object"!=typeof a||"object"!=typeof b)return!1;if(Array.isArray(a)&&Array.isArray(b))return a.length===b.length&&a.every((a,c)=>d(a,b[c]));let c=Object.keys(a),e=Object.keys(b);return c.length===e.length&&c.every(c=>!!Object.prototype.hasOwnProperty.call(b,c)&&d(a[c],b[c]))}},785779:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({useEntity:()=>g});var d=a.i(762711),e=a.i(7007),f=a.i(722851),g=(a,b)=>{let{entityProvider:c}=(0,e.useAutumnContext)(),{entity:g,isLoading:h,error:i,refetch:j,lastParams:k}=c;return(0,f.useEffect)(()=>{a===g?.id&&(0,d.compareParams)(b,k)||j({entityId:a,params:b})},[a]),{entity:g,isLoading:h&&!g,error:i,refetch:async b=>{await j({entityId:a,params:b})}}}},35335:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({usePricingTable:()=>g});var d=a.i(7007),e=a.i(722851),f=(a,b)=>{if(!a)return null;if(!b)return a;let c=structuredClone(a);for(let a of b){let b=c.findIndex(b=>b.id===a.id);if(-1==b){console.warn(`Product with id ${a.id} not found`);continue}c[b]={...c[b],...a}}return c},g=a=>{let{pricingTableProvider:b}=(0,d.useAutumnContext)(),{pricingTableProducts:c,isLoading:g,error:h,refetch:i}=b;return(0,e.useEffect)(()=>{c||i()},[c]),{products:f(c||void 0,a?.productDetails),isLoading:g&&!c,error:h,refetch:i}}},417253:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({usePricingTableProvider:()=>f});var d=a.i(207994),e=a.i(722851),f=({client:a})=>{let[b,c]=(0,e.useState)(null),[f,g]=(0,e.useState)(!0),[h,i]=(0,e.useState)(null);return{pricingTableProducts:b,isLoading:f&&!b,error:h,refetch:async()=>{try{g(!0);let{data:b,error:d}=await a.getPricingTable();d?(i(d),c(null)):(c(b?.list||[]),i(null))}catch(a){i(new d.AutumnError({message:"Failed to fetch pricing table products",code:"failed_to_fetch_pricing_table_products"})),c(null)}finally{g(!1)}}}}},390275:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({useCustomerProvider:()=>e});var d=a.i(722851);function e(a){let[b,c]=(0,d.useState)({}),e=(0,d.useRef)({}),f=a=>JSON.stringify(a||{}),g=async({params:b,errorOnNotFound:d=!0})=>{let g=f(b);if(e.current[g])return;e.current[g]=!0,c(a=>({...a,[g]:{...a[g]||{customer:null},isLoading:!0,error:null}}));let{data:h,error:i}=await a.createCustomer({expand:b?.expand,errorOnNotFound:d}),j={customer:h,isLoading:!1,error:i};c(a=>({...a,[g]:j})),e.current[g]=!1},h=async()=>{try{let a=[];for(let c of Object.keys(b))a.push(g({params:JSON.parse(c)}));await Promise.all(a)}catch(a){console.error("Failed to refetch customer (useCustomerProvider)"),console.error(a)}};return{getState:a=>{let c=f(a);return b[c]?b[c]:{customer:null,isLoading:!0,error:null}},refetch:g,refetchFirstTwo:h}}},56570:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({useDialog:()=>e});var d=a.i(722851),e=a=>{let[b,c]=(0,d.useState)(null),[e,f]=(0,d.useState)(!1);return(0,d.useEffect)(()=>{e||setTimeout(()=>{c(null)},200)},[e]),[b,c,e,f]}},544290:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({useEntityProvider:()=>f});var d=a.i(207994),e=a.i(722851),f=({client:a})=>{let[b,c]=(0,e.useState)(null),[f,g]=(0,e.useState)(null),[h,i]=(0,e.useState)(!0),[j,k]=(0,e.useState)(null);return{entity:b,isLoading:h,error:f,refetch:async({entityId:b,params:e})=>{if(!b)return void console.warn("(Autumn) No entity ID provided in useEntity hook");i(!0),k(e||null);try{let{data:d,error:f}=await a.entities.get(b,e);f?(g(f),c(null)):(c(d),g(null))}catch(a){g(new d.AutumnError({message:a?.message||"Failed to fetch entity",code:"entity_fetch_failed"}))}i(!1)},lastParams:j}}},932405:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({BaseAutumnProvider:()=>k});var d=a.i(417253),e=a.i(390275),f=a.i(56570),g=a.i(544290),h=a.i(7007),i=a.i(722851),j=a.i(674420);function k({client:a,children:b}){let[c,k]=(0,i.useState)({}),[l,m,n,o]=(0,f.useDialog)(c.paywallDialog),[p,q,r,s]=(0,f.useDialog)(c.productChangeDialog),t=(0,e.useCustomerProvider)(a),u=(0,g.useEntityProvider)({client:a}),{pricingTableProducts:v,isLoading:w,error:x,refetch:y}=(0,d.usePricingTableProvider)({client:a});return(0,i.useEffect)(()=>{t.refetch({errorOnNotFound:!1})},[]),(0,j.jsxs)(h.AutumnContext.Provider,{value:{customerProvider:t,entityProvider:u,pricingTableProvider:{pricingTableProducts:v,isLoading:w,error:x,refetch:y},client:a,paywallDialog:{props:l,setProps:m,open:n,setOpen:o,setComponent:a=>{k({...c,paywallDialog:a})}},prodChangeDialog:{props:p,setProps:q,open:r,setOpen:s,setComponent:a=>{k({...c,productChangeDialog:a})}}},children:[c.paywallDialog&&(0,j.jsx)(c.paywallDialog,{open:n,setOpen:o,...l}),c.productChangeDialog&&(0,j.jsx)(c.productChangeDialog,{open:r,setOpen:s,...p}),b]})}},56605:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({ReactAutumnProvider:()=>g});var d=a.i(932405),e=a.i(803846),f=a.i(674420),g=({children:a,getBearerToken:b,backendUrl:c,customerData:g,includeCredentials:h=!0})=>{let i=new e.AutumnClient({backendUrl:c,getBearerToken:b,customerData:g,includeCredentials:h});return(0,f.jsx)(d.BaseAutumnProvider,{client:i,children:a})}},380367:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({}),a.i(805175),a.i(681220),a.i(785779),a.i(762711),a.i(35335),a.i(56605),a.i(932405),a.i(417253),a.i(390275),a.i(56570),a.i(544290),a.i(7007),a.i(803846),a.i(617836),a.i(207994),a.i(728423),a.i(154343),a.i(882496),a.i(756566)},779128:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({}),a.i(805175),a.i(681220),a.i(785779),a.i(762711),a.i(35335),a.i(56605),a.i(932405),a.i(417253),a.i(390275),a.i(56570),a.i(544290),a.i(7007),a.i(803846),a.i(617836),a.i(207994),a.i(728423),a.i(154343),a.i(882496),a.i(756566),a.i(380367)}};

//# sourceMappingURL=node_modules_autumn-js_dist_libraries_react_84d8ca5c._.js.map