module.exports={326764:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({stripeClient:()=>b});let b=a=>({id:"stripe-client",$InferServerPlugin:{},pathMethods:{"/subscription/restore":"POST"}})}},552411:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({BetterFetchError:()=>m,ValidationError:()=>I,applySchemaPlugin:()=>M,betterFetch:()=>O,bodyParser:()=>H,createFetch:()=>N,createRetryStrategy:()=>q,createSchema:()=>L,detectContentType:()=>D,detectResponseType:()=>t,getBody:()=>E,getFetch:()=>y,getHeaders:()=>B,getMethod:()=>F,getTimeout:()=>G,getURL:()=>C,initializePlugins:()=>n,isFunction:()=>x,isJSONParsable:()=>u,isJSONSerializable:()=>v,isPayloadMethod:()=>z,isRouteMethod:()=>A,jsonParse:()=>w,methods:()=>K,parseStandardSchema:()=>J});var d=Object.defineProperty,e=Object.defineProperties,f=Object.getOwnPropertyDescriptors,g=Object.getOwnPropertySymbols,h=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,j=(a,b,c)=>b in a?d(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,k=(a,b)=>{for(var c in b||(b={}))h.call(b,c)&&j(a,c,b[c]);if(g)for(var c of g(b))i.call(b,c)&&j(a,c,b[c]);return a},l=(a,b)=>e(a,f(b)),m=class extends Error{constructor(a,b,c){super(b||a.toString(),{cause:c}),this.status=a,this.statusText=b,this.error=c}},n=async(a,b)=>{var c,d,e,f,g,h;let i=b||{},j={onRequest:[null==b?void 0:b.onRequest],onResponse:[null==b?void 0:b.onResponse],onSuccess:[null==b?void 0:b.onSuccess],onError:[null==b?void 0:b.onError],onRetry:[null==b?void 0:b.onRetry]};if(!b||!(null==b?void 0:b.plugins))return{url:a,options:i,hooks:j};for(let k of(null==b?void 0:b.plugins)||[]){if(k.init){let d=await (null==(c=k.init)?void 0:c.call(k,a.toString(),b));i=d.options||i,a=d.url}j.onRequest.push(null==(d=k.hooks)?void 0:d.onRequest),j.onResponse.push(null==(e=k.hooks)?void 0:e.onResponse),j.onSuccess.push(null==(f=k.hooks)?void 0:f.onSuccess),j.onError.push(null==(g=k.hooks)?void 0:g.onError),j.onRetry.push(null==(h=k.hooks)?void 0:h.onRetry)}return{url:a,options:i,hooks:j}},o=class{constructor(a){this.options=a}shouldAttemptRetry(a,b){return this.options.shouldRetry?Promise.resolve(a<this.options.attempts&&this.options.shouldRetry(b)):Promise.resolve(a<this.options.attempts)}getDelay(){return this.options.delay}},p=class{constructor(a){this.options=a}shouldAttemptRetry(a,b){return this.options.shouldRetry?Promise.resolve(a<this.options.attempts&&this.options.shouldRetry(b)):Promise.resolve(a<this.options.attempts)}getDelay(a){return Math.min(this.options.maxDelay,this.options.baseDelay*2**a)}};function q(a){if("number"==typeof a)return new o({type:"linear",attempts:a,delay:1e3});switch(a.type){case"linear":return new o(a);case"exponential":return new p(a);default:throw Error("Invalid retry strategy")}}var r=async a=>{let b={},c=async a=>"function"==typeof a?await a():a;if(null==a?void 0:a.auth){if("Bearer"===a.auth.type){let d=await c(a.auth.token);if(!d)return b;b.authorization=`Bearer ${d}`}else if("Basic"===a.auth.type){let d=c(a.auth.username),e=c(a.auth.password);if(!d||!e)return b;b.authorization=`Basic ${btoa(`${d}:${e}`)}`}else if("Custom"===a.auth.type){let d=c(a.auth.value);if(!d)return b;b.authorization=`${c(a.auth.prefix)} ${d}`}}return b},s=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function t(a){let b=a.headers.get("content-type"),c=new Set(["image/svg","application/xml","application/xhtml","application/html"]);if(!b)return"json";let d=b.split(";").shift()||"";return s.test(d)?"json":c.has(d)||d.startsWith("text/")?"text":"blob"}function u(a){try{return JSON.parse(a),!0}catch(a){return!1}}function v(a){if(void 0===a)return!1;let b=typeof a;return"string"===b||"number"===b||"boolean"===b||null===b||"object"===b&&(!!Array.isArray(a)||!a.buffer&&(a.constructor&&"Object"===a.constructor.name||"function"==typeof a.toJSON))}function w(a){try{return JSON.parse(a)}catch(b){return a}}function x(a){return"function"==typeof a}function y(a){if(null==a?void 0:a.customFetchImpl)return a.customFetchImpl;if("undefined"!=typeof globalThis&&x(globalThis.fetch))return globalThis.fetch;if("undefined"!=typeof window&&x(window.fetch))return window.fetch;throw Error("No fetch implementation found")}function z(a){return!!a&&["POST","PUT","PATCH","DELETE"].includes(a.toUpperCase())}function A(a){return!!a&&["GET","POST","PUT","PATCH","DELETE"].includes(a.toUpperCase())}async function B(a){let b=new Headers(null==a?void 0:a.headers);for(let[c,d]of Object.entries(await r(a)||{}))b.set(c,d);if(!b.has("content-type")){let c=D(null==a?void 0:a.body);c&&b.set("content-type",c)}return b}function C(a,b){let c;if(a.startsWith("@")){let b=a.toString().split("@")[1].split("/")[0];K.includes(b)&&(a=a.replace(`@${b}/`,"/"))}try{if(a.startsWith("http"))c=a;else{let d=null==b?void 0:b.baseURL;!d||(null==d?void 0:d.endsWith("/"))||(d+="/"),c=a.startsWith("/")?new URL(a.substring(1),d):new URL(a,null==b?void 0:b.baseURL)}}catch(c){if(c instanceof TypeError){if(!(null==b?void 0:b.baseURL))throw TypeError(`Invalid URL ${a}. Are you passing in a relative url but not setting the baseURL?`);throw TypeError(`Invalid URL ${a}. Please validate that you are passing the correct input.`)}throw c}if(null==b?void 0:b.params)if(Array.isArray(null==b?void 0:b.params)){let a=(null==b?void 0:b.params)?Array.isArray(b.params)?`/${b.params.join("/")}`:`/${Object.values(b.params).join("/")}`:"";c=c.toString().split("/:")[0],c=`${c.toString()}${a}`}else for(let[a,d]of Object.entries(null==b?void 0:b.params))c=c.toString().replace(`:${a}`,String(d));let d=new URL(c),e=null==b?void 0:b.query;if(e)for(let[a,b]of Object.entries(e))d.searchParams.append(a,String(b));return d}function D(a){return v(a)?"application/json":null}function E(a){if(!(null==a?void 0:a.body))return null;let b=new Headers(null==a?void 0:a.headers);if(v(a.body)&&!b.has("content-type")){for(let[b,c]of Object.entries(null==a?void 0:a.body))c instanceof Date&&(a.body[b]=c.toISOString());return JSON.stringify(a.body)}return a.body}function F(a,b){var c;if(null==b?void 0:b.method)return b.method.toUpperCase();if(a.startsWith("@")){let d=null==(c=a.split("@")[1])?void 0:c.split("/")[0];return K.includes(d)?d.toUpperCase():(null==b?void 0:b.body)?"POST":"GET"}return(null==b?void 0:b.body)?"POST":"GET"}function G(a,b){let c;return!(null==a?void 0:a.signal)&&(null==a?void 0:a.timeout)&&(c=setTimeout(()=>null==b?void 0:b.abort(),null==a?void 0:a.timeout)),{abortTimeout:c,clearTimeout:()=>{c&&clearTimeout(c)}}}function H(a,b){return"json"===b?JSON.parse(a):a}var I=class a extends Error{constructor(b,c){super(c||JSON.stringify(b,null,2)),this.issues=b,Object.setPrototypeOf(this,a.prototype)}};async function J(a,b){let c=await a["~standard"].validate(b);if(c.issues)throw new I(c.issues);return c.value}var K=["get","post","put","patch","delete"],L=(a,b)=>({schema:a,config:b}),M=a=>({id:"apply-schema",name:"Apply Schema",version:"1.0.0",async init(b,c){var d,e,f,g;let h=(null==(e=null==(d=a.plugins)?void 0:d.find(a=>{var c;return null!=(c=a.schema)&&!!c.config&&(b.startsWith(a.schema.config.baseURL||"")||b.startsWith(a.schema.config.prefix||""))}))?void 0:e.schema)||a.schema;if(h){let a=b;(null==(f=h.config)?void 0:f.prefix)&&a.startsWith(h.config.prefix)&&(a=a.replace(h.config.prefix,""),h.config.baseURL&&(b=b.replace(h.config.prefix,h.config.baseURL))),(null==(g=h.config)?void 0:g.baseURL)&&a.startsWith(h.config.baseURL)&&(a=a.replace(h.config.baseURL,""));let d=h.schema[a];if(d){let a=l(k({},c),{method:d.method,output:d.output});return(null==c?void 0:c.disableValidation)||(a=l(k({},a),{body:d.input?await J(d.input,null==c?void 0:c.body):null==c?void 0:c.body,params:d.params?await J(d.params,null==c?void 0:c.params):null==c?void 0:c.params,query:d.query?await J(d.query,null==c?void 0:c.query):null==c?void 0:c.query})),{url:b,options:a}}}return{url:b,options:c}}}),N=a=>async function(b,c){let d=l(k(k({},a),c),{plugins:[...(null==a?void 0:a.plugins)||[],M(a||{})]});if(null==a?void 0:a.catchAllError)try{return await O(b,d)}catch(a){return{data:null,error:{status:500,statusText:"Fetch Error",message:"Fetch related error. Captured by catchAllError option. See error property for more details.",error:a}}}return await O(b,d)},O=async(a,b)=>{var c,d,e,f,g,h,i,j;let{hooks:o,url:p,options:r}=await n(a,b),s=y(r),v=new AbortController,x=null!=(c=r.signal)?c:v.signal,z=function(a,b){let{baseURL:c,params:d,query:e}=b||{query:{},params:{},baseURL:""},f=a.startsWith("http")?a.split("/").slice(0,3).join("/"):c||"";if(a.startsWith("@")){let b=a.toString().split("@")[1].split("/")[0];K.includes(b)&&(a=a.replace(`@${b}/`,"/"))}f.endsWith("/")||(f+="/");let[g,h]=a.replace(f,"").split("?"),i=new URLSearchParams(h);for(let[a,b]of Object.entries(e||{}))null!=b&&i.set(a,String(b));if(d)if(Array.isArray(d))for(let[a,b]of g.split("/").filter(a=>a.startsWith(":")).entries()){let c=d[a];g=g.replace(b,c)}else for(let[a,b]of Object.entries(d))g=g.replace(`:${a}`,String(b));(g=g.split("/").map(encodeURIComponent).join("/")).startsWith("/")&&(g=g.slice(1));let j=i.toString();return(j=j.length>0?`?${j}`.replace(/\+/g,"%20"):"",f.startsWith("http"))?new URL(`${g}${j}`,f):`${f}${g}${j}`}(p,r),A=E(r),C=await B(r),D=F(p,r),H=l(k({},r),{url:z,headers:C,body:A,method:D,signal:x});for(let a of o.onRequest)if(a){let b=await a(H);b instanceof Object&&(H=b)}("pipeTo"in H&&"function"==typeof H.pipeTo||"function"==typeof(null==(d=null==b?void 0:b.body)?void 0:d.pipe))&&!("duplex"in H)&&(H.duplex="half");let{clearTimeout:I}=G(r,v),L=await s(H.url,H);I();let M={response:L,request:H};for(let a of o.onResponse)if(a){let c=await a(l(k({},M),{response:(null==(e=null==b?void 0:b.hookOptions)?void 0:e.cloneResponse)?L.clone():L}));c instanceof Response?L=c:c instanceof Object&&(L=c.response)}if(L.ok){if("HEAD"===H.method)return{data:"",error:null};let a=t(L),c={data:"",response:L,request:H};if("json"===a||"text"===a){let a=await L.text(),b=null!=(f=H.jsonParser)?f:w;c.data=await b(a)}else c.data=await L[a]();for(let a of((null==H?void 0:H.output)&&H.output&&!H.disableValidation&&(c.data=await J(H.output,c.data)),o.onSuccess))a&&await a(l(k({},c),{response:(null==(g=null==b?void 0:b.hookOptions)?void 0:g.cloneResponse)?L.clone():L}));return(null==b?void 0:b.throw)?c.data:{data:c.data,error:null}}let N=null!=(h=null==b?void 0:b.jsonParser)?h:w,P=await L.text(),Q=u(P),R=Q?await N(P):null,S={response:L,responseText:P,request:H,error:l(k({},R),{status:L.status,statusText:L.statusText})};for(let a of o.onError)a&&await a(l(k({},S),{response:(null==(i=null==b?void 0:b.hookOptions)?void 0:i.cloneResponse)?L.clone():L}));if(null==b?void 0:b.retry){let c=q(b.retry),d=null!=(j=b.retryAttempt)?j:0;if(await c.shouldAttemptRetry(d,L)){for(let a of o.onRetry)a&&await a(M);let e=c.getDelay(d);return await new Promise(a=>setTimeout(a,e)),await O(a,l(k({},b),{retryAttempt:d+1}))}}if(null==b?void 0:b.throw)throw new m(L.status,L.statusText,Q?R:P);return{data:null,error:l(k({},R),{status:L.status,statusText:L.statusText})}}},581502:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({a:()=>f,b:()=>g,e:()=>d,i:()=>h});let b=Object.create(null),c=a=>globalThis.process?.env||globalThis.Deno?.env.toObject()||globalThis.__env__||(a?b:globalThis),d=new Proxy(b,{get:(a,d)=>c()[d]??b[d],has:(a,d)=>d in c()||d in b,set:(a,b,d)=>(c(!0)[b]=d,!0),deleteProperty(a,b){if(!b)return!1;let d=c(!0);return delete d[b],!0},ownKeys:()=>Object.keys(c(!0))}),e="undefined"!=typeof process&&process.env&&"production"||"",f="production"===e,g="dev"===e||"development"===e,h="test"===e||function(a){return!!a&&"false"!==a}(d.TEST)}},54920:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({B:()=>b,M:()=>c});class b extends Error{constructor(a,b){super(a),this.name="BetterAuthError",this.message=a,this.cause=b,this.stack=""}}class c extends b{constructor(a){super(`The package "${a}" is required. Make sure it is installed.`,a)}}}},938479:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({a:()=>g,b:()=>j,c:()=>i,g:()=>h});var d=a.i(581502),e=a.i(54920);function f(a,b="/api/auth"){return!function(a){try{let b=new URL(a);return"/"!==b.pathname}catch(b){throw new e.B(`Invalid base URL: ${a}. Please provide a valid base URL.`)}}(a)?(b=b.startsWith("/")?b:`/${b}`,`${a.replace(/\/+$/,"")}${b}`):a}function g(a,b,c){if(a)return f(a,b);let g=d.e.BETTER_AUTH_URL||d.e.NEXT_PUBLIC_BETTER_AUTH_URL||d.e.PUBLIC_BETTER_AUTH_URL||d.e.NUXT_PUBLIC_BETTER_AUTH_URL||d.e.NUXT_PUBLIC_AUTH_URL||("/"!==d.e.BASE_URL?d.e.BASE_URL:void 0);if(g)return f(g,b);let i=c?.headers.get("x-forwarded-host"),j=c?.headers.get("x-forwarded-proto");if(i&&j)return f(`${j}://${i}`,b);if(c){let a=h(c.url);if(!a)throw new e.B("Could not get origin from request. Please provide a valid base URL.");return f(a,b)}if("undefined"!=typeof window&&window.location)return f(window.location.origin,b)}function h(a){try{return new URL(a).origin}catch(a){return null}}function i(a){try{return new URL(a).protocol}catch(a){return null}}function j(a){try{return new URL(a).host}catch(b){return a}}},38881:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({atom:()=>e,epoch:()=>d});let b=[],c=0,d=0,e=a=>{let e=[],f={get:()=>(f.lc||f.listen(()=>{})(),f.value),lc:0,listen:a=>(f.lc=e.push(a),()=>{for(let d=c+4;d<b.length;)b[d]===a?b.splice(d,4):d+=4;let d=e.indexOf(a);~d&&(e.splice(d,1),--f.lc||f.off())}),notify(a,g){d++;let h=!b.length;for(let c of e)b.push(c,f.value,a,g);if(h){for(c=0;c<b.length;c+=4)b[c](b[c+1],b[c+2],b[c+3]);b.length=0}},off(){},set(a){let b=f.value;b!==a&&(f.value=a,f.notify(b))},subscribe(a){let b=f.listen(a);return a(f.value),b},value:a};return f}}},877172:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({STORE_UNMOUNT_DELAY:()=>g,on:()=>b,onMount:()=>h,onNotify:()=>f,onSet:()=>e,onStart:()=>c,onStop:()=>d});let b=(a,b,c,d)=>(a.events=a.events||{},a.events[c+10]||(a.events[c+10]=d(b=>{a.events[c].reduceRight((a,b)=>(b(a),a),{shared:{},...b})})),a.events[c]=a.events[c]||[],a.events[c].push(b),()=>{let d=a.events[c],e=d.indexOf(b);d.splice(e,1),d.length||(delete a.events[c],a.events[c+10](),delete a.events[c+10])}),c=(a,c)=>b(a,c,0,b=>{let c=a.listen;return a.listen=d=>(a.lc||a.starting||(a.starting=!0,b(),delete a.starting),c(d)),()=>{a.listen=c}}),d=(a,c)=>b(a,c,1,b=>{let c=a.off;return a.off=()=>{b(),c()},()=>{a.off=c}}),e=(a,c)=>b(a,c,2,b=>{let c=a.set,d=a.setKey;return a.setKey&&(a.setKey=(c,e)=>{let f;if(b({abort:()=>{f=!0},changed:c,newValue:{...a.value,[c]:e}}),!f)return d(c,e)}),a.set=a=>{let d;if(b({abort:()=>{d=!0},newValue:a}),!d)return c(a)},()=>{a.set=c,a.setKey=d}}),f=(a,c)=>b(a,c,3,b=>{let c=a.notify;return a.notify=(a,d)=>{let e;if(b({abort:()=>{e=!0},changed:d,oldValue:a}),!e)return c(a,d)},()=>{a.notify=c}}),g=1e3,h=(a,c)=>b(a,b=>{let d=c(b);d&&a.events[6].push(d)},5,b=>{let c=a.listen;a.listen=(...d)=>(a.lc||a.active||(a.active=!0,b()),c(...d));let d=a.off;return a.events[6]=[],a.off=()=>{d(),setTimeout(()=>{if(a.active&&!a.lc){for(let b of(a.active=!1,a.events[6]))b();a.events[6]=[]}},g)},()=>{a.listen=c,a.off=d}})}},474192:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({u:()=>b});var d=a.i(38881),e=a.i(877172);let b=(a,b,c,f)=>{let g=(0,d.atom)({data:null,error:null,isPending:!0,isRefetching:!1,refetch:()=>h()}),h=()=>{let a="function"==typeof f?f({data:g.get().data,error:g.get().error,isPending:g.get().isPending}):f;return c(b,{...a,async onSuccess(b){"undefined"!=typeof window&&g.set({data:b.data,error:null,isPending:!1,isRefetching:!1,refetch:g.value.refetch}),await a?.onSuccess?.(b)},async onError(b){let{request:c}=b,d="number"==typeof c.retry?c.retry:c.retry?.attempts,e=c.retryAttempt||0;d&&e<d||(g.set({error:b.error,data:null,isPending:!1,isRefetching:!1,refetch:g.value.refetch}),await a?.onError?.(b))},async onRequest(b){let c=g.get();g.set({isPending:null===c.data,data:c.data,error:null,isRefetching:!0,refetch:g.value.refetch}),await a?.onRequest?.(b)}})};a=Array.isArray(a)?a:[a];let i=!1;for(let b of a)b.subscribe(()=>{i?h():(0,e.onMount)(g,()=>(h(),i=!0,()=>{g.off(),b.off()}))});return g}}},139509:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({p:()=>d});let b={proto:/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,constructor:/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,protoShort:/"__proto__"\s*:/,constructorShort:/"constructor"\s*:/},c=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/,e={true:!0,false:!1,null:null,undefined:void 0,nan:Number.NaN,infinity:Number.POSITIVE_INFINITY,"-infinity":Number.NEGATIVE_INFINITY},f=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:\.(\d{1,7}))?(?:Z|([+-])(\d{2}):(\d{2}))$/;function d(a,g={strict:!0}){return function(a,d={}){let{strict:g=!1,warnings:h=!1,reviver:i,parseDates:j=!0}=d;if("string"!=typeof a)return a;let k=a.trim();if('"'===k[0]&&k.endsWith('"')&&!k.slice(1,-1).includes('"'))return k.slice(1,-1);let l=k.toLowerCase();if(l.length<=9&&l in e)return e[l];if(!c.test(k)){if(g)throw SyntaxError("[better-json] Invalid JSON");return a}if(Object.entries(b).some(([a,b])=>{let c=b.test(k);return c&&h&&console.warn(`[better-json] Detected potential prototype pollution attempt using ${a} pattern`),c})&&g)throw Error("[better-json] Potential prototype pollution attempt detected");try{return JSON.parse(k,(a,b)=>{if("__proto__"===a||"constructor"===a&&b&&"object"==typeof b&&"prototype"in b){h&&console.warn(`[better-json] Dropping "${a}" key to prevent prototype pollution`);return}if(j&&"string"==typeof b){let a=function(a){let b=f.exec(a);if(!b)return null;let[,c,d,e,g,h,i,j,k,l,m]=b,n=new Date(Date.UTC(parseInt(c,10),parseInt(d,10)-1,parseInt(e,10),parseInt(g,10),parseInt(h,10),parseInt(i,10),j?parseInt(j.padEnd(3,"0"),10):0));if(k){let a=(60*parseInt(l,10)+parseInt(m,10))*("+"===k?-1:1);n.setUTCMinutes(n.getUTCMinutes()+a)}return n instanceof Date&&!isNaN(n.getTime())?n:null}(b);if(a)return a}return i?i(a,b):b})}catch(b){if(g)throw b;return a}}(a,g)}}},386259:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({c:()=>i,g:()=>c});var d=a.i(552411),e=a.i(938479),f=a.i(38881),g=a.i(474192),h=a.i(139509);let b={id:"redirect",name:"Redirect",hooks:{onSuccess(a){if(a.data?.url&&a.data?.redirect&&"undefined"!=typeof window&&window.location&&window.location)try{window.location.href=a.data.url}catch{}}}},c=a=>{let c="credentials"in Request.prototype,i=(0,e.a)(a?.baseURL,a?.basePath),j=a?.plugins?.flatMap(a=>a.fetchPlugins).filter(a=>void 0!==a)||[],k=(0,d.createFetch)({baseURL:i,...c?{credentials:"include"}:{},method:"GET",jsonParser:a=>a?(0,h.p)(a,{strict:!1}):null,customFetchImpl:async(a,b)=>{try{return await fetch(a,b)}catch(a){return Response.error()}},...a?.fetchOptions,plugins:a?.disableDefaultFetchPlugins?[...a?.fetchOptions?.plugins||[],...j]:[b,...a?.fetchOptions?.plugins||[],...j]}),{$sessionSignal:l,session:m}=function(a){let b=(0,f.atom)(!1);return{session:(0,g.u)(b,"/get-session",a,{method:"GET"}),$sessionSignal:b}}(k),n=a?.plugins||[],o={},p={$sessionSignal:l,session:m},q={"/sign-out":"POST","/revoke-sessions":"POST","/revoke-other-sessions":"POST","/delete-user":"POST"},r=[{signal:"$sessionSignal",matcher:a=>"/sign-out"===a||"/update-user"===a||a.startsWith("/sign-in")||a.startsWith("/sign-up")||"/delete-user"===a||"/verify-email"===a}];for(let a of n)a.getAtoms&&Object.assign(p,a.getAtoms?.(k)),a.pathMethods&&Object.assign(q,a.pathMethods),a.atomListeners&&r.push(...a.atomListeners);let s={notify:a=>{p[a].set(!p[a].get())},listen:(a,b)=>{p[a].subscribe(b)},atoms:p};for(let b of n)b.getActions&&Object.assign(o,b.getActions?.(k,s,a));return{pluginsActions:o,pluginsAtoms:p,pluginPathMethods:q,atomListeners:r,$fetch:k,$store:s}};function i(a,b,c,d,e){return function f(g=[]){return new Proxy(function(){},{get(b,c){let d=[...g,c],e=a;for(let a of d)if(e&&"object"==typeof e&&a in e)e=e[a];else{e=void 0;break}return"function"==typeof e?e:f(d)},apply:async(a,f,h)=>{let i="/"+g.map(a=>a.replace(/[A-Z]/g,a=>`-${a.toLowerCase()}`)).join("/"),j=h[0]||{},k=h[1]||{},{query:l,fetchOptions:m,...n}=j,o={...k,...m},p=function(a,b,c){let d=b[a],{fetchOptions:e,query:f,...g}=c||{};return d||(e?.method?e.method:g&&Object.keys(g).length>0?"POST":"GET")}(i,c,j);return await b(i,{...o,body:"GET"===p?void 0:{...n,...o?.body||{}},query:l||o?.query,method:p,async onSuccess(a){await o?.onSuccess?.(a);let b=e?.find(a=>a.matcher(i));if(!b)return;let c=d[b.signal];if(!c)return;let f=c.get();setTimeout(()=>{c.set(!f)},10)}})}})}()}}},668423:a=>{"use strict";var{g:b,__dirname:c}=a;function d(a,b,c){let d=new Set(b).add(void 0);return a.listen((a,b,e)=>{d.has(e)&&c(a,b,e)})}function e(a,b,c){let e=d(a,b,c);return c(a.value),e}a.s({listenKeys:()=>d,subscribeKeys:()=>e})},800855:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({capitalizeFirstLetter:()=>h,createAuthClient:()=>i,useStore:()=>g});var d=a.i(386259),e=a.i(668423),f=a.i(722851);function g(a,b={}){let c=(0,f.useRef)(a.get()),{keys:d,deps:h=[a,d]}=b,i=(0,f.useCallback)(b=>{let f=a=>{c.current!==a&&(c.current=a,b())};return(f(a.value),d?.length)?(0,e.listenKeys)(a,d,f):a.listen(f)},h),j=()=>c.current;return(0,f.useSyncExternalStore)(i,j,j)}function h(a){return a.charAt(0).toUpperCase()+a.slice(1)}function i(a){let{pluginPathMethods:b,pluginsActions:c,pluginsAtoms:e,$fetch:f,$store:i,atomListeners:j}=(0,d.g)(a),k={};for(let[a,b]of Object.entries(e))k[`use${h(a)}`]=()=>g(b);let l={...c,...k,$fetch:f,$store:i};return(0,d.c)(l,f,b,e,j)}a.i(552411),a.i(938479),a.i(581502),a.i(54920),a.i(474192),a.i(139509)},110331:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({createAccessControl:()=>f,role:()=>e});var d=a.i(54920);function e(a){return{authorize(b,c="AND"){let e=!1;for(let[f,g]of Object.entries(b)){let b=a[f];if(!b)return{success:!1,error:`You are not allowed to access resource: ${f}`};if(Array.isArray(g))e=g.every(a=>b.includes(a));else if("object"==typeof g)e="OR"===g.connector?g.actions.some(a=>b.includes(a)):g.actions.every(a=>b.includes(a));else throw new d.B("Invalid access control request");if(e&&"OR"===c)return{success:e};if(!e&&"AND"===c)return{success:!1,error:`unauthorized to access resource "${f}"`}}return e?{success:e}:{success:!1,error:"Not authorized"}},statements:a}}function f(a){return{newRole:a=>e(a),statements:a}}},289491:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({adminAc:()=>e,defaultAc:()=>c,defaultRoles:()=>h,defaultStatements:()=>b,memberAc:()=>g,ownerAc:()=>f});var d=a.i(110331);a.i(54920);let b={organization:["update","delete"],member:["create","update","delete"],invitation:["create","cancel"],team:["create","update","delete"]},c=(0,d.createAccessControl)(b),e=c.newRole({organization:["update"],invitation:["create","cancel"],member:["create","update","delete"],team:["create","update","delete"]}),f=c.newRole({organization:["update","delete"],member:["create","update","delete"],invitation:["create","cancel"],team:["create","update","delete"]}),g=c.newRole({organization:[],member:[],invitation:[],team:[]}),h={admin:e,owner:f,member:g}}},19664:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({h:()=>b});var d=a.i(289491);let b=a=>{if(!a.permissions&&!a.permission)return!1;let b=a.role.split(","),c=a.options.roles||d.defaultRoles;for(let d of b){let b=c[d],e=b?.authorize(a.permissions??a.permission);if(e?.success)return!0}return!1}}},948594:a=>{"use strict";var{g:b,__dirname:c}=a;function d(a){let b=new Uint8Array(a),c="";for(let a of b)c+=String.fromCharCode(a);return btoa(c).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}a.s({bufferToBase64URLString:()=>d})},534485:a=>{"use strict";var{g:b,__dirname:c}=a;function d(a){let b=a.replace(/-/g,"+").replace(/_/g,"/"),c=(4-b.length%4)%4,d=atob(b.padEnd(b.length+c,"=")),e=new ArrayBuffer(d.length),f=new Uint8Array(e);for(let a=0;a<d.length;a++)f[a]=d.charCodeAt(a);return e}a.s({base64URLStringToBuffer:()=>d})},159174:a=>{"use strict";var{g:b,__dirname:c}=a;{function d(){return b.stubThis(globalThis?.PublicKeyCredential!==void 0&&"function"==typeof globalThis.PublicKeyCredential)}a.s({_browserSupportsWebAuthnInternals:()=>b,browserSupportsWebAuthn:()=>d});let b={stubThis:a=>a}}},825629:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({toPublicKeyCredentialDescriptor:()=>e});var d=a.i(534485);function e(a){let{id:b}=a;return{...a,id:(0,d.base64URLStringToBuffer)(b),transports:a.transports}}},560055:a=>{"use strict";var{g:b,__dirname:c}=a;function d(a){return"localhost"===a||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(a)}a.s({isValidDomain:()=>d})},691113:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({WebAuthnError:()=>b});class b extends Error{constructor({message:a,code:b,cause:c,name:d}){super(a,{cause:c}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=d??c.name,this.code=b}}}},391116:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({identifyRegistrationError:()=>f});var d=a.i(560055),e=a.i(691113);function f({error:a,options:b}){let{publicKey:c}=b;if(!c)throw Error("options was missing required publicKey property");if("AbortError"===a.name){if(b.signal instanceof AbortSignal)return new e.WebAuthnError({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:a})}else if("ConstraintError"===a.name){if(c.authenticatorSelection?.requireResidentKey===!0)return new e.WebAuthnError({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:a});else if("conditional"===b.mediation&&c.authenticatorSelection?.userVerification==="required")return new e.WebAuthnError({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:a});else if(c.authenticatorSelection?.userVerification==="required")return new e.WebAuthnError({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:a})}else if("InvalidStateError"===a.name)return new e.WebAuthnError({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:a});else if("NotAllowedError"===a.name)return new e.WebAuthnError({message:a.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:a});else if("NotSupportedError"===a.name)return new e.WebAuthnError(0===c.pubKeyCredParams.filter(a=>"public-key"===a.type).length?{message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:a}:{message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:a});else if("SecurityError"===a.name){let b=globalThis.location.hostname;if(!(0,d.isValidDomain)(b))return new e.WebAuthnError({message:`${globalThis.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:a});if(c.rp.id!==b)return new e.WebAuthnError({message:`The RP ID "${c.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:a})}else if("TypeError"===a.name){if(c.user.id.byteLength<1||c.user.id.byteLength>64)return new e.WebAuthnError({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:a})}else if("UnknownError"===a.name)return new e.WebAuthnError({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:a});return a}},482053:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({WebAuthnAbortService:()=>b});let b=new class{constructor(){Object.defineProperty(this,"controller",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}createNewAbortSignal(){if(this.controller){let a=Error("Cancelling existing WebAuthn API call for new one");a.name="AbortError",this.controller.abort(a)}let a=new AbortController;return this.controller=a,a.signal}cancelCeremony(){if(this.controller){let a=Error("Manually cancelling existing WebAuthn API call");a.name="AbortError",this.controller.abort(a),this.controller=void 0}}}}},862043:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({toAuthenticatorAttachment:()=>d});let b=["cross-platform","platform"];function d(a){if(a&&!(0>b.indexOf(a)))return a}}},483765:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({startRegistration:()=>k});var d=a.i(948594),e=a.i(534485),f=a.i(159174),g=a.i(825629),h=a.i(391116),i=a.i(482053),j=a.i(862043);async function k(a){let b,c,k,m,n;!a.optionsJSON&&a.challenge&&(console.warn("startRegistration() was not called correctly. It will try to continue with the provided options, but this call should be refactored to use the expected call structure instead. See https://simplewebauthn.dev/docs/packages/browser#typeerror-cannot-read-properties-of-undefined-reading-challenge for more information."),a={optionsJSON:a});let{optionsJSON:o,useAutoRegister:p=!1}=a;if(!(0,f.browserSupportsWebAuthn)())throw Error("WebAuthn is not supported in this browser");let q={...o,challenge:(0,e.base64URLStringToBuffer)(o.challenge),user:{...o.user,id:(0,e.base64URLStringToBuffer)(o.user.id)},excludeCredentials:o.excludeCredentials?.map(g.toPublicKeyCredentialDescriptor)},r={};p&&(r.mediation="conditional"),r.publicKey=q,r.signal=i.WebAuthnAbortService.createNewAbortSignal();try{b=await navigator.credentials.create(r)}catch(a){throw(0,h.identifyRegistrationError)({error:a,options:r})}if(!b)throw Error("Registration was not completed");let{id:s,rawId:t,response:u,type:v}=b;if("function"==typeof u.getTransports&&(k=u.getTransports()),"function"==typeof u.getPublicKeyAlgorithm)try{m=u.getPublicKeyAlgorithm()}catch(a){l("getPublicKeyAlgorithm()",a)}if("function"==typeof u.getPublicKey)try{let a=u.getPublicKey();null!==a&&(n=(0,d.bufferToBase64URLString)(a))}catch(a){l("getPublicKey()",a)}if("function"==typeof u.getAuthenticatorData)try{c=(0,d.bufferToBase64URLString)(u.getAuthenticatorData())}catch(a){l("getAuthenticatorData()",a)}return{id:s,rawId:(0,d.bufferToBase64URLString)(t),response:{attestationObject:(0,d.bufferToBase64URLString)(u.attestationObject),clientDataJSON:(0,d.bufferToBase64URLString)(u.clientDataJSON),transports:k,publicKeyAlgorithm:m,publicKey:n,authenticatorData:c},type:v,clientExtensionResults:b.getClientExtensionResults(),authenticatorAttachment:(0,j.toAuthenticatorAttachment)(b.authenticatorAttachment)}}function l(a,b){console.warn(`The browser extension that intercepted this WebAuthn API call incorrectly implemented ${a}. You should report this error to them.
`,b)}},818727:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({_browserSupportsWebAuthnAutofillInternals:()=>b,browserSupportsWebAuthnAutofill:()=>e});var d=a.i(159174);function e(){if(!(0,d.browserSupportsWebAuthn)())return b.stubThis(new Promise(a=>a(!1)));let a=globalThis.PublicKeyCredential;return a?.isConditionalMediationAvailable===void 0?b.stubThis(new Promise(a=>a(!1))):b.stubThis(a.isConditionalMediationAvailable())}let b={stubThis:a=>a}}},399959:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({identifyAuthenticationError:()=>f});var d=a.i(560055),e=a.i(691113);function f({error:a,options:b}){let{publicKey:c}=b;if(!c)throw Error("options was missing required publicKey property");if("AbortError"===a.name){if(b.signal instanceof AbortSignal)return new e.WebAuthnError({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:a})}else if("NotAllowedError"===a.name)return new e.WebAuthnError({message:a.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:a});else if("SecurityError"===a.name){let b=globalThis.location.hostname;if(!(0,d.isValidDomain)(b))return new e.WebAuthnError({message:`${globalThis.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:a});if(c.rpId!==b)return new e.WebAuthnError({message:`The RP ID "${c.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:a})}else if("UnknownError"===a.name)return new e.WebAuthnError({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:a});return a}},748990:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({startAuthentication:()=>l});var d=a.i(948594),e=a.i(534485),f=a.i(159174),g=a.i(818727),h=a.i(825629),i=a.i(399959),j=a.i(482053),k=a.i(862043);async function l(a){let b,c,l;!a.optionsJSON&&a.challenge&&(console.warn("startAuthentication() was not called correctly. It will try to continue with the provided options, but this call should be refactored to use the expected call structure instead. See https://simplewebauthn.dev/docs/packages/browser#typeerror-cannot-read-properties-of-undefined-reading-challenge for more information."),a={optionsJSON:a});let{optionsJSON:m,useBrowserAutofill:n=!1,verifyBrowserAutofillInput:o=!0}=a;if(!(0,f.browserSupportsWebAuthn)())throw Error("WebAuthn is not supported in this browser");m.allowCredentials?.length!==0&&(b=m.allowCredentials?.map(h.toPublicKeyCredentialDescriptor));let p={...m,challenge:(0,e.base64URLStringToBuffer)(m.challenge),allowCredentials:b},q={};if(n){if(!await (0,g.browserSupportsWebAuthnAutofill)())throw Error("Browser does not support WebAuthn autofill");if(document.querySelectorAll("input[autocomplete$='webauthn']").length<1&&o)throw Error('No <input> with "webauthn" as the only or last value in its `autocomplete` attribute was detected');q.mediation="conditional",p.allowCredentials=[]}q.publicKey=p,q.signal=j.WebAuthnAbortService.createNewAbortSignal();try{c=await navigator.credentials.get(q)}catch(a){throw(0,i.identifyAuthenticationError)({error:a,options:q})}if(!c)throw Error("Authentication was not completed");let{id:r,rawId:s,response:t,type:u}=c;return t.userHandle&&(l=(0,d.bufferToBase64URLString)(t.userHandle)),{id:r,rawId:(0,d.bufferToBase64URLString)(s),response:{authenticatorData:(0,d.bufferToBase64URLString)(t.authenticatorData),clientDataJSON:(0,d.bufferToBase64URLString)(t.clientDataJSON),signature:(0,d.bufferToBase64URLString)(t.signature),userHandle:l},type:u,clientExtensionResults:c.getClientExtensionResults(),authenticatorAttachment:(0,k.toAuthenticatorAttachment)(c.authenticatorAttachment)}}},127883:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({platformAuthenticatorIsAvailable:()=>e});var d=a.i(159174);function e(){return(0,d.browserSupportsWebAuthn)()?PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable():new Promise(a=>a(!1))}},275147:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({})},676602:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({}),a.i(483765),a.i(748990),a.i(159174),a.i(127883),a.i(818727),a.i(534485),a.i(948594),a.i(482053),a.i(691113),a.i(275147)},73681:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({}),a.i(483765),a.i(748990),a.i(159174),a.i(127883),a.i(818727),a.i(534485),a.i(948594),a.i(482053),a.i(691113),a.i(275147),a.i(676602)},398398:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({t:()=>b});let b=a=>({id:"two-factor",$InferServerPlugin:{},atomListeners:[{matcher:a=>a.startsWith("/two-factor/"),signal:"$sessionSignal"}],pathMethods:{"/two-factor/disable":"POST","/two-factor/enable":"POST","/two-factor/send-otp":"POST","/two-factor/generate-backup-codes":"POST"},fetchPlugins:[{id:"two-factor",name:"two-factor",hooks:{async onSuccess(b){b.data?.twoFactorRedirect&&a?.onTwoFactorRedirect&&await a.onTwoFactorRedirect()}}}]})}},376097:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({adminAc:()=>e,defaultAc:()=>c,defaultRoles:()=>g,defaultStatements:()=>b,userAc:()=>f});var d=a.i(110331);a.i(54920);let b={user:["create","list","set-role","ban","impersonate","delete","set-password"],session:["list","revoke","delete"]},c=(0,d.createAccessControl)(b),e=c.newRole({user:["create","list","set-role","ban","impersonate","delete","set-password"],session:["list","revoke","delete"]}),f=c.newRole({user:[],session:[]}),g={admin:e,user:f}}},593116:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({h:()=>b});var d=a.i(376097);let b=a=>{if(a.userId&&a.options?.adminUserIds?.includes(a.userId))return!0;if(!a.permissions&&!a.permission)return!1;let b=(a.role||a.options?.defaultRole||"user").split(","),c=a.options?.roles||d.defaultRoles;for(let d of b){let b=c[d],e=b?.authorize(a.permission??a.permissions);if(e?.success)return!0}return!1}}},915390:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({InferServerPlugin:()=>B,adminClient:()=>s,anonymousClient:()=>q,apiKeyClient:()=>E,customSessionClient:()=>A,emailOTPClient:()=>w,genericOAuthClient:()=>t,getPasskeyActions:()=>m,inferAdditionalFields:()=>r,jwtClient:()=>u,magicLinkClient:()=>o,multiSessionClient:()=>v,oidcClient:()=>D,oneTapClient:()=>y,oneTimeTokenClient:()=>F,organizationClient:()=>b,passkeyClient:()=>n,phoneNumberClient:()=>p,ssoClient:()=>C,usernameClient:()=>c});var d=a.i(38881);a.i(552411),a.i(581502);var e=a.i(474192),f=a.i(289491),g=a.i(19664);a.i(73681);var h=a.i(483765),i=a.i(691113),j=a.i(748990);a.i(398398);var k=a.i(376097),l=a.i(593116);a.i(110331),a.i(54920);let b=a=>{let b=(0,d.atom)(!1),c=(0,d.atom)(!1),h=(0,d.atom)(!1),i={admin:f.adminAc,member:f.memberAc,owner:f.ownerAc,...a?.roles};return{id:"organization",$InferServerPlugin:{},getActions:b=>({$Infer:{ActiveOrganization:{},Organization:{},Invitation:{},Member:{},Team:{}},organization:{checkRolePermission:b=>(0,g.h)({role:b.role,options:{ac:a?.ac,roles:i},permissions:b.permissions??b.permission})}}),getAtoms:a=>{let d=(0,e.u)(b,"/organization/list",a,{method:"GET"}),f=(0,e.u)([c],"/organization/get-full-organization",a,()=>({method:"GET"})),g=(0,e.u)([h],"/organization/get-active-member",a,{method:"GET"});return{$listOrg:b,$activeOrgSignal:c,$activeMemberSignal:h,activeOrganization:f,listOrganizations:d,activeMember:g}},pathMethods:{"/organization/get-full-organization":"GET"},atomListeners:[{matcher:a=>"/organization/create"===a||"/organization/delete"===a||"/organization/update"===a,signal:"$listOrg"},{matcher:a=>a.startsWith("/organization"),signal:"$activeOrgSignal"},{matcher:a=>a.startsWith("/organization/set-active"),signal:"$sessionSignal"},{matcher:a=>a.includes("/organization/update-member-role"),signal:"$activeMemberSignal"}]}},c=()=>({id:"username",$InferServerPlugin:{}}),m=(a,{$listPasskeys:b})=>({signIn:{passkey:async(b,c)=>{let d=await a("/passkey/generate-authenticate-options",{method:"POST",body:{email:b?.email}});if(!d.data)return d;try{let e=await (0,j.startAuthentication)({optionsJSON:d.data,useBrowserAutofill:b?.autoFill}),f=await a("/passkey/verify-authentication",{body:{response:e},...b?.fetchOptions,...c,method:"POST"});if(!f.data)return f}catch(a){return{data:null,error:{message:"auth cancelled",status:400,statusText:"BAD_REQUEST"}}}}},passkey:{addPasskey:async(c,d)=>{let e=await a("/passkey/generate-register-options",{method:"GET",query:{...c?.authenticatorAttachment&&{authenticatorAttachment:c.authenticatorAttachment}}});if(!e.data)return e;try{let f=await (0,h.startRegistration)({optionsJSON:e.data,useAutoRegister:c?.useAutoRegister}),g=await a("/passkey/verify-registration",{...c?.fetchOptions,...d,body:{response:f,name:c?.name},method:"POST"});if(!g.data)return g;b.set(Math.random())}catch(a){if(a instanceof i.WebAuthnError){if("ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED"===a.code)return{data:null,error:{message:"previously registered",status:400,statusText:"BAD_REQUEST"}};if("ERROR_CEREMONY_ABORTED"===a.code)return{data:null,error:{message:"registration cancelled",status:400,statusText:"BAD_REQUEST"}};return{data:null,error:{message:a.message,status:400,statusText:"BAD_REQUEST"}}}return{data:null,error:{message:a instanceof Error?a.message:"unknown error",status:500,statusText:"INTERNAL_SERVER_ERROR"}}}}},$Infer:{}}),n=()=>{let a=(0,d.atom)();return{id:"passkey",$InferServerPlugin:{},getActions:b=>m(b,{$listPasskeys:a}),getAtoms:b=>({listPasskeys:(0,e.u)(a,"/passkey/list-user-passkeys",b,{method:"GET"}),$listPasskeys:a}),pathMethods:{"/passkey/register":"POST","/passkey/authenticate":"POST"},atomListeners:[{matcher:a=>"/passkey/verify-registration"===a||"/passkey/delete-passkey"===a||"/passkey/update-passkey"===a,signal:"_listPasskeys"}]}},o=()=>({id:"magic-link",$InferServerPlugin:{}}),p=()=>({id:"phoneNumber",$InferServerPlugin:{},atomListeners:[{matcher:a=>"/phone-number/update"===a||"/phone-number/verify"===a,signal:"$sessionSignal"}]}),q=()=>({id:"anonymous",$InferServerPlugin:{},pathMethods:{"/sign-in/anonymous":"POST"}}),r=a=>({id:"additional-fields-client",$InferServerPlugin:{}}),s=a=>{let b={admin:k.adminAc,user:k.userAc,...a?.roles};return{id:"admin-client",$InferServerPlugin:{},getActions:c=>({admin:{checkRolePermission:c=>(0,l.h)({role:c.role,options:{ac:a?.ac,roles:b},permissions:c.permissions??c.permission})}}),pathMethods:{"/admin/list-users":"GET","/admin/stop-impersonating":"POST"}}},t=()=>({id:"generic-oauth-client",$InferServerPlugin:{}}),u=()=>({id:"better-auth-client",$InferServerPlugin:{}}),v=()=>({id:"multi-session",$InferServerPlugin:{},atomListeners:[{matcher:a=>"/multi-session/set-active"===a,signal:"$sessionSignal"}]}),w=()=>({id:"email-otp",$InferServerPlugin:{}}),x=!1,y=a=>({id:"one-tap",getActions:(b,c)=>({oneTap:async(c,d)=>{if(x)return void console.warn("A Google One Tap request is already in progress. Please wait.");x=!0;try{if("undefined"==typeof window||!window.document)return void console.warn("Google One Tap is only available in browser environments");let{autoSelect:e,cancelOnTapOutside:f,context:g}=c??{},h=g??a.context??"signin";await z(),await new Promise((g,i)=>{let j=!1,k=a.promptOptions?.baseDelay??1e3,l=a.promptOptions?.maxAttempts??5;window.google?.accounts.id.initialize({client_id:a.clientId,callback:async a=>{j=!0;try{await b("/one-tap/callback",{method:"POST",body:{idToken:a.credential},...c?.fetchOptions,...d}),(!c?.fetchOptions&&!d||c?.callbackURL)&&(window.location.href=c?.callbackURL??"/"),g()}catch(a){console.error("Error during One Tap callback:",a),i(a)}},auto_select:e,cancel_on_tap_outside:f,context:h,...a.additionalOptions});let m=a=>{j||window.google?.accounts.id.prompt(b=>{if(!j){if(b.isDismissedMoment&&b.isDismissedMoment())if(a<l){let b=Math.pow(2,a)*k;setTimeout(()=>m(a+1),b)}else c?.onPromptNotification?.(b);else if(b.isSkippedMoment&&b.isSkippedMoment())if(a<l){let b=Math.pow(2,a)*k;setTimeout(()=>m(a+1),b)}else c?.onPromptNotification?.(b)}})};m(0)})}catch(a){throw console.error("Error during Google One Tap flow:",a),a}finally{x=!1}}}),getAtoms:a=>({})}),z=()=>new Promise(a=>{if(window.googleScriptInitialized)return void a();let b=document.createElement("script");b.src="https://accounts.google.com/gsi/client",b.async=!0,b.defer=!0,b.onload=()=>{window.googleScriptInitialized=!0,a()},document.head.appendChild(b)}),A=()=>B(),B=()=>({id:"infer-server-plugin",$InferServerPlugin:{}}),C=()=>({id:"sso-client",$InferServerPlugin:{}}),D=()=>({id:"oidc-client",$InferServerPlugin:{}}),E=()=>({id:"api-key",$InferServerPlugin:{},pathMethods:{"/api-key/create":"POST","/api-key/delete":"POST","/api-key/delete-all-expired-api-keys":"POST"}}),F=()=>({id:"one-time-token",$InferServerPlugin:{}})}},913630:a=>{"use strict";var{g:b,__dirname:c}=a;a.s({}),a.i(552411),a.i(581502),a.i(474192),a.i(289491),a.i(19664),a.i(73681),a.i(398398),a.i(376097),a.i(593116),a.i(110331),a.i(54920),a.i(915390)},714513:a=>{"use strict";var{g:b,__dirname:c}=a;{a.s({authClient:()=>b,signIn:()=>c,signOut:()=>h,signUp:()=>g,useSession:()=>i});var d=a.i(326764),e=a.i(800855);a.i(913630);var f=a.i(915390);let b=(0,e.createAuthClient)({baseURL:"https://inbound.new",plugins:[(0,d.stripeClient)({subscription:!0}),(0,f.adminClient)(),(0,f.apiKeyClient)(),(0,f.magicLinkClient)()]}),{signIn:c,signUp:g,signOut:h,useSession:i}=b}}};

//# sourceMappingURL=_c70ca343._.js.map