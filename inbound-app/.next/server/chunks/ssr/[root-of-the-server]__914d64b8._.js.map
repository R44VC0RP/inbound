{"version":3,"sources":["turbopack:///[project]/node_modules/next/src/server/web/spec-extension/cookies.ts","turbopack:///[project]/node_modules/next/src/server/web/spec-extension/adapters/reflect.ts","turbopack:///[project]/node_modules/next/src/server/request/utils.ts","turbopack:///[project]/node_modules/next/src/shared/lib/invariant-error.ts","turbopack:///[project]/lib/auth/auth-utils.ts","turbopack:///[project]/app/(main)/admin/layout.tsx"],"sourcesContent":["export {\n  RequestCookies,\n  ResponseCookies,\n  stringifyCookie,\n} from 'next/dist/compiled/@edge-runtime/cookies'\n","export class ReflectAdapter {\n  static get<T extends object>(\n    target: T,\n    prop: string | symbol,\n    receiver: unknown\n  ): any {\n    const value = Reflect.get(target, prop, receiver)\n    if (typeof value === 'function') {\n      return value.bind(target)\n    }\n\n    return value\n  }\n\n  static set<T extends object>(\n    target: T,\n    prop: string | symbol,\n    value: any,\n    receiver: any\n  ): boolean {\n    return Reflect.set(target, prop, value, receiver)\n  }\n\n  static has<T extends object>(target: T, prop: string | symbol): boolean {\n    return Reflect.has(target, prop)\n  }\n\n  static deleteProperty<T extends object>(\n    target: T,\n    prop: string | symbol\n  ): boolean {\n    return Reflect.deleteProperty(target, prop)\n  }\n}\n","import { StaticGenBailoutError } from '../../client/components/static-generation-bailout'\nimport { afterTaskAsyncStorage } from '../app-render/after-task-async-storage.external'\nimport type { WorkStore } from '../app-render/work-async-storage.external'\n\nexport function throwWithStaticGenerationBailoutError(\n  route: string,\n  expression: string\n): never {\n  throw new StaticGenBailoutError(\n    `Route ${route} couldn't be rendered statically because it used ${expression}. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`\n  )\n}\n\nexport function throwWithStaticGenerationBailoutErrorWithDynamicError(\n  route: string,\n  expression: string\n): never {\n  throw new StaticGenBailoutError(\n    `Route ${route} with \\`dynamic = \"error\"\\` couldn't be rendered statically because it used ${expression}. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`\n  )\n}\n\nexport function throwForSearchParamsAccessInUseCache(\n  workStore: WorkStore\n): never {\n  const error = new Error(\n    `Route ${workStore.route} used \"searchParams\" inside \"use cache\". Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \"searchParams\" outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`\n  )\n\n  workStore.invalidUsageError ??= error\n\n  throw error\n}\n\nexport function isRequestAPICallableInsideAfter() {\n  const afterTaskStore = afterTaskAsyncStorage.getStore()\n  return afterTaskStore?.rootTaskSpawnPhase === 'action'\n}\n","export class InvariantError extends Error {\n  constructor(message: string, options?: ErrorOptions) {\n    super(\n      `Invariant: ${message.endsWith('.') ? message : message + '.'} This is a bug in Next.js.`,\n      options\n    )\n    this.name = 'InvariantError'\n  }\n}\n","'use server'\n\nimport { auth } from \"@/lib/auth/auth\"\nimport { headers } from \"next/headers\"\n\n/**\n * Check if the current user has admin role\n * @returns Promise<boolean> - true if user is admin, false otherwise\n */\nexport async function isCurrentUserAdmin(): Promise<boolean> {\n  try {\n    const session = await auth.api.getSession({\n      headers: await headers()\n    })\n    \n    return session?.user?.role === 'admin'\n  } catch (error) {\n    console.error('Error checking admin status:', error)\n    return false\n  }\n}\n\n/**\n * Check if a user role is admin\n * @param role - The user role to check\n * @returns boolean - true if role is admin, false otherwise\n */\nexport async function isAdminRole(role: string | null | undefined): Promise<boolean> {\n  return role === 'admin'\n}\n\n/**\n * Get the current session on the server side\n * @returns Promise<Session | null> - The current session or null\n */\nexport async function getCurrentSession() {\n  try {\n    const session = await auth.api.getSession({\n      headers: await headers()\n    })\n    \n    return session\n  } catch (error) {\n    console.error('Error getting current session:', error)\n    return null\n  }\n}\n\n/**\n * Require admin role - throws error if user is not admin\n * @throws Error if user is not admin\n */\nexport async function requireAdmin(): Promise<void> {\n  const isAdmin = await isCurrentUserAdmin()\n  \n  if (!isAdmin) {\n    throw new Error('Admin access required')\n  }\n} ","import { redirect } from \"next/navigation\"\nimport { getCurrentSession, isAdminRole } from \"@/lib/auth/auth-utils\"\n\nexport default async function AdminLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  // Check if user is authenticated and has admin role\n  const session = await getCurrentSession()\n  \n  if (!session) {\n    redirect(\"/login\")\n  }\n  \n  if (!isAdminRole(session.user.role)) {\n    redirect(\"/mail\")\n  }\n\n  return <>{children}</>\n} "],"names":["RequestCookies","ResponseCookies","stringifyCookie","ReflectAdapter","get","target","prop","receiver","value","Reflect","bind","set","has","deleteProperty","isRequestAPICallableInsideAfter","throwForSearchParamsAccessInUseCache","throwWithStaticGenerationBailoutError","throwWithStaticGenerationBailoutErrorWithDynamicError","route","expression","StaticGenBailoutError","workStore","error","Error","invalidUsageError","afterTaskStore","afterTaskAsyncStorage","getStore","rootTaskSpawnPhase","InvariantError","constructor","message","options","endsWith","name"],"mappings":"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","ignoreList":[0,1,2,3]}