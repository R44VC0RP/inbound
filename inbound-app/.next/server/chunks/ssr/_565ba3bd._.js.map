{"version":3,"sources":["turbopack:///[project]/node_modules/next/dist/src/server/route-modules/app-page/module.compiled.js","turbopack:///[project]/app/(main)/admin/page.tsx/proxy.mjs","turbopack:///[project]/node_modules/next/dist/src/build/templates/app-page.ts","turbopack:///[project]/app/actions/feature-flags.ts","turbopack:///[project]/.next-internal/server/app/(main)/admin/page/actions.js (server actions loader)"],"sourcesContent":["if (process.env.NEXT_RUNTIME === 'edge') {\n  module.exports = require('next/dist/server/route-modules/app-page/module.js')\n} else {\n  if (process.env.__NEXT_EXPERIMENTAL_REACT) {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.prod.js')\n      }\n    }\n  } else {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.prod.js')\n      }\n    }\n  }\n}\n","import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/app/(main)/admin/page.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/app/(main)/admin/page.tsx <module evaluation>\",\n    \"default\",\n);\n","import type { LoaderTree } from '../../server/lib/app-dir-module'\nimport { AppPageRouteModule } from '../../server/route-modules/app-page/module.compiled' with { 'turbopack-transition': 'next-ssr' }\nimport { RouteKind } from '../../server/route-kind' with { 'turbopack-transition': 'next-server-utility' }\n\n// These are injected by the loader afterwards.\n\n/**\n * The tree created in next-app-loader that holds component segments and modules\n * and I've updated it.\n */\ndeclare const tree: LoaderTree\ndeclare const pages: any\n\n// We inject the tree and pages here so that we can use them in the route\n// module.\n// INJECT:tree\n// INJECT:pages\n\nexport { tree, pages }\n\nexport { default as GlobalError } from 'VAR_MODULE_GLOBAL_ERROR' with { 'turbopack-transition': 'next-server-utility' }\n\n// These are injected by the loader afterwards.\ndeclare const __next_app_require__: (id: string | number) => unknown\ndeclare const __next_app_load_chunk__: (id: string | number) => Promise<unknown>\n\n// INJECT:__next_app_require__\n// INJECT:__next_app_load_chunk__\n\nexport const __next_app__ = {\n  require: __next_app_require__,\n  loadChunk: __next_app_load_chunk__,\n}\n\nexport * from '../../server/app-render/entry-base' with { 'turbopack-transition': 'next-server-utility' }\n\n// Create and export the route module that will be consumed.\nexport const routeModule = new AppPageRouteModule({\n  definition: {\n    kind: RouteKind.APP_PAGE,\n    page: 'VAR_DEFINITION_PAGE',\n    pathname: 'VAR_DEFINITION_PATHNAME',\n    // The following aren't used in production.\n    bundlePath: '',\n    filename: '',\n    appPaths: [],\n  },\n  userland: {\n    loaderTree: tree,\n  },\n})\n","\"use server\"\n\nimport { auth } from \"@/lib/auth/auth\"\nimport { headers } from \"next/headers\"\nimport { db } from '@/lib/db'\nimport { user } from '@/lib/db/auth-schema'\nimport { eq } from 'drizzle-orm'\n\n/**\n * Add a feature flag to a user\n */\nexport async function addFeatureFlag(userId: string, flagName: string) {\n  try {\n    // Get current session to verify admin access\n    const session = await auth.api.getSession({\n      headers: await headers()\n    })\n\n    if (!session?.user?.id) {\n      return { success: false, error: 'Unauthorized' }\n    }\n\n    // Only admins can manage feature flags (or users can manage their own for testing)\n    if (session.user.role !== 'admin' && session.user.id !== userId) {\n      return { success: false, error: 'Forbidden - admin access required' }\n    }\n\n    // Get current user data\n    const [currentUser] = await db\n      .select()\n      .from(user)\n      .where(eq(user.id, userId))\n      .limit(1)\n\n    if (!currentUser) {\n      return { success: false, error: 'User not found' }\n    }\n\n    // Parse current feature flags\n    let currentFlags: string[] = []\n    if (currentUser.featureFlags) {\n      try {\n        currentFlags = JSON.parse(currentUser.featureFlags)\n      } catch {\n        currentFlags = []\n      }\n    }\n\n    // Add the new flag if it doesn't exist\n    if (!currentFlags.includes(flagName)) {\n      currentFlags.push(flagName)\n    }\n\n    // Update user with new feature flags\n    await db\n      .update(user)\n      .set({\n        featureFlags: JSON.stringify(currentFlags),\n        updatedAt: new Date()\n      })\n      .where(eq(user.id, userId))\n\n    console.log(`✅ Added feature flag '${flagName}' to user ${userId}`)\n    return { success: true, flags: currentFlags }\n\n  } catch (error) {\n    console.error('❌ Error adding feature flag:', error)\n    return { \n      success: false, \n      error: 'Failed to add feature flag',\n      details: error instanceof Error ? error.message : 'Unknown error'\n    }\n  }\n}\n\n/**\n * Remove a feature flag from a user\n */\nexport async function removeFeatureFlag(userId: string, flagName: string) {\n  try {\n    // Get current session to verify admin access\n    const session = await auth.api.getSession({\n      headers: await headers()\n    })\n\n    if (!session?.user?.id) {\n      return { success: false, error: 'Unauthorized' }\n    }\n\n    // Only admins can manage feature flags (or users can manage their own for testing)\n    if (session.user.role !== 'admin' && session.user.id !== userId) {\n      return { success: false, error: 'Forbidden - admin access required' }\n    }\n\n    // Get current user data\n    const [currentUser] = await db\n      .select()\n      .from(user)\n      .where(eq(user.id, userId))\n      .limit(1)\n\n    if (!currentUser) {\n      return { success: false, error: 'User not found' }\n    }\n\n    // Parse current feature flags\n    let currentFlags: string[] = []\n    if (currentUser.featureFlags) {\n      try {\n        currentFlags = JSON.parse(currentUser.featureFlags)\n      } catch {\n        currentFlags = []\n      }\n    }\n\n    // Remove the flag\n    currentFlags = currentFlags.filter(flag => flag !== flagName)\n\n    // Update user with new feature flags\n    await db\n      .update(user)\n      .set({\n        featureFlags: JSON.stringify(currentFlags),\n        updatedAt: new Date()\n      })\n      .where(eq(user.id, userId))\n\n    console.log(`✅ Removed feature flag '${flagName}' from user ${userId}`)\n    return { success: true, flags: currentFlags }\n\n  } catch (error) {\n    console.error('❌ Error removing feature flag:', error)\n    return { \n      success: false, \n      error: 'Failed to remove feature flag',\n      details: error instanceof Error ? error.message : 'Unknown error'\n    }\n  }\n}\n\n/**\n * Get current user's feature flags\n */\nexport async function getUserFeatureFlags(userId?: string) {\n  try {\n    // Get current session\n    const session = await auth.api.getSession({\n      headers: await headers()\n    })\n\n    if (!session?.user?.id) {\n      return { success: false, error: 'Unauthorized' }\n    }\n\n    const targetUserId = userId || session.user.id\n\n    // Only admins can view other users' flags\n    if (session.user.role !== 'admin' && session.user.id !== targetUserId) {\n      return { success: false, error: 'Forbidden - admin access required' }\n    }\n\n    // Get user data\n    const [currentUser] = await db\n      .select({ featureFlags: user.featureFlags })\n      .from(user)\n      .where(eq(user.id, targetUserId))\n      .limit(1)\n\n    if (!currentUser) {\n      return { success: false, error: 'User not found' }\n    }\n\n    // Parse feature flags\n    let flags: string[] = []\n    if (currentUser.featureFlags) {\n      try {\n        flags = JSON.parse(currentUser.featureFlags)\n      } catch {\n        flags = []\n      }\n    }\n\n    return { success: true, flags }\n\n  } catch (error) {\n    console.error('❌ Error getting feature flags:', error)\n    return { \n      success: false, \n      error: 'Failed to get feature flags',\n      details: error instanceof Error ? error.message : 'Unknown error'\n    }\n  }\n} ","export {getAutumnCustomer as '00bd5c39d59f2c9e83dce14d93d44f40e9d2c4f1ae'} from 'ACTIONS_MODULE0'\nexport {sendFeedbackAction as '4001b46509619c2e0fe09e06802ee8157c6226ec8c'} from 'ACTIONS_MODULE1'\nexport {getDomainStats as '00faa09f01a5256e987f59d5eb3348cc00f9bf9491'} from 'ACTIONS_MODULE0'\nexport {generateAutumnBillingPortal as '00282b3a5eacbbc918f95ec4473b7dc09d0e5ffcf8'} from 'ACTIONS_MODULE0'\nexport {getOnboardingStatus as '40d22d6e027abaab42994fd38d69f454c777a42914'} from 'ACTIONS_MODULE2'\nexport {isCurrentUserAdmin as '0052e71a395ae6c36c1265ac19f2d77546469d06f4'} from 'ACTIONS_MODULE3'\nexport {getCurrentSession as '0061b2fde328e250de6c1cbe9a37df4e53b14f84f7'} from 'ACTIONS_MODULE3'\nexport {requireAdmin as '007eedb784c12b3f28a783e45737993f622c809025'} from 'ACTIONS_MODULE3'\nexport {isAdminRole as '40d1b58796c6609eb334bb8ddc8f51a8ae125b0984'} from 'ACTIONS_MODULE3'\nexport {getAllDomainsForAdmin as '00560e01c105f4a71ab091dc08be600fefa3f70dc5'} from 'ACTIONS_MODULE0'\nexport {getDomainEmailAddressesForAdmin as '404cfffacaa2fc043fcb99ab6963947b8e9cbebc7f'} from 'ACTIONS_MODULE0'\nexport {addFeatureFlag as '602a9ebcfc95579a115c2e7ef866f94f4b839027cf'} from 'ACTIONS_MODULE4'\nexport {removeFeatureFlag as '606e0476e2f2d68361a4aa336a5f5781547706cc47'} from 'ACTIONS_MODULE4'\nexport {getUserFeatureFlags as '40e48b9607bdd1a52d5eedc6bf99ba896327227c74'} from 'ACTIONS_MODULE4'\n"],"names":["process","env","NEXT_RUNTIME","__NEXT_EXPERIMENTAL_REACT","NODE_ENV","TURBOPACK","module","exports","require","AppPageRouteModule","RouteKind","tree","pages","routeModule","kind","APP_PAGE","appPaths","userland","loaderTree"],"mappings":"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","ignoreList":[0,2]}