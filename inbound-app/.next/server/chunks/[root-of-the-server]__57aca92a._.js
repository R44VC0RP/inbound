module.exports={929549:function(e){var{g:r,__dirname:s,m:i,e:t}=e;i.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},983943:function(e){var{g:r,__dirname:s,m:i,e:t}=e;i.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},86103:function(e){var{g:r,__dirname:s,m:i,e:t}=e;i.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},945935:function(e){var{g:r,__dirname:s,m:i,e:t}=e;i.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},348629:function(e){var{g:r,__dirname:s,m:i,e:t}=e;i.exports=e.x("@opentelemetry/api",()=>require("@opentelemetry/api"))},76569:function(e){var{g:r,__dirname:s,m:i,e:t}=e;i.exports=e.x("node:events",()=>require("node:events"))},804713:function(e){var{g:r,__dirname:s,m:i,e:t}=e;i.exports=e.x("util",()=>require("util"))},87485:function(e){var{g:r,__dirname:s,m:i,e:t}=e;i.exports=e.x("child_process",()=>require("child_process"))},420467:function(e){var{g:r,__dirname:s,m:i,e:t}=e;i.exports=e.x("events",()=>require("events"))},936121:function(e){var{g:r,__dirname:s,m:i,e:t}=e;i.exports=e.x("node:util",()=>require("node:util"))},681635:function(e){var{g:r,__dirname:s,m:i,e:t}=e;i.exports=e.x("node:http",()=>require("node:http"))},866098:function(e){var{g:r,__dirname:s,m:i,e:t}=e;i.exports=e.x("node:https",()=>require("node:https"))},580767:function(e){var{g:r,__dirname:s,m:i,e:t}=e;i.exports=e.x("node:buffer",()=>require("node:buffer"))},329295:function(e){var{g:r,__dirname:s,m:i,e:t}=e;i.exports=e.x("crypto",()=>require("crypto"))},62445:function(e){var{g:r,__dirname:s,m:i,e:t}=e;i.exports=e.x("http",()=>require("http"))},348388:function(e){var{g:r,__dirname:s,m:i,e:t}=e;i.exports=e.x("https",()=>require("https"))},591032:function(e){var{g:r,__dirname:s,m:i,e:t}=e;i.exports=e.x("node:crypto",()=>require("node:crypto"))},909834:e=>{"use strict";var{g:r,__dirname:s}=e;e.s({DELIVERY_STATUS:()=>t.DELIVERY_STATUS,DELIVERY_TYPES:()=>t.DELIVERY_TYPES,DOMAIN_STATUS:()=>t.DOMAIN_STATUS,EMAIL_STATUS:()=>t.EMAIL_STATUS,ENDPOINT_TYPES:()=>t.ENDPOINT_TYPES,PROVIDER_CONFIDENCE:()=>t.PROVIDER_CONFIDENCE,SENT_EMAIL_STATUS:()=>t.SENT_EMAIL_STATUS,SES_VERIFICATION_STATUS:()=>t.SES_VERIFICATION_STATUS,VIP_PAYMENT_STATUS:()=>t.VIP_PAYMENT_STATUS,WEBHOOK_FORMATS:()=>t.WEBHOOK_FORMATS,WEBHOOK_STATUS:()=>t.WEBHOOK_STATUS,account:()=>i.account,apikey:()=>i.apikey,blockedEmails:()=>t.blockedEmails,domainDnsRecords:()=>t.domainDnsRecords,emailAddresses:()=>t.emailAddresses,emailDomains:()=>t.emailDomains,emailGroups:()=>t.emailGroups,endpointDeliveries:()=>t.endpointDeliveries,endpoints:()=>t.endpoints,parsedEmails:()=>t.parsedEmails,receivedEmails:()=>t.receivedEmails,sentEmails:()=>t.sentEmails,sesEvents:()=>t.sesEvents,session:()=>i.session,structuredEmails:()=>t.structuredEmails,subscriptions:()=>t.subscriptions,user:()=>i.user,userAccounts:()=>t.userAccounts,userOnboarding:()=>t.userOnboarding,verification:()=>i.verification,vipAllowedSenders:()=>t.vipAllowedSenders,vipConfigs:()=>t.vipConfigs,vipEmailAttempts:()=>t.vipEmailAttempts,vipPaymentSessions:()=>t.vipPaymentSessions,webhookDeliveries:()=>t.webhookDeliveries,webhooks:()=>t.webhooks});var i=e.i(594120),t=e.i(55379)},436754:e=>{"use strict";var{g:r,__dirname:s}=e;e.s({DELIVERY_STATUS:()=>i.DELIVERY_STATUS,DELIVERY_TYPES:()=>i.DELIVERY_TYPES,DOMAIN_STATUS:()=>i.DOMAIN_STATUS,EMAIL_STATUS:()=>i.EMAIL_STATUS,ENDPOINT_TYPES:()=>i.ENDPOINT_TYPES,PROVIDER_CONFIDENCE:()=>i.PROVIDER_CONFIDENCE,SENT_EMAIL_STATUS:()=>i.SENT_EMAIL_STATUS,SES_VERIFICATION_STATUS:()=>i.SES_VERIFICATION_STATUS,VIP_PAYMENT_STATUS:()=>i.VIP_PAYMENT_STATUS,WEBHOOK_FORMATS:()=>i.WEBHOOK_FORMATS,WEBHOOK_STATUS:()=>i.WEBHOOK_STATUS,account:()=>i.account,apikey:()=>i.apikey,blockedEmails:()=>i.blockedEmails,domainDnsRecords:()=>i.domainDnsRecords,emailAddresses:()=>i.emailAddresses,emailDomains:()=>i.emailDomains,emailGroups:()=>i.emailGroups,endpointDeliveries:()=>i.endpointDeliveries,endpoints:()=>i.endpoints,parsedEmails:()=>i.parsedEmails,receivedEmails:()=>i.receivedEmails,sentEmails:()=>i.sentEmails,sesEvents:()=>i.sesEvents,session:()=>i.session,structuredEmails:()=>i.structuredEmails,subscriptions:()=>i.subscriptions,user:()=>i.user,userAccounts:()=>i.userAccounts,userOnboarding:()=>i.userOnboarding,verification:()=>i.verification,vipAllowedSenders:()=>i.vipAllowedSenders,vipConfigs:()=>i.vipConfigs,vipEmailAttempts:()=>i.vipEmailAttempts,vipPaymentSessions:()=>i.vipPaymentSessions,webhookDeliveries:()=>i.webhookDeliveries,webhooks:()=>i.webhooks}),e.i(468686);var i=e.i(909834)},57527:function(e){var{g:r,__dirname:s,m:i,e:t}=e},908891:e=>{"use strict";var{g:r,__dirname:s}=e;e.s({GET:()=>u,POST:()=>l});var i=e.i(125427),t=e.i(402168),n=e.i(998322),o=e.i(557440);e.i(468686);var a=e.i(55379),d=e.i(176825),p=e.i(318812);async function u(e){try{console.log("📋 GET /api/v1/endpoints - Fetching user endpoints");let e=await t.auth.api.getSession({headers:await (0,n.headers)()});if(!e?.user?.id)return console.warn("❌ GET /api/v1/endpoints - Unauthorized request"),i.NextResponse.json({error:"Unauthorized"},{status:401});let r=await o.db.select({id:a.endpoints.id,name:a.endpoints.name,type:a.endpoints.type,config:a.endpoints.config,isActive:a.endpoints.isActive,description:a.endpoints.description,userId:a.endpoints.userId,createdAt:a.endpoints.createdAt,updatedAt:a.endpoints.updatedAt}).from(a.endpoints).where((0,d.eq)(a.endpoints.userId,e.user.id)).orderBy(a.endpoints.createdAt),s=await Promise.all(r.map(async e=>{if("email_group"===e.type){let r=await o.db.select({emailAddress:a.emailGroups.emailAddress}).from(a.emailGroups).where((0,d.eq)(a.emailGroups.endpointId,e.id));return{...e,groupEmails:r.map(e=>e.emailAddress)}}return e}));return console.log(`✅ GET /api/v1/endpoints - Retrieved ${r.length} endpoints for user ${e.user.id}`),i.NextResponse.json({success:!0,endpoints:s})}catch(e){return console.error("❌ GET /api/v1/endpoints - Error:",e),i.NextResponse.json({success:!1,error:"Failed to fetch endpoints",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}async function l(e){try{console.log("📝 POST /api/v1/endpoints - Creating new endpoint");let r=await t.auth.api.getSession({headers:await (0,n.headers)()});if(!r?.user?.id)return console.warn("❌ POST /api/v1/endpoints - Unauthorized request"),i.NextResponse.json({error:"Unauthorized"},{status:401});let s=await e.json();if(!s.name||!s.type||!s.config)return i.NextResponse.json({error:"Missing required fields: name, type, config"},{status:400});if(!["webhook","email","email_group"].includes(s.type))return i.NextResponse.json({error:"Invalid endpoint type. Must be webhook, email, or email_group"},{status:400});let d=function(e,r){try{switch(e){case"webhook":if(!r.url)return{valid:!1,error:"Webhook URL is required"};if("string"!=typeof r.url)return{valid:!1,error:"Webhook URL must be a string"};try{new URL(r.url)}catch{return{valid:!1,error:"Invalid webhook URL format"}}break;case"email":if(!r.forwardTo)return{valid:!1,error:"Forward-to email address is required"};if("string"!=typeof r.forwardTo)return{valid:!1,error:"Forward-to email must be a string"};if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r.forwardTo))return{valid:!1,error:"Invalid forward-to email address format"};break;case"email_group":if(!r.emails||!Array.isArray(r.emails))return{valid:!1,error:"Email group must have an emails array"};if(0===r.emails.length)return{valid:!1,error:"Email group must have at least one email address"};let s=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;for(let e of r.emails)if("string"!=typeof e||!s.test(e))return{valid:!1,error:`Invalid email address in group: ${e}`};break;default:return{valid:!1,error:"Unknown endpoint type"}}return{valid:!0}}catch(e){return{valid:!1,error:"Configuration validation failed"}}}(s.type,s.config);if(!d.valid)return i.NextResponse.json({error:`Invalid configuration: ${d.error}`},{status:400});console.log(`📝 POST /api/v1/endpoints - Creating ${s.type} endpoint: ${s.name}`);let u={id:(0,p.nanoid)(),name:s.name,type:s.type,webhookFormat:"webhook"===s.type?s.webhookFormat||"inbound":null,config:JSON.stringify(s.config),description:s.description||null,userId:r.user.id,isActive:!0,createdAt:new Date,updatedAt:new Date},[l]=await o.db.insert(a.endpoints).values(u).returning();if("email_group"===s.type&&"emails"in s.config){let e=s.config.emails.map(e=>({id:(0,p.nanoid)(),endpointId:l.id,emailAddress:e,createdAt:new Date}));e.length>0&&(await o.db.insert(a.emailGroups).values(e),console.log(`📮 POST /api/v1/endpoints - Created ${e.length} email group entries`))}return console.log(`✅ POST /api/v1/endpoints - Successfully created endpoint ${l.id}`),i.NextResponse.json({success:!0,endpoint:l},{status:201})}catch(e){return console.error("❌ POST /api/v1/endpoints - Error:",e),i.NextResponse.json({success:!1,error:"Failed to create endpoint",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}},222425:e=>{"use strict";var{g:r,__dirname:s}=e;{e.s({patchFetch:()=>a,routeModule:()=>r,serverHooks:()=>p,workAsyncStorage:()=>s,workUnitAsyncStorage:()=>d});var i=e.i(854885),t=e.i(814689),n=e.i(25402),o=e.i(908891);let r=new i.AppRouteRouteModule({definition:{kind:t.RouteKind.APP_ROUTE,page:"/api/v1/endpoints/route",pathname:"/api/v1/endpoints",filename:"route",bundlePath:""},resolvedPagePath:"[project]/app/api/v1/endpoints/route.ts",nextConfigOutput:"",userland:o}),{workAsyncStorage:s,workUnitAsyncStorage:d,serverHooks:p}=r;function a(){return(0,n.patchFetch)({workAsyncStorage:s,workUnitAsyncStorage:d})}}},993477:e=>{var{g:r,__dirname:s}=e;e.v(r=>Promise.all(["server/chunks/[root-of-the-server]__bc02c489._.js","server/chunks/node_modules_10ae7a2d._.js"].map(r=>e.l(r))).then(()=>r(611487)))}};

//# sourceMappingURL=%5Broot-of-the-server%5D__57aca92a._.js.map