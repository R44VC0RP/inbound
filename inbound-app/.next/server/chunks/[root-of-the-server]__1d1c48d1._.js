module.exports={929549:function(e){var{g:i,__dirname:s,m:r,e:t}=e;r.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},983943:function(e){var{g:i,__dirname:s,m:r,e:t}=e;r.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},86103:function(e){var{g:i,__dirname:s,m:r,e:t}=e;r.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},945935:function(e){var{g:i,__dirname:s,m:r,e:t}=e;r.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},348629:function(e){var{g:i,__dirname:s,m:r,e:t}=e;r.exports=e.x("@opentelemetry/api",()=>require("@opentelemetry/api"))},76569:function(e){var{g:i,__dirname:s,m:r,e:t}=e;r.exports=e.x("node:events",()=>require("node:events"))},804713:function(e){var{g:i,__dirname:s,m:r,e:t}=e;r.exports=e.x("util",()=>require("util"))},87485:function(e){var{g:i,__dirname:s,m:r,e:t}=e;r.exports=e.x("child_process",()=>require("child_process"))},420467:function(e){var{g:i,__dirname:s,m:r,e:t}=e;r.exports=e.x("events",()=>require("events"))},936121:function(e){var{g:i,__dirname:s,m:r,e:t}=e;r.exports=e.x("node:util",()=>require("node:util"))},681635:function(e){var{g:i,__dirname:s,m:r,e:t}=e;r.exports=e.x("node:http",()=>require("node:http"))},866098:function(e){var{g:i,__dirname:s,m:r,e:t}=e;r.exports=e.x("node:https",()=>require("node:https"))},580767:function(e){var{g:i,__dirname:s,m:r,e:t}=e;r.exports=e.x("node:buffer",()=>require("node:buffer"))},329295:function(e){var{g:i,__dirname:s,m:r,e:t}=e;r.exports=e.x("crypto",()=>require("crypto"))},62445:function(e){var{g:i,__dirname:s,m:r,e:t}=e;r.exports=e.x("http",()=>require("http"))},348388:function(e){var{g:i,__dirname:s,m:r,e:t}=e;r.exports=e.x("https",()=>require("https"))},591032:function(e){var{g:i,__dirname:s,m:r,e:t}=e;r.exports=e.x("node:crypto",()=>require("node:crypto"))},909834:e=>{"use strict";var{g:i,__dirname:s}=e;e.s({DELIVERY_STATUS:()=>t.DELIVERY_STATUS,DELIVERY_TYPES:()=>t.DELIVERY_TYPES,DOMAIN_STATUS:()=>t.DOMAIN_STATUS,EMAIL_STATUS:()=>t.EMAIL_STATUS,ENDPOINT_TYPES:()=>t.ENDPOINT_TYPES,PROVIDER_CONFIDENCE:()=>t.PROVIDER_CONFIDENCE,SENT_EMAIL_STATUS:()=>t.SENT_EMAIL_STATUS,SES_VERIFICATION_STATUS:()=>t.SES_VERIFICATION_STATUS,VIP_PAYMENT_STATUS:()=>t.VIP_PAYMENT_STATUS,WEBHOOK_FORMATS:()=>t.WEBHOOK_FORMATS,WEBHOOK_STATUS:()=>t.WEBHOOK_STATUS,account:()=>r.account,apikey:()=>r.apikey,blockedEmails:()=>t.blockedEmails,domainDnsRecords:()=>t.domainDnsRecords,emailAddresses:()=>t.emailAddresses,emailDomains:()=>t.emailDomains,emailGroups:()=>t.emailGroups,endpointDeliveries:()=>t.endpointDeliveries,endpoints:()=>t.endpoints,parsedEmails:()=>t.parsedEmails,receivedEmails:()=>t.receivedEmails,sentEmails:()=>t.sentEmails,sesEvents:()=>t.sesEvents,session:()=>r.session,structuredEmails:()=>t.structuredEmails,subscriptions:()=>t.subscriptions,user:()=>r.user,userAccounts:()=>t.userAccounts,userOnboarding:()=>t.userOnboarding,verification:()=>r.verification,vipAllowedSenders:()=>t.vipAllowedSenders,vipConfigs:()=>t.vipConfigs,vipEmailAttempts:()=>t.vipEmailAttempts,vipPaymentSessions:()=>t.vipPaymentSessions,webhookDeliveries:()=>t.webhookDeliveries,webhooks:()=>t.webhooks});var r=e.i(594120),t=e.i(55379)},436754:e=>{"use strict";var{g:i,__dirname:s}=e;e.s({DELIVERY_STATUS:()=>r.DELIVERY_STATUS,DELIVERY_TYPES:()=>r.DELIVERY_TYPES,DOMAIN_STATUS:()=>r.DOMAIN_STATUS,EMAIL_STATUS:()=>r.EMAIL_STATUS,ENDPOINT_TYPES:()=>r.ENDPOINT_TYPES,PROVIDER_CONFIDENCE:()=>r.PROVIDER_CONFIDENCE,SENT_EMAIL_STATUS:()=>r.SENT_EMAIL_STATUS,SES_VERIFICATION_STATUS:()=>r.SES_VERIFICATION_STATUS,VIP_PAYMENT_STATUS:()=>r.VIP_PAYMENT_STATUS,WEBHOOK_FORMATS:()=>r.WEBHOOK_FORMATS,WEBHOOK_STATUS:()=>r.WEBHOOK_STATUS,account:()=>r.account,apikey:()=>r.apikey,blockedEmails:()=>r.blockedEmails,domainDnsRecords:()=>r.domainDnsRecords,emailAddresses:()=>r.emailAddresses,emailDomains:()=>r.emailDomains,emailGroups:()=>r.emailGroups,endpointDeliveries:()=>r.endpointDeliveries,endpoints:()=>r.endpoints,parsedEmails:()=>r.parsedEmails,receivedEmails:()=>r.receivedEmails,sentEmails:()=>r.sentEmails,sesEvents:()=>r.sesEvents,session:()=>r.session,structuredEmails:()=>r.structuredEmails,subscriptions:()=>r.subscriptions,user:()=>r.user,userAccounts:()=>r.userAccounts,userOnboarding:()=>r.userOnboarding,verification:()=>r.verification,vipAllowedSenders:()=>r.vipAllowedSenders,vipConfigs:()=>r.vipConfigs,vipEmailAttempts:()=>r.vipEmailAttempts,vipPaymentSessions:()=>r.vipPaymentSessions,webhookDeliveries:()=>r.webhookDeliveries,webhooks:()=>r.webhooks}),e.i(468686);var r=e.i(909834)},496669:e=>{"use strict";var{g:i,__dirname:s}=e;e.s({createApiKeyMiddleware:()=>n,validateApiKey:()=>t});var r=e.i(402168);async function t(e){try{let i,s=e.headers.get("Authorization");if(!s)return{valid:!1,error:"Missing Authorization header"};if(i=s.startsWith("Bearer ")?s.substring(7):s,console.log("API KEY: "+i),!i)return{valid:!1,error:"Invalid Authorization header format"};let{valid:t,error:n,key:a}=await r.auth.api.verifyApiKey({body:{key:i}});if(console.log("VALID: "+t),console.log("ERROR: "+n),console.log("KEY: "+a?.userId),!t||n||!a)return{valid:!1,error:n?.message||"Invalid API key"};if(!a.enabled)return{valid:!1,error:"API key is disabled"};if(a.expiresAt&&new Date(a.expiresAt)<new Date)return{valid:!1,error:"API key has expired"};return{valid:!0,user:{id:a.userId,email:a.userId,name:null}}}catch(e){return console.error("API key validation error:",e),{valid:!1,error:"Internal server error during API key validation"}}}function n(){return async e=>{let i=await t(e);return i.valid?{user:i.user}:{error:i.error,status:401}}}},667171:function(e){var{g:i,__dirname:s,m:r,e:t}=e},966522:e=>{"use strict";var{g:i,__dirname:s}=e;e.s({GET:()=>u});var r=e.i(125427),t=e.i(496669),n=e.i(557440);e.i(468686);var a=e.i(55379),o=e.i(176825),d=e.i(91890),l=e.i(460009);async function u(e){try{console.log("📋 GET /api/v1.1/domains - Fetching user domains");let i=await (0,t.validateApiKey)(e);if("error"in i)return r.NextResponse.json({error:i.error},{status:401});let s=i.user?.id;if(!s)return r.NextResponse.json({error:"User not found"},{status:401});let{searchParams:u}=new URL(e.url),c=u.get("status"),m=u.get("canReceive"),p=Math.min(parseInt(u.get("limit")||"50"),100),v=parseInt(u.get("offset")||"0"),E=[(0,o.eq)(a.emailDomains.userId,s)];c&&["verified","pending","failed"].includes(c)&&E.push((0,o.eq)(a.emailDomains.status,c)),null!==m&&E.push((0,o.eq)(a.emailDomains.canReceiveEmails,"true"===m));let A=E.length>1?(0,o.and)(...E):E[0],T=n.db.select({id:a.emailDomains.id,domain:a.emailDomains.domain,status:a.emailDomains.status,canReceiveEmails:a.emailDomains.canReceiveEmails,hasMxRecords:a.emailDomains.hasMxRecords,catchAllEndpointId:a.emailDomains.catchAllEndpointId,verificationToken:a.emailDomains.verificationToken,domainProvider:a.emailDomains.domainProvider,createdAt:a.emailDomains.createdAt,updatedAt:a.emailDomains.updatedAt}).from(a.emailDomains).where(A),S=await T.orderBy((0,l.desc)(a.emailDomains.createdAt)).limit(p).offset(v),f=await n.db.select({count:(0,d.count)()}).from(a.emailDomains).where(A),g=f[0]?.count||0,h=await Promise.all(S.map(async e=>{let i=await n.db.select({count:(0,d.count)()}).from(a.emailAddresses).where((0,o.eq)(a.emailAddresses.domainId,e.id)),s=i[0]?.count||0,r=await n.db.select({count:(0,d.count)()}).from(a.emailAddresses).where((0,o.and)((0,o.eq)(a.emailAddresses.domainId,e.id),(0,o.eq)(a.emailAddresses.isActive,!0))),t=r[0]?.count||0,l=null;return e.catchAllEndpointId&&(l=(await n.db.select({id:a.endpoints.id,name:a.endpoints.name,type:a.endpoints.type,isActive:a.endpoints.isActive}).from(a.endpoints).where((0,o.eq)(a.endpoints.id,e.catchAllEndpointId)).limit(1))[0]||null),{...e,stats:{totalEmailAddresses:s,activeEmailAddresses:t,hasCatchAll:!!e.catchAllEndpointId},catchAllEndpoint:l,isVerified:"verified"===e.status}}));return console.log(`✅ GET /api/v1.1/domains - Retrieved ${S.length} domains for user ${s}`),r.NextResponse.json({success:!0,data:h,pagination:{limit:p,offset:v,total:g,hasMore:v+p<g},meta:{totalCount:g,verifiedCount:h.filter(e=>e.isVerified).length,withCatchAllCount:h.filter(e=>e.stats.hasCatchAll).length,statusBreakdown:{verified:h.filter(e=>"verified"===e.status).length,pending:h.filter(e=>"pending"===e.status).length,failed:h.filter(e=>"failed"===e.status).length}}})}catch(e){return console.error("❌ GET /api/v1.1/domains - Error:",e),r.NextResponse.json({success:!1,error:"Failed to fetch domains",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}},789442:e=>{"use strict";var{g:i,__dirname:s}=e;{e.s({patchFetch:()=>o,routeModule:()=>i,serverHooks:()=>l,workAsyncStorage:()=>s,workUnitAsyncStorage:()=>d});var r=e.i(854885),t=e.i(814689),n=e.i(25402),a=e.i(966522);let i=new r.AppRouteRouteModule({definition:{kind:t.RouteKind.APP_ROUTE,page:"/api/v1.1/domains/route",pathname:"/api/v1.1/domains",filename:"route",bundlePath:""},resolvedPagePath:"[project]/app/api/v1.1/domains/route.ts",nextConfigOutput:"",userland:a}),{workAsyncStorage:s,workUnitAsyncStorage:d,serverHooks:l}=i;function o(){return(0,n.patchFetch)({workAsyncStorage:s,workUnitAsyncStorage:d})}}},993477:e=>{var{g:i,__dirname:s}=e;e.v(i=>Promise.all(["server/chunks/[root-of-the-server]__ced7c040._.js","server/chunks/node_modules_10ae7a2d._.js"].map(i=>e.l(i))).then(()=>i(611487)))}};

//# sourceMappingURL=%5Broot-of-the-server%5D__1d1c48d1._.js.map